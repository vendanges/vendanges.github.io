<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Spring cloud Eureka | 琼瑶</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="琼瑶" type="application/atom+xml">
    
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link" style="color: #fff">Home</a>
			
				<a href="/archives" class="header__link" style="color: #fff">Archive</a>
			
				<a href="/about" class="header__link" style="color: #fff">About</a>
			
		</nav>
		<!-- <h1 class="header__title"><a href="/">琼瑶</a></h1> -->
		<h1 class="header__title"><a href="/"><img style="width: 290px;" src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/202204152017786.png"></a></h1>
		<h2 class="header__subtitle">梦入琼楼寒有月，行过石树冻无烟</h2>
	</header>

	<main>
		<article>
	
		<h1>Spring cloud Eureka</h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/java/" rel="tag">java</a> <a class="article__tag-none-link" href="/tags/spring-cloud/" rel="tag">spring cloud</a>
			</span>
		
	</div>

	

	
		<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210525030152.png"></p>
<p>本文将会通过 Eureka 来进行服务中心的治理，并实现出 一个 <strong>服务中心集群（Eureka Server ……）</strong>，以及 <strong>服务提供者集群（Service Provider ……）</strong> 还有一个 <strong>服务提供者消费者（Service Consumer）</strong> 。之后通过 <strong>服务中心</strong> 内的 <strong>Eureka</strong> 来进行服务治理，让 <strong>服务消费者（Service Consumer） 调用 服务提供者（Service Provider）</strong> 来提供服务。</p>
<p>我们首先使用 Eureka 来实现出一个 <strong>服务中心（Eureka Server）</strong> 集群，之后通过 Eureaka 所 <strong>提供的服务注册（Service Register）</strong> 功能来注册 <strong>服务提供者（Service Provider）</strong>，来实现服务提供者集群。</p>
<p>在此后<strong>服务消费者（Service Consumer）</strong> 使用 Eureka 所提供的 <strong>服务注册功能根据服务提供者（Service Provider）</strong> 所注册的名称来调用客户端 <strong>Feign</strong> 来消费 <strong>服务提供者所提供的接口</strong>。</p>
<p>Eureka 是 Netflix 全家桶内项目，他在毕马威在2019年10月所发布的 《颠覆性公司和商业模式》报告中与阿里巴巴分别排名第三，而 Netflix 排名第六位，百度、腾讯分别排名十一和十二位。</p>
<p>虽然 Netlix 排名不如 Alibaba，但他对 Spring cloud 的贡献要早于 Alibaba，因此Netflix 公司所开源的各种项目所组成微服务的核心也不足为奇。</p>
<p>表现层状态转换（Representational State Transfer，REST）由 Roy Thomas Fielding 于 2000年在博士论文中所提出的WWW软件架构风格，目的是放百年在不同软件或程序在网络中相互传递信息，而 Eureka 则是这些项目内基于 REST 服务，主要包含了 <strong>服务注册与服务发现功能</strong>。</p>
<h2 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210526225911.png"></p>
<h3 id="Spring-Assistant"><a href="#Spring-Assistant" class="headerlink" title="Spring Assistant"></a>Spring Assistant</h3><blockquote>
<p> 这从 IDEA 2018 就停止更新了</p>
</blockquote>
<p>通过 Spring Assistant 根据自身环境进行选择，当进入选择版本和依赖时，我们需要选择 <strong>Spring Cloud Discover -&gt; Eureka Server</strong>。</p>
<h3 id="Spring-Initializr"><a href="#Spring-Initializr" class="headerlink" title="Spring Initializr"></a>Spring Initializr</h3><p>或者说我们直接通过 IDEA 自带的 <strong>Spring Initializr</strong>，之后选择 <strong>Spring Cloud Discovery -&gt; Eureka Server</strong>。当我们构建完成后，肯对会出现一大堆 maven 项目依赖的问题，因此我们需要在 <strong>Setting -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Maven</strong> 下修改 <strong>User settings file</strong> 所填写的 <code>settings.xml</code> 文件，并写入下述信息，来设置 Alibaba 镜像：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>uk<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Human Readable Name for this Mirror.<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://uk.maven.org/maven2/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>CN<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>OSChina Central<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.oschina.net/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>internal nexus repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://repo.maven.apache.org/maven2<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="服务中心"><a href="#服务中心" class="headerlink" title="服务中心"></a>服务中心</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210527035316.png"><br>我们所实现的是 <strong>服务中心集群</strong>，和普通的单点服务中心不一样的是，我们可以保障在系统崩溃时，可以维持系统的 <strong>更高的可用性</strong>，所以使用服务中心集群（虽然是服务中心集群，但依然可以通过本文来实现单点服务中心）。</p>
<h3 id="Eureka-Server-demo"><a href="#Eureka-Server-demo" class="headerlink" title="Eureka Server demo"></a>Eureka Server demo</h3><p>我们可以通过一个标准的 Eureka 模板来进行参考，并通过下述模板来进行修改来实现出我们的 <strong>服务中心集群</strong> ，需要注意的是下述code不需要执行（因为你就算执行了实现的也是单点服务中心）：</p>
<h4 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h4><blockquote>
<p>src&#x2F;main&#x2F;resources&#x2F;application.properties</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 应用名称</span><br><span class="line">spring.application.name=Discovery Server</span><br><span class="line"></span><br><span class="line"># Spring 应用端口</span><br><span class="line">server.port=8000</span><br><span class="line"></span><br><span class="line"># 节点名称</span><br><span class="line">eureka.instance.hostname=eureka-server.com</span><br><span class="line"></span><br><span class="line"># 是否注册到 Eureka Server (默认 true）</span><br><span class="line">eureka.client.register-with-eureka=false</span><br><span class="line"></span><br><span class="line"># 是否注册到 Eureka Server 获取注册信息 （默认 true）</span><br><span class="line">eureka.client.fetch-registry=false</span><br><span class="line"></span><br><span class="line"># 设置 Eureka Server 交互地址，查询服务和注册服务进行使用（多个以 “,” 分割）</span><br><span class="line">eureka.client.serviceUrl.defaultZone=http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span><br></pre></td></tr></table></figure>

<h4 id="DemoApplication"><a href="#DemoApplication" class="headerlink" title="DemoApplication"></a>DemoApplication</h4><blockquote>
<p>src&#x2F;main&#x2F;java&#x2F;com&#x2F;example&#x2F;demo&#x2F;DemoApplication.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="hosts"><a href="#hosts" class="headerlink" title="hosts"></a>hosts</h4><p>为了让效果更加的接近真实环境下多台服务器内应用协同服务，所以我们可以通过添加几个 <strong>虚拟地址（DNS）</strong> 来创建一个只有本地可以访问的 URL，来进行演示。</p>
<p>在 Windows 环境下，我们需要修改 <code>C:\Windows\System32\drivers\etc\hosts</code> 文件，并添加：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1      abc.com</span><br></pre></td></tr></table></figure>

<p>而本文作者使用的是 debian 环境，即 Linux 系统下则需要简单的修改 <code>/etc/hosts</code> 文件即可，并添加：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1	eureka-server.com</span><br><span class="line">127.0.0.1	eureka-server-1.com</span><br><span class="line">127.0.0.1	eureka-server-2.com</span><br><span class="line">127.0.0.1   eureka-server-3.com</span><br></pre></td></tr></table></figure>

<p>为了验证其是否生效，可以直接通过 <code>ping xxx.com</code> 进行查看。</p>
<h4 id="Jar-Run"><a href="#Jar-Run" class="headerlink" title="Jar Run"></a>Jar Run</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210527035329.png"></p>
<p>之后我们分别在 <strong>eureka-server-1、eureka-server-2、eureka-server-3</strong> 项目下按照流程点击 maven 侧栏下的 <code>clean、package</code>等命令，以此来代替 mvn 执行 <code>mvn clean | mvn package</code>命令。</p>
<p>当的包项目为 jar 后，分别进入 <strong>eureka-server-1、2、3</strong> 内该 jar 包所在位置，并指定根据之前所在 hosts 文件下设置的DNS名称运行项目（有多少服务集群搞多少个）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar demo-0.0.1-SNAPSHOT.jar --spring.profiles.active=eureka-server.com</span><br></pre></td></tr></table></figure>

<p>之后进入到<code>http://eureka-server.com:8000/</code> 即可访问 Eureka 所提供的信息面板中。</p>
<h3 id="eureka-server-1"><a href="#eureka-server-1" class="headerlink" title="eureka-server-1"></a>eureka-server-1</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210527035343.png"></p>
<blockquote>
<p>如果你理解上述的 Eureka Server demo 的配置并结合下述 eureka-server-1~3 所部署的服务中心集群在 Eureka 控制面板和上图基本相似。</p>
</blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 应用名称</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-clustered</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Spring 应用端口</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8001</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 节点名称</span></span><br><span class="line"><span class="attr">eureka.instance.hostname</span>=<span class="string">eureka-server-1.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 是否注册到 Eureka Server (默认 true）</span></span><br><span class="line"><span class="attr">eureka.client.register-with-eureka</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 是否注册到 Eureka Server 获取注册信息 （默认 true）</span></span><br><span class="line"><span class="attr">eureka.client.fetch-registry</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 设置 Eureka Server 交互地址，查询服务和注册服务进行使用（多个以 “,” 分割）</span></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-2.com:8002/eureka/,http://eureka-server-3.com:8003/eureka/</span></span><br></pre></td></tr></table></figure>

<h3 id="eureka-server-2"><a href="#eureka-server-2" class="headerlink" title="eureka-server-2"></a>eureka-server-2</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 应用名称</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-clustered</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Spring 应用端口</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8002</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 节点名称</span></span><br><span class="line"><span class="attr">eureka.instance.hostname</span>=<span class="string">eureka-server-2.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 是否注册到 Eureka Server (默认 true）</span></span><br><span class="line"><span class="attr">eureka.client.register-with-eureka</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 是否注册到 Eureka Server 获取注册信息 （默认 true）</span></span><br><span class="line"><span class="attr">eureka.client.fetch-registry</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 设置 Eureka Server 交互地址，查询服务和注册服务进行使用（多个以 “,” 分割）</span></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-1.com:8001/eureka/,http://eureka-server-3.com:8003/eureka/</span></span><br></pre></td></tr></table></figure>

<h3 id="eureka-server-3"><a href="#eureka-server-3" class="headerlink" title="eureka-server-3"></a>eureka-server-3</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 应用名称</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-clustered</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Spring 应用端口</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8003</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 节点名称</span></span><br><span class="line"><span class="attr">eureka.instance.hostname</span>=<span class="string">eureka-server-3.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 是否注册到 Eureka Server (默认 true）</span></span><br><span class="line"><span class="attr">eureka.client.register-with-eureka</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 是否注册到 Eureka Server 获取注册信息 （默认 true）</span></span><br><span class="line"><span class="attr">eureka.client.fetch-registry</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 设置 Eureka Server 交互地址，查询服务和注册服务进行使用（多个以 “,” 分割）</span></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-1.com:8001/eureka/,http://eureka-server-2.com:8002/eureka/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="服务提供者"><a href="#服务提供者" class="headerlink" title="服务提供者"></a>服务提供者</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528034643.png"><br>服务提供者（Service provider），我们可以理解为是通过服务中心进行注册，之后为 <strong>服务消费者</strong> 来提供服务的。我们可以从服务中心，来控制、管理整个微服务的运行、连接状态等。</p>
<h3 id="Eureka-Provide-demo"><a href="#Eureka-Provide-demo" class="headerlink" title="Eureka Provide demo"></a>Eureka Provide demo</h3><h4 id="DemoApplication-1"><a href="#DemoApplication-1" class="headerlink" title="DemoApplication"></a>DemoApplication</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.EnableEurekaClient;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们通过根据之前一样的项目依赖，选择 Eureka Server 即可，进入项目后在启动类中加入 <code>@EnableEurekaClient</code> 注解，来启用其 Eureka 注册和发现功能。</p>
<h4 id="application-properties-1"><a href="#application-properties-1" class="headerlink" title="application.properties"></a>application.properties</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-provide</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8000</span></span><br><span class="line"><span class="attr">provider.name</span>=<span class="string">provider0</span></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-3.com:8003/eureka/,http://eureka-server-2.com:8002/eureka/,http://eureka-server-1.com:8001/eureka/</span></span><br></pre></td></tr></table></figure>

<p>之后我们来设置名称以及控制器需要获取到的信息进行配置，之后通过 <code>eureka.client.serviceUrl.defaultZone</code>来加入服务中心。</p>
<h4 id="HelloController"><a href="#HelloController" class="headerlink" title="HelloController"></a>HelloController</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;provider.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String port;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/home&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">string</span> <span class="operator">=</span> <span class="string">&quot;provider:&quot;</span> + name + <span class="string">&quot;port:&quot;</span> + port;</span><br><span class="line">        <span class="keyword">return</span> string;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制器的主要用途是来提供接口让 <strong>服务消费者</strong> 进行获取的，通过<code>application.properties</code>配置文件内相应内容并根据其<code>@Vlue</code>注解以及 <code>@RestController</code>处理HTTP请求，如果你不觉得麻烦可以用下述两个注解代替：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br></pre></td></tr></table></figure>

<h4 id="Actuator-info"><a href="#Actuator-info" class="headerlink" title="Actuator info"></a>Actuator info</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528033455.png"><br>Eureka 在其信息面板中 Instances currently registered with Eureka （目前在Eureka 注册的实例）一览中的 Status（状态）下。为开发者提供了一个便捷查询的入口，即 <code>UP (1) - 192.168.43.65:server-provide:8000</code> &#x3D;&gt; <a target="_blank" rel="noopener" href="http://192.168.43.65:8000/actuator/info">http://192.168.43.65:8000/actuator/info</a> 这是服务提供者的当前在服务中心的链接状态。</p>
<p>当我们点击跳转时，是可以根据其 <code>pom.xml</code> 以及 <code>application.properties</code> 文件内的配置信息单独写入其 JSON 数据的，虽然 Eureka 默认的为 <code>&#123;&#125;</code>。</p>
<p>修改添加后结果如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;app&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eureka-cloud-8000&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;company&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jiangxue.org.cn&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;application&quot;</span><span class="punctuation">:</span> <span class="string">&quot;server-provide&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="string">&quot;8000&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>我们需要修改其 <strong>application.properties</strong> 即 Spring 的全局配置文件：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-provide</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8000</span></span><br><span class="line"><span class="attr">provider.name</span>=<span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">info.app.name</span>=<span class="string">eureka-cloud-8000</span></span><br><span class="line"><span class="attr">info.company.name</span>=<span class="string">jiangxue.org.cn</span></span><br><span class="line"><span class="attr">info.build.application</span>=<span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line"><span class="attr">info.build.port</span>=<span class="string">$&#123;server.port&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-3.com:8003/eureka/</span></span><br></pre></td></tr></table></figure>

<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528033534.png"><br>之后我们还需要修改 <strong>pom.xml</strong> 配置文件信息，在 <code>&lt;build&gt;&lt;/build&gt;</code>元素中的 <code>&lt;plugins&gt;</code> 上方，加入 <code>&lt;finalName&gt;</code>信息：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>之后我们可以选择直接在 IDEA 里面运行或通过 jar 包方式运行（<strong>虽然是本地环境但还是要整出几十台服务器协同的效果</strong>）</p>
</blockquote>
<h4 id="Jar-run"><a href="#Jar-run" class="headerlink" title="Jar run"></a>Jar run</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528033544.png"><br>当全部运行完之后，我们将会有三台服务中心集群，以及两台服务提供集群，通过访问我们服务提供集群的控制器即 <a target="_blank" rel="noopener" href="http://192.168.43.65:8010/hey">http://192.168.43.65:8010/hey</a> 都可以正确访问控制器内容时，即可以正常提供服务。</p>
<h3 id="eureka-provide-1"><a href="#eureka-provide-1" class="headerlink" title="eureka-provide-1"></a>eureka-provide-1</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-provide</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8010</span></span><br><span class="line"><span class="attr">provider.name</span>=<span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">info.app.name</span>=<span class="string">eureka-cloud-$&#123;server.port&#125;</span></span><br><span class="line"><span class="attr">info.company.name</span>=<span class="string">jiangxue.org.cn</span></span><br><span class="line"><span class="attr">info.build.application</span>=<span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line"><span class="attr">info.build.port</span>=<span class="string">$&#123;server.port&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-3.com:8003/eureka/,http://eureka-server-2.com:8002/eureka/,http://eureka-server-1.com:8001/eureka/</span></span><br></pre></td></tr></table></figure>

<h3 id="eureka-provide-2"><a href="#eureka-provide-2" class="headerlink" title="eureka-provide-2"></a>eureka-provide-2</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">server-provide</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8011</span></span><br><span class="line"><span class="attr">provider.name</span>=<span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">info.app.name</span>=<span class="string">eureka-cloud-$&#123;server.port&#125;</span></span><br><span class="line"><span class="attr">info.company.name</span>=<span class="string">jiangxue.org.cn</span></span><br><span class="line"><span class="attr">info.build.application</span>=<span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line"><span class="attr">info.build.port</span>=<span class="string">$&#123;server.port&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-3.com:8003/eureka/,http://eureka-server-2.com:8002/eureka/,http://eureka-server-1.com:8001/eureka/</span></span><br></pre></td></tr></table></figure>

<h2 id="服务消费者"><a href="#服务消费者" class="headerlink" title="服务消费者"></a>服务消费者</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528095543.png"></p>
<p>服务消费者主要通过使用 <strong>Feign</strong> 来进行实现，Feign 由 Retrofit、JAXRS-2.0 和 WebSocet 所启发，主要用于 Java 到 HTPP 客户端绑定器。因此我们将会通过引入 Feign 依赖来实现服务消费者。</p>
<p>在新建项目时，我们需要注意，需要在 <strong>选择依存关系内选择</strong> Spring Web、Eureka Discovery Client。当然之前的服务提供者也可以这样选择，但为了更加方便我们通过选择 <strong>Eureka Server</strong> 单个依存关系也可以实现。</p>
<h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528093919.png"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>添加 spring-cloud-starter-openfeign maven 依赖后可能会报错，此时我们只需要通过点击 Reload ALL Maven Projects 按钮来 <strong>重新加载所有 Maven 项目</strong>。</p>
<h3 id="application-properties-2"><a href="#application-properties-2" class="headerlink" title="application.properties"></a>application.properties</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.application.name</span>=<span class="string">service-consumer</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">9000</span></span><br><span class="line"><span class="attr">eureka.client.register-with-eureka</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">eureka.client.serviceUrl.defaultZone</span>=<span class="string">http://eureka-server-3.com:8003/eureka/,http://eureka-server-2.com:8002/eureka/,http://eureka-server-1.com:8001/eureka/</span></span><br></pre></td></tr></table></figure>

<h3 id="DemoApplication-2"><a href="#DemoApplication-2" class="headerlink" title="DemoApplication"></a>DemoApplication</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过使用 <code>@EnableDiscoveryClients</code>来启动客户端的服务注册和发现功能，并以 <code>@enableFeignClients</code> 注解来实现远程服务调用。</p>
<h3 id="MyFeignClient-interface"><a href="#MyFeignClient-interface" class="headerlink" title="MyFeignClient interface"></a>MyFeignClient interface</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient(name = &quot;server-provide&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyFeignClient</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/hey&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>需要注意的是，我们在此处的方法必须与服务提供者（即服务提供者 Controller）的方法一致</p>
</blockquote>
<p>之后我们需要定义一个接口，并使用 <code>@FeignClient</code> 注解来通过 <strong>name</strong> 值在服务中心进行寻找并连接。在这里我们的服务提供者集群在服务中心所注册的名称是 <strong>server-provide</strong>。</p>
<h3 id="ConsumerController"><a href="#ConsumerController" class="headerlink" title="ConsumerController"></a>ConsumerController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.MyFeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    MyFeignClient myFeignClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hey&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> myFeignClient.hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210528094005.gif"><br>最终我们将服务中心集群、服务提供者集群开起来，以及在 IDEA 中启动服务消费者。之后通过访问 <a target="_blank" rel="noopener" href="http://localhost:9000/hey">http://localhost:9000/hey</a> 刷新两次看看。</p>
<p>如果端口值从 <strong>8010～8011</strong> 之间不断调换。那么我们通过 Eureka 来进行服务治理所实现的微服务架构完成。</p>

	

	
		<span class="different-posts"><a href="/2022/04/21/java/spring%20cloud/3.Spring%20cloud%20Eureka/" onclick="window.history.go(-1); return false;">⬅️ Go back </a></span>

	

</article>

	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>欢迎来到我的 blog <br><br> 通过 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>+<a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a> 进行构建的，存放在 <a target="_blank" rel="noopener" href="https://github.com/vendanges/vendanges.github.io">Github</a> 上。</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2022 John Doe | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
