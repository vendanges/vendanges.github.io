<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>琼瑶</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="琼瑶" type="application/atom+xml">
    
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link" style="color: #fff">Home</a>
			
				<a href="/archives" class="header__link" style="color: #fff">Archive</a>
			
				<a href="/about" class="header__link" style="color: #fff">About</a>
			
		</nav>
		<!-- <h1 class="header__title"><a href="/">琼瑶</a></h1> -->
		<h1 class="header__title"><a href="/"><img style="width: 290px;" src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/202204152017786.png"></a></h1>
		<h2 class="header__subtitle">梦入琼楼寒有月，行过石树冻无烟</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">📖 <a href="/page/26">earlier posts</a> 📖</span>




	<article>
	
		<h1><a href="/2022/04/21/rlang/2.安装R语言/">安装R语言</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/r-lang/" rel="tag">r lang</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>R语言为我们提供了全平台的下载方式，其中主要分为Linux、Windows、Mac等操作系统，本书我们以Linux opensuse系统为例进行安装，如果您当前的发行系统不是opensuse，可以通过访问<a target="_blank" rel="noopener" href="https://cloud.r-project.org/bin/linux/">https://cloud.r-project.org/bin/linux/</a> 进行下载，r语言为我们提供了 debian、fedora、redhat、suse、ubuntu等发行版的下载。</p>
<h2 id="R"><a href="#R" class="headerlink" title="R"></a>R</h2><p><a target="_blank" rel="noopener" href="https://cloud.r-project.org/bin/linux/suse/README.html">https://cloud.r-project.org/bin/linux/suse/README.html</a> 在这个页面之中选择当前opensuse版本进行下载，推荐使用火狐浏览器，因为可以直接识别出文件自动进行安装，安装之后打开终端输入 <code>R</code>即可，出现以下信息：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">R version <span class="number">3.5</span>.0 <span class="punctuation">(</span><span class="number">2018</span><span class="operator">-</span><span class="number">04</span><span class="operator">-</span><span class="number">23</span><span class="punctuation">)</span> <span class="operator">-</span><span class="operator">-</span> <span class="string">&quot;Joy in Playing&quot;</span></span><br><span class="line">Copyright <span class="punctuation">(</span>C<span class="punctuation">)</span> <span class="number">2018</span> The R Foundation <span class="keyword">for</span> Statistical Computing</span><br><span class="line">Platform<span class="operator">:</span> x86_64<span class="operator">-</span>suse<span class="operator">-</span>linux<span class="operator">-</span>gnu <span class="punctuation">(</span><span class="number">64</span><span class="operator">-</span>bit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">R is free software and comes with ABSOLUTELY NO WARRANTY.</span><br><span class="line">You are welcome to redistribute it under certain conditions.</span><br><span class="line">Type <span class="string">&#x27;license()&#x27;</span> or <span class="string">&#x27;licence()&#x27;</span> <span class="keyword">for</span> distribution details.</span><br><span class="line"></span><br><span class="line">  Natural language support but running <span class="keyword">in</span> an English locale</span><br><span class="line"></span><br><span class="line">R is a collaborative project with many contributors.</span><br><span class="line">Type <span class="string">&#x27;contributors()&#x27;</span> <span class="keyword">for</span> more information and</span><br><span class="line"><span class="string">&#x27;citation()&#x27;</span> on how to cite R or R packages <span class="keyword">in</span> publications.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;demo()&#x27;</span> <span class="keyword">for</span> some demos<span class="punctuation">,</span> <span class="string">&#x27;help()&#x27;</span> <span class="keyword">for</span> on<span class="operator">-</span>line help<span class="punctuation">,</span> or</span><br><span class="line"><span class="string">&#x27;help.start()&#x27;</span> <span class="keyword">for</span> an HTML <span class="built_in">browser</span> interface to help.</span><br><span class="line">Type <span class="string">&#x27;q()&#x27;</span> to quit R.</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> </span><br></pre></td></tr></table></figure>

<p>输出Hello,world！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;Hello,world!&quot;)</span><br><span class="line">[1] &quot;Hello,world!&quot;</span><br><span class="line">&gt; </span><br></pre></td></tr></table></figure>

<h2 id="RStudio"><a href="#RStudio" class="headerlink" title="RStudio"></a>RStudio</h2><p>RStudio是专注与R语言的集成开发环境，由JJ Allaire小组进行设计，我们可通过官网<a target="_blank" rel="noopener" href="https://rstudio.com/%E8%BF%9B%E8%A1%8C%E4%B8%8B%E8%BD%BD%EF%BC%8C%E5%BD%93%E7%84%B6%E6%9C%AC%E4%B9%A6%E4%BD%BF%E7%94%A8opensuse">https://rstudio.com/进行下载，当然本书使用opensuse</a> Linux系统环境，可以使用其自带的软件仓库直接进行安装：<a target="_blank" rel="noopener" href="https://software.opensuse.org/package/rstudio">https://software.opensuse.org/package/rstudio</a></p>
<p>输出 hello,world!</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">R version <span class="number">3.5</span>.0 <span class="punctuation">(</span><span class="number">2018</span><span class="operator">-</span><span class="number">04</span><span class="operator">-</span><span class="number">23</span><span class="punctuation">)</span> <span class="operator">-</span><span class="operator">-</span> <span class="string">&quot;Joy in Playing&quot;</span></span><br><span class="line">Copyright <span class="punctuation">(</span>C<span class="punctuation">)</span> <span class="number">2018</span> The R Foundation <span class="keyword">for</span> Statistical Computing</span><br><span class="line">Platform<span class="operator">:</span> x86_64<span class="operator">-</span>suse<span class="operator">-</span>linux<span class="operator">-</span>gnu <span class="punctuation">(</span><span class="number">64</span><span class="operator">-</span>bit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">R is free software and comes with ABSOLUTELY NO WARRANTY.</span><br><span class="line">You are welcome to redistribute it under certain conditions.</span><br><span class="line">Type <span class="string">&#x27;license()&#x27;</span> or <span class="string">&#x27;licence()&#x27;</span> <span class="keyword">for</span> distribution details.</span><br><span class="line"></span><br><span class="line">  Natural language support but running <span class="keyword">in</span> an English locale</span><br><span class="line"></span><br><span class="line">R is a collaborative project with many contributors.</span><br><span class="line">Type <span class="string">&#x27;contributors()&#x27;</span> <span class="keyword">for</span> more information and</span><br><span class="line"><span class="string">&#x27;citation()&#x27;</span> on how to cite R or R packages <span class="keyword">in</span> publications.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;demo()&#x27;</span> <span class="keyword">for</span> some demos<span class="punctuation">,</span> <span class="string">&#x27;help()&#x27;</span> <span class="keyword">for</span> on<span class="operator">-</span>line help<span class="punctuation">,</span> or</span><br><span class="line"><span class="string">&#x27;help.start()&#x27;</span> <span class="keyword">for</span> an HTML <span class="built_in">browser</span> interface to help.</span><br><span class="line">Type <span class="string">&#x27;q()&#x27;</span> to quit R.</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> print<span class="punctuation">(</span><span class="string">&quot;hello,world!&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;hello,world!&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> </span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/rlang/1.什么是R语言/">什么是 R 语言</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/r-lang/" rel="tag">r lang</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p>r语言主要用于进行统计分析、绘图，由Ross lhaka, Robert Gentleman进行开发，属于GNY系统的一个自由、免费、开源的统计计算和统计制图的主要用于绘制学术图表工具（说是说语言），而学术图表是为论文结论(conclusion)提供证据的一种视觉方式。</p>
<p>在数据分析和图表绘制及统计中，主要主要由R、python、matlab、sigmaplot、origin、graphpad prism、excel所立足，本书将详细见解R语言，对于其他语言或工具读者可自行进行学习等。</p>
<h2 id="学术图表的作用"><a href="#学术图表的作用" class="headerlink" title="学术图表的作用"></a>学术图表的作用</h2><p>学术图表主要出现在一些学术论文中，通常是试验结果的核心和主要部分，通常试验结果由图表形式呈现。一般道行较深的会直接通过图表来判断这篇学术文章、论文是否值得进行阅读，古而言之“一图低千言”，<br>我们以Nature上的文章为例，首先我们关注的是论文的标题、其次是第一页最开始的摘要，然后我们被大量的学术图表所吸引。在每页的文章中，主要包含图名、图表总共会占整个页面的1&#x2F;4~1&#x2F;3.</p>
<h3 id="图表的基本类别"><a href="#图表的基本类别" class="headerlink" title="图表的基本类别"></a>图表的基本类别</h3><p>通常学术期刊通常分为两部分，分别为黑白图表和彩色图表，由于彩色图表的印刷成本相对较高，所以大部分分期刊都是黑白的，通常不同的期刊也往往要求提交的学术图表为黑白颜色。当然如果你想保持彩色图表，出版社也许会通过加钱来对你收取额外的彩色出版费用，<code>彩色图表和黑白图表的是数据标记区别</code>：<br><strong>黑白图表</strong><br>数据标记通常使用不同的<code>填充纹理</code>或<code>标记形状</code></p>
<p><strong>彩色图表</strong><br>使用不同的<code>填充颜色</code>或<code>标记形状</code></p>
<h3 id="学术图表的绘制要求"><a href="#学术图表的绘制要求" class="headerlink" title="学术图表的绘制要求"></a>学术图表的绘制要求</h3><p>通常每个学术期刊都会有自己对学术图表的基本要求，这里我们以nature为例，nature为提交稿件的作者编写了一系列的指南，提供了编辑的标准和程序、格式指南、提交前查询、首次提交、最终提交、补充说明、补充资料、表格和声明、问题出现、其他类型的提交、发布选项等一系列的指南供作者进行参考。</p>
<p>首先，学术图表要规范，且符合学术期刊的要求，之后在此基础上对图表进行美观和专业，通常主要注意几点：<code>“1,规范、2,简洁、3,专业、4,美观”</code>等四个绝对性质的要素。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/python/python cookbook/1.数据结构/">Python 数据结构</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/python/" rel="tag">python</a> <a class="article__tag-none-link" href="/tags/python-cookbook/" rel="tag">python cookbook</a>
			</span>
		
	</div>

	

	
		<p>python cookbook 是 python3&amp;2 等版本中适合开发者进阶的一本书，其中主要讲解了核心语法，同时也是 Python3 的参考书，所有代码都是在 Python 3.3 的版本下进行编写和测试的。</p>
<p>此书主要对数据结构等进行非常详细的介绍和案例处理，基本上包含了目前所有 Python 可以涉猎的内容。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">编写的主要目的就是在 Python cookbook 所忽视的基础问题上，增加一点描述和更加通俗的理解方便进行阅读。</span><br></pre></td></tr></table></figure>

<h2 id="解构器"><a href="#解构器" class="headerlink" title="解构器"></a>解构器</h2><h3 id="解构序列赋值多个变量"><a href="#解构序列赋值多个变量" class="headerlink" title="解构序列赋值多个变量"></a>解构序列赋值多个变量</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">现在有一个包含 N 个元素的元组或者是序列，怎样将它里面的值解构后同时赋值给 N 个变量？</span><br></pre></td></tr></table></figure>

<p>首先我们需要知道，元组(tuple) 了类似于列表，元组的区别在于一旦赋值给元组，<strong>就无法更改元组的元素，而列表可以更改</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元组是将所有元素放在括号中的，也就是 my_tuple = (1,2)，括号是可选的，它可以包含 int、float、list、strig 等</span><br></pre></td></tr></table></figure>

<p>而题目要求是将包含 n 个的元组变量或数据，来将它里面的值解构后复制给其他变量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p = (<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将元组解构赋值给多个变量</span></span><br><span class="line">x, y = p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x) <span class="comment"># 4</span></span><br><span class="line"><span class="built_in">print</span>(y) <span class="comment"># 5</span></span><br></pre></td></tr></table></figure>

<p>在 python 中，任何序列或是可以 <strong>迭代</strong> 的对象，都可以通过赋值语句解构并赋值给多个变量，<strong>前提是变量和数量的序列是一样的</strong>，而且这适用于列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="string">&#x27;BNB&#x27;</span>, <span class="string">&#x27;WBNB&#x27;</span>, <span class="string">&#x27;BUSD&#x27;</span>]</span><br><span class="line"></span><br><span class="line">get_bnb, get_wbnb, get_busd = <span class="built_in">list</span></span><br><span class="line"><span class="built_in">print</span>(get_bnb) <span class="comment">#BNB</span></span><br></pre></td></tr></table></figure>

<p>同时在书中也提供了一个列表(list) 包含 元组(tuple) 的示例，但数据类型是列表的序列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data = [ <span class="string">&#x27;ACME&#x27;</span>, <span class="number">50</span>, <span class="number">91.1</span>, (<span class="number">2012</span>, <span class="number">12</span>, <span class="number">21</span>) ]</span><br><span class="line"></span><br><span class="line">name, shares, price, date = data</span><br><span class="line"><span class="built_in">print</span>(date) <span class="comment"># (2012, 12, 21)</span></span><br><span class="line"></span><br><span class="line">name, shares, price, (year, mon, day) = data</span><br><span class="line"><span class="built_in">print</span>(year , mon , day) <span class="comment"># 2012 12 21</span></span><br></pre></td></tr></table></figure>

<p>实际上上述这种解构器复制可以用于任何可以 <strong>迭代的对象</strong>，包括字符串和文件等，同时对字符串则可以是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;Hello&#x27;</span></span><br><span class="line">a, b, c, d, e = <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a,b,c,d,e, sep=<span class="string">&#x27;&#x27;</span>) <span class="comment"># H e l l o &gt; Hello</span></span><br></pre></td></tr></table></figure>

<p>上面我们使用了一个 <code>python()</code> 函数中的 <code>sep</code> 参数(只有 <code>python()</code> 函数可以使用)，以此来去掉多余部分的空格，<a target="_blank" rel="noopener" href="https://www.adamsmith.haus/python/answers/how-to-print-with-sep-in-python">如何在Python中使用sep打印 (adamsmith.haus)</a>，在此连接中有较为详细的介绍。</p>
<p>假设有时候我们只需要解构一部分，而忽略掉其他的值，那么我们就可以通过使用 <code>_</code> 的方式来进行忽略：</p>
<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220318015408.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = [ <span class="string">&#x27;ACME&#x27;</span>, <span class="number">50</span>, <span class="number">91.1</span>, (<span class="number">2012</span>, <span class="number">12</span>, <span class="number">21</span>) ]</span><br><span class="line"></span><br><span class="line">_, shares, price, _ = data</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(shares) <span class="comment"># 50</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果我们的元素个数，超出了变量的个数，那么将会抛出一个 ```ValueError: need more than 2 values to unpack``` 错误，为了避免此类问题，我们可以使用 ```*``` 解决</span><br></pre></td></tr></table></figure>

<p><img src="/%5B%5D(%3Chttps:/49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220318020503.png)%3E"><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220318020833.png"></p>
<p>在书中，这一章节主要被称之为：“将可迭代的对象赋值给多个变量”，根据提议和问题来进行理解，就是说对象的数量太多，而变量的数量太少不对应所造成的问题，可以通过 <code>*</code> 进行解决，也就是说后面的对象，都解构给了 <code>date</code> 这个变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = [ <span class="string">&#x27;ACME&#x27;</span>, <span class="number">91.1</span>, (<span class="number">2012</span>, <span class="number">12</span>, <span class="number">21</span>), (<span class="number">2022</span>, <span class="number">3</span>, <span class="number">18</span>)  ]</span><br><span class="line"></span><br><span class="line">name, pcrice, date = data</span><br><span class="line"><span class="built_in">print</span>(date) <span class="comment">#[(2012, 12, 21), (2022, 3, 18)]</span></span><br></pre></td></tr></table></figure>

<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220318022116.png"></p>
<p>为了更好的展示数据类型的改变，我们直接使用书上所进行展示的元组(tuple) 来进行演示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">record = (<span class="string">&#x27;Dave&#x27;</span>, <span class="string">&#x27;dave@example.com&#x27;</span>, <span class="string">&#x27;773-555-1212&#x27;</span>, <span class="string">&#x27;847-555-1212&#x27;</span>)</span><br><span class="line"></span><br><span class="line">name, email, *phone = record</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(phone))</span><br></pre></td></tr></table></figure>

<p>最后原来 <code>recird</code> 的元组通过使用 <code>*</code> 的方式，输出为了一个列表，上面 <code>phone</code> 解构出的也永远都是列表类型，<strong>因此在特殊时候我们还需要进行转换</strong>。</p>
<h3 id="解构在迭代器的使用"><a href="#解构在迭代器的使用" class="headerlink" title="解构在迭代器的使用"></a>解构在迭代器的使用</h3><p>迭代解构是专门为解构<strong>不确定</strong>的个数或任意可迭代的对象而设计的，通过 <code>*</code> 可以很容易利用解构器的方式结构出元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">records = [  </span><br><span class="line">    (<span class="string">&#x27;foo&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>),  </span><br><span class="line">    (<span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;hey&#x27;</span>),  </span><br><span class="line">    (<span class="string">&#x27;foo&#x27;</span>, <span class="number">3</span>, <span class="number">4</span>),  </span><br><span class="line">]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_foo</span>(<span class="params">x, y</span>):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;do_foo&#x27;</span>, x, y)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_bar</span>(<span class="params">s</span>):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;do_bar&#x27;</span>, s)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> tag, *args <span class="keyword">in</span> records:  </span><br><span class="line">    <span class="keyword">if</span> tag == <span class="string">&#x27;foo&#x27;</span>:  </span><br><span class="line">        do_foo(*args)  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">elif</span> tag == <span class="string">&#x27;bar&#x27;</span>:  </span><br><span class="line">        do_bar(*args)</span><br></pre></td></tr></table></figure>

<p>如果根据上述 Code 运行以及输出后都不理解的话，我们可以看分解后的数据</p>
<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220318032835.png"></p>
<p>我们可以将迭代器中的 <code>for tag, *args in records</code> 理解为 <code>tag, *args = records</code>，之后这样 <code>tag</code> 就对应了 <code>foo,bar,foo</code> 而 <code>*args</code> 对应的就是之后的对象。</p>
<p>因为有时候 list 元素中，可能会有 1~2 个索引值，为了通用性所以写了 <code>*</code>，之后就是添加循环迭代以及在 <code>if</code> 语句中引入对应的函数即可循环迭代 list 中的数据。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/python/Python 复合语句/"></a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
	</div>

	

	
		<h1 id="Python-复合语句"><a href="#Python-复合语句" class="headerlink" title="Python 复合语句"></a>Python 复合语句</h1><p>Python 中的复合语句是包含其他语句或语句组，会以另一种方式影响或控制所包含的其他语句的执行，比如传统的 if\while\for\try\whth 等，用于实现传统的控制流程构造，</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/python/Python MySQL/">Python MySQL</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/python/" rel="tag">python</a>
			</span>
		
	</div>

	

	
		<h1 id="Python-MySQL"><a href="#Python-MySQL" class="headerlink" title="Python MySQL"></a>Python MySQL</h1><h2 id="pymysql-err-OperationalError-1045-“Access-denied-for-user-‘root-localhost‘-’localhost’-using-password-YES-”"><a href="#pymysql-err-OperationalError-1045-“Access-denied-for-user-‘root-localhost‘-’localhost’-using-password-YES-”" class="headerlink" title="pymysql.err.OperationalError: (1045, “Access denied for user ‘root@localhost‘@’localhost’ (using password: YES)”)"></a>pymysql.err.OperationalError: (1045, “Access denied for user ‘root@localhost‘@’localhost’ (using password: YES)”)</h2><p>​		遇到此问题需要在终端界面中MySQL交互式模式中输入以下命令解决此问题。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;New Password&#x27;;</span><br></pre></td></tr></table></figure>



<h2 id="PyMySQL"><a href="#PyMySQL" class="headerlink" title="PyMySQL"></a>PyMySQL</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install PyMySQL</span><br></pre></td></tr></table></figure>

<p>​	 安装PyMySQL，可以在终端或者IDE集成开发环境中进行安装，之后就可以在开发环境中进行导入。</p>
<h2 id="连接数据库例子"><a href="#连接数据库例子" class="headerlink" title="连接数据库例子"></a>连接数据库例子</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">temysql = pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">                          port=<span class="number">3306</span> ,</span><br><span class="line">                          user=<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">                          passwd=<span class="string">&#x27;toor&#x27;</span>,</span><br><span class="line">                          db=<span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">                          charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建游标对象 cursor</span></span><br><span class="line">cursor = temysql.cursor()</span><br></pre></td></tr></table></figure>



<h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySQL 命令</span></span><br><span class="line">cursor.execute(<span class="string">&#x27;show databases;&#x27;</span>)</span><br><span class="line">data = cursor.fetchone()</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;%s&#x27;</span> % data)</span><br></pre></td></tr></table></figure>



<h3 id="关闭数据库和游标"><a href="#关闭数据库和游标" class="headerlink" title="关闭数据库和游标"></a>关闭数据库和游标</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭游标</span></span><br><span class="line">cursor.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库</span></span><br><span class="line">temysql.close()</span><br></pre></td></tr></table></figure>

<p>​	</p>
<h3 id="预处理语句"><a href="#预处理语句" class="headerlink" title="预处理语句"></a>预处理语句</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute(<span class="string">&quot;DROP TABLE IF EXISTS EMPLOYEE&quot;</span>)</span><br><span class="line">data = <span class="string">&quot;&quot;&quot;CREATE TABLE EMPLOYEE (</span></span><br><span class="line"><span class="string">        FIRST_NAME CHAR(20) NOT NULL, </span></span><br><span class="line"><span class="string">        LAST_NAME CHAR(20), </span></span><br><span class="line"><span class="string">        AGE INT, SEX CHAR(1), </span></span><br><span class="line"><span class="string">        INCOME FLOAT )&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;%s&#x27;</span> % data)</span><br></pre></td></tr></table></figure>



<h3 id="提交数据-or-回滚"><a href="#提交数据-or-回滚" class="headerlink" title="提交数据 or 回滚"></a>提交数据 or 回滚</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># 执行语句</span></span><br><span class="line">    cursor.execute(data)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 提交数据</span></span><br><span class="line">    temysql.commit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="comment"># 数据回滚</span></span><br><span class="line">    temysql.rollback()</span><br></pre></td></tr></table></figure>



<h3 id="连接池"><a href="#连接池" class="headerlink" title="连接池"></a>连接池</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> DBUtils.PooledDB <span class="keyword">import</span> PooledDB, SharedDBConnection</span><br><span class="line"></span><br><span class="line">Pool = PooledDB(creator=pymysql,        <span class="comment"># 使用模块</span></span><br><span class="line">                maxconnections=<span class="number">6</span>,       <span class="comment"># 连接池允许的最大连接数, 0 or None表示不限制</span></span><br><span class="line">                mincached=<span class="number">2</span>,            <span class="comment"># 在初始化时的连接池最大连接数</span></span><br><span class="line">                maxcached=<span class="number">5</span>,            <span class="comment"># 最多限制链接，0 or None表示无限制</span></span><br><span class="line">                maxshared=<span class="number">3</span>,            <span class="comment"># 连接池最多的共享链接数量，0 or None表示无限制 （无论设置多少，_maxshared永远的为0，所以都是共享的）</span></span><br><span class="line">                blocking=<span class="literal">True</span>,          <span class="comment"># 连接池如果没有可用的连接诶是否阻塞等待。（True 等待 False不等待）</span></span><br><span class="line">                maxusage=<span class="literal">None</span>,          <span class="comment"># 连接可重复次数（None = 无限制）</span></span><br><span class="line">                setsession=[],          <span class="comment"># 开始回话前执行的命令列表</span></span><br><span class="line">                ping=<span class="number">0</span>,                 <span class="comment"># 检查服务是否可用 (0 = 永不停止，1 = 每当请求时，2 = 创建游标时， 4 = 执行查询时，7 = 始终)</span></span><br><span class="line">                host=<span class="string">&#x27;localhost&#x27;</span>,       <span class="comment"># MySQL地址</span></span><br><span class="line">                port=<span class="number">3306</span>,              <span class="comment"># MySQL Port</span></span><br><span class="line">                user=<span class="string">&#x27;root&#x27;</span>,            <span class="comment"># MySQL User</span></span><br><span class="line">                passwd=<span class="string">&#x27;toor&#x27;</span>,          <span class="comment"># MySQL Password</span></span><br><span class="line">                db=<span class="string">&#x27;mysql&#x27;</span>,             <span class="comment"># MySQL db</span></span><br><span class="line">                charset=<span class="string">&#x27;utf8&#x27;</span>)         <span class="comment"># MySQL 字符集</span></span><br></pre></td></tr></table></figure>










	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/dcatadmin/3.Dcat Ad,om 工具栏按钮与数据表单/">Dcat Admin 工具栏按钮</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/dcatadmin/" rel="tag">dcatadmin</a> <a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Dcat Admin 在 DcatAdmin 数据表格之上为我们提供了工具栏按钮，使得我们可以在数据表格页面中自定义按下后的弹窗页面，通过 <code>app/Admin/Actions/Tool</code> 目录中定义菜单栏工具为 <code>MovieShowTool.php</code> ，并继承自 AbstractTool(<code>Dcat\Admin\Grid\Tools\AbstractTool</code>)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">除了可以使用之前在数据表格中所使用到的页面脚手架之外，我们还可以使用 Artisan Cli 进行构建，数据表格、数据表单、数据详情和模型树，参考官方文档进行使用 [基本使用 | 动作 |《Dcat Admin 中文文档 2.x》| Laravel China 社区 (learnku.com)](https://learnku.com/docs/dcat-admin/2.x/basic-use/8124)</span><br></pre></td></tr></table></figure>

<p>对于 Artisan Cli Command，我们可以通过 <code>php artisan admin:action</code> 来选择 show-tool 即 Dcat Admin 工具栏按钮自定义，然后输入类名称目录即可：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;php artisan admin:action</span><br><span class="line"></span><br><span class="line"> Which type of action would you like to make?:</span><br><span class="line">  [<span class="number">0</span>] <span class="keyword">default</span></span><br><span class="line">  [<span class="number">1</span>] grid-batch</span><br><span class="line">  [<span class="number">2</span>] grid-row</span><br><span class="line">  [<span class="number">3</span>] grid-tool</span><br><span class="line">  [<span class="number">4</span>] form-tool</span><br><span class="line">  [<span class="number">5</span>] show-tool</span><br><span class="line">  [<span class="number">6</span>] tree-row</span><br><span class="line">  [<span class="number">7</span>] tree-tool</span><br><span class="line"> &gt; <span class="number">5</span></span><br><span class="line"></span><br><span class="line"> Please enter a name of action <span class="class"><span class="keyword">class</span>:</span></span><br><span class="line"><span class="class"> &gt; <span class="title">MovieOutherTools</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"> <span class="title">Please</span> <span class="title">enter</span> <span class="title">the</span> <span class="title">namespace</span> <span class="title">of</span> <span class="title">action</span> <span class="title">class</span> [<span class="title">App</span>\<span class="title">Admin</span>\<span class="title">Actions</span>\<span class="title">Show</span>]:</span></span><br><span class="line"><span class="class"> &gt; <span class="title">App</span>\<span class="title">Admin</span>\<span class="title">Actions</span>\<span class="title">Tool</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">App</span>\<span class="title">Admin</span>\<span class="title">Actions</span>\<span class="title">Tool</span>\<span class="title">MovieOutherTools</span> <span class="title">created</span> <span class="title">successfully</span>.</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据表单是通过按钮、或者菜单进行调用的。</span><br></pre></td></tr></table></figure>
<p>之后，我们通过工具表单的 Artisan Cli Commad <code>php artisan admin:form MovieOutherForm</code> 命令来生成一个名为 MovieOutherForm 类作为工具表单，在 <code>app/Admin/Forms</code> 目录内：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Admin</span>\<span class="title class_">Forms</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Widgets</span>\<span class="title">Form</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MovieOutherForm</span> <span class="keyword">extends</span> <span class="title">Form</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line"> <span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 处理表单提交请求 * * <span class="doctag">@param</span> array $input  </span></span><br><span class="line"><span class="comment"> *  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$input</span></span>)  </span></span><br><span class="line"><span class="function"> </span>&#123; <span class="comment">// dump($input);  </span></span><br><span class="line">  </span><br><span class="line"> <span class="comment">// return $this-&gt;response()-&gt;error(&#x27;Your error message.&#x27;);  </span></span><br><span class="line"> <span class="keyword">return</span> <span class="variable language_">$this</span>  </span><br><span class="line"> -&gt;<span class="title function_ invoke__">response</span>()  </span><br><span class="line"> -&gt;<span class="title function_ invoke__">success</span>(<span class="string">&#x27;Processed successfully.&#x27;</span>)  </span><br><span class="line"> -&gt;<span class="title function_ invoke__">refresh</span>();  </span><br><span class="line"> &#125;  </span><br><span class="line">  </span><br><span class="line"> <span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 构建表单. */</span> </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">form</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"> </span>&#123; </span><br><span class="line"> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;name&#x27;</span>)-&gt;<span class="title function_ invoke__">required</span>();  </span><br><span class="line"> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">email</span>(<span class="string">&#x27;email&#x27;</span>)-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;email&#x27;</span>);  </span><br><span class="line"> &#125;  </span><br><span class="line">  </span><br><span class="line"> <span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * 表单的数据. * * <span class="doctag">@return</span> array  </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">default</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"> </span>&#123; <span class="keyword">return</span> [  </span><br><span class="line"> <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;John Doe&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;John.Doe@gmail.com&#x27;</span>,  </span><br><span class="line"> ];  </span><br><span class="line"> &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时 MovieOutherForm 就会集成 Form，即 <code>Dcat\Admin\Widgets\Form</code> 使得可以用来构建表单和提交数据，以及全方位的独立处理数据，且不需要注册额外路由。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">通过 ```php artisan list``` 可以列出所有的 Laravel Artisan 命令，之后我们输入 ```php artisan list admin``` 来查看 Dcat Admin 的所有命令和语法。</span><br><span class="line"></span><br><span class="line">此外，我们还可以通过使用 ```php artisan help make:console``` 来查看 Artisan make Console 的具体用法。</span><br></pre></td></tr></table></figure>

<p>在此之前，我们通过 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin/helpers/scaffold">Admin | 代码生成器</a> 网页脚手架所自动生成的控制器、模型以及数据仓库外，还可以通过 <a target="_blank" rel="noopener" href="https://laravel.com/api/5.5/Illuminate/Database/Eloquent/Model.html">Illuminate\Database\Eloquent\Model | Laravel API</a>  使得 <code>app\Models\Shop</code> 实现抽象模型，然后通过 <code>Service</code> 以此来中转数据。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/dcatadmin/2.Dcat Admin 数据表格/">Dcat Admin 数据表格</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/dcatadmin/" rel="tag">dcatadmin</a> <a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Dcat Admin 的数据表格直译过来就是将数据的数据，以列表的形式展示在 DcatAdmin 页面中，在 Dcat Admin 的官方文档中有大量的篇幅描写了基于 bootstrap 的特性，与 Laravel 相互结合的各种语法糖进行演示。</p>
<p>通过 Dcat Admin 所提供的数据表格我们可以通过 Dcat Admin 方法来在表格的基础上，添加工具栏、过滤查询、过滤器、搜索、筛选器、编辑、创建、时间、软删除、渲染等，同时也有数据表格的样式来进行选择。</p>
<h2 id="Grid"><a href="#Grid" class="headerlink" title="Grid"></a>Grid</h2><p><a href="!%5B%5D(https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220215153624.png)"></a><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220215163550.png"></p>
<p>在接触到 Dcat Admin 数据表格之前，我们需要了解到 <code>Dcat\Admin\Grid</code> 类，它主要通过数据模型来生成表格，在之前我们可以使用 Dcat Admin 所提供的 Repositories(数据仓库) ，也可以直接从数据库中调用 Model，都是可以的。</p>
<p>在数据表格中，我们会了解到 DcatAdmin 中的 Repositories 和 Models 以及 Admin Controller 的使用与构造，首先，Dcat Admin 并没有为我们提供诸如 Laravel-Admin 类似的命令。</p>
<p>你需要做的是，通过 Factory SQL 来创建一个 SQL model，具体的你可以参考下 <a target="_blank" rel="noopener" href="https://kunlunsiqu.github.io/kunlsq/2022/02/10/php/laravel/19.Laravel%20Factory%20SQL/">Laravel Factory SQL | kunlsq (kunlunsiqu.github.io)</a> 文档进行操作，然后使用 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin/helpers/scaffold">Admin | 代码生成器</a> 选择已经创建的数据表，最后通过页面脚手架来进行操作。</p>
<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/7Z0KX070%7DT%7D%7DMCNUV7X%5D086.jpg"></p>
<p>点击提交后，我们可以清楚的看到 DcatAdmin 为我们构建了 Model、Controller、Repository，甚至是 Lang 语言文件等，在此之后，我们就可以通过<a target="_blank" rel="noopener" href="https://learnku.com/docs/dcat-admin/2.x">《Dcat Admin 中文文档》 | Laravel China 社区 (learnku.com)</a>官方文档中进行下一步的自定义。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于官方文档主要起到的是参考作用，并不适用于从零开始构建一个 Dcat Admin 应用，因从我们建议你通过 [jqhph/dcat-admin-demo (github.com)](https://github.com/jqhph/dcat-admin-demo) 下载 [Admin | Dashboard](http://103.39.211.179:8080/admin) 的 Demo，根据需求进行自定义并参照官方文档，进行开发，会加快理解。</span><br></pre></td></tr></table></figure>

<p>之后我们需要做的就是需要在 <code>app/Admin/routes.php</code> 中为我们刚刚所创建的 MovieController 加入一行路由，即：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$router</span>-&gt;<span class="title function_ invoke__">resource</span>(<span class="string">&#x27;movie&#x27;</span>,<span class="string">&#x27;MovieController&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>之后，你可以访问 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin/movie">Admin | 订单管理</a> 来访问刚刚通过页面脚手架所创建的页面，但在此之前，我们还需要在 <code>app/Admin/bootstrap.php</code> 目录中加入菜单，即 DcatAdmin 左侧导航栏中的数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">&lt;?php</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Admin</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Grid</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Form</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Grid</span>\<span class="title">Filter</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Show</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Menu</span>;  </span><br><span class="line"><span class="comment">/**  </span></span><br><span class="line"><span class="comment"> * Dcat-admin - admin builder based on Laravel. * <span class="doctag">@author</span> jqh &lt;https://github.com/jqhph&gt;  </span></span><br><span class="line"><span class="comment"> * * Bootstraper for Admin. * * Here you can remove builtin form field: * * extend custom field: * Dcat\Admin\Form::extend(&#x27;php&#x27;, PHPEditor::class); * Dcat\Admin\Grid\Column::extend(&#x27;php&#x27;, PHPEditor::class); * Dcat\Admin\Grid\Filter::extend(&#x27;php&#x27;, PHPEditor::class); * * Or require js and css assets: * Admin::css(&#x27;/packages/prettydocs/css/styles.css&#x27;); * Admin::js(&#x27;/packages/prettydocs/js/main.js&#x27;); * */</span>  </span><br><span class="line"><span class="title class_">Admin</span>::<span class="title function_ invoke__">menu</span>(function (Menu <span class="variable">$menu</span>) &#123;  </span><br><span class="line"> <span class="variable">$menu</span>-&gt;<span class="title function_ invoke__">add</span>([  </span><br><span class="line"> [ <span class="string">&#x27;id&#x27;</span> =&gt; <span class="string">&#x27;1&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;title&#x27;</span> =&gt; <span class="string">&#x27;亚马逊&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;icon&#x27;</span> =&gt; <span class="string">&#x27;fa fa-amazon&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;parent_id&#x27;</span> =&gt; <span class="number">0</span>,  </span><br><span class="line"> <span class="string">&#x27;permission_id&#x27;</span> =&gt; <span class="string">&#x27;test&#x27;</span>, // 权限绑定  </span><br><span class="line"> <span class="string">&#x27;roles&#x27;</span> =&gt; <span class="string">&#x27;test-roles&#x27;</span>, // 角色绑定  </span><br><span class="line"> ],  </span><br><span class="line"> [  </span><br><span class="line"> <span class="string">&#x27;id&#x27;</span> =&gt; <span class="string">&#x27;2&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;title&#x27;</span> =&gt; <span class="string">&#x27;订单管理&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;icon&#x27;</span> =&gt; <span class="string">&#x27;fa-reorder&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;movie&#x27;</span>,  </span><br><span class="line"> <span class="string">&#x27;parent_id&#x27;</span> =&gt; <span class="string">&#x27;1&#x27;</span>  </span><br><span class="line"> ]  </span><br><span class="line"> ]);  </span><br><span class="line">&#125;);](&lt;%<span class="number">3</span>C?php</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Admin</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Grid</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Form</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Grid</span>\<span class="title">Filter</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Show</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Menu</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Dcat-admin - admin builder based on Laravel.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jqh &lt;https://github.com/jqhph%3E</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Bootstraper for Admin.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Here you can remove builtin form field:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * extend custom field:</span></span><br><span class="line"><span class="comment"> * Dcat\Admin\Form::extend(&#x27;php&#x27;, PHPEditor::class);</span></span><br><span class="line"><span class="comment"> * Dcat\Admin\Grid\Column::extend(&#x27;php&#x27;, PHPEditor::class);</span></span><br><span class="line"><span class="comment"> * Dcat\Admin\Grid\Filter::extend(&#x27;php&#x27;, PHPEditor::class);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Or require js and css assets:</span></span><br><span class="line"><span class="comment"> * Admin::css(&#x27;/packages/prettydocs/css/styles.css&#x27;);</span></span><br><span class="line"><span class="comment"> * Admin::js(&#x27;/packages/prettydocs/js/main.js&#x27;);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Admin</span>::<span class="title function_ invoke__">menu</span>(function (Menu <span class="variable">$menu</span>) &#123;</span><br><span class="line">    <span class="variable">$menu</span>-&gt;<span class="title function_ invoke__">add</span>([</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>                =&gt;       <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;title&#x27;</span>             =&gt;       <span class="string">&#x27;亚马逊&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;icon&#x27;</span>              =&gt;       <span class="string">&#x27;fa fa-amazon&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>               =&gt;       <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;parent_id&#x27;</span>         =&gt;       <span class="number">0</span>,             // 菜单子集</span><br><span class="line">            <span class="string">&#x27;permission_id&#x27;</span>     =&gt;       <span class="string">&#x27;test&#x27;</span>,        // 权限绑定</span><br><span class="line">            <span class="string">&#x27;roles&#x27;</span>             =&gt;       <span class="string">&#x27;test-roles&#x27;</span>,  // 角色绑定</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>                =&gt;      <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;title&#x27;</span>             =&gt;      <span class="string">&#x27;订单管理&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;icon&#x27;</span>              =&gt;      <span class="string">&#x27;fa-reorder&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;uri&#x27;</span>               =&gt;      <span class="string">&#x27;movie&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;parent_id&#x27;</span>         =&gt;      <span class="number">1</span></span><br><span class="line">        ],</span><br><span class="line">    ]);</span><br><span class="line">&#125;);&gt;)</span><br></pre></td></tr></table></figure>

<p>再次需要注意的是参数是调整菜单的上下级，以上面的 Code 举例，亚马逊是一级菜单，而订单管理是二级菜单，这主要通过 <code>permission_id</code> 来进行调整。</p>
<p>同样的，配置完菜单后，我们还需要对该页面的标题进行设置，进入到 <code>\resources\lang\zh_CN\movie.php</code> 然后更改对应的元素在该语言下的翻译即可。</p>
<p>最后你可以<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin/movie">Admin | 订单管理</a> 访问，来进行查看刚刚我们修改和创建后的页面即效果，然后按照官方文档，进一步根据场景来进行调整即可。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/dcatadmin/1.Dcat Admin 基础/">Dcat Admin 入门</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/dcatadmin/" rel="tag">dcatadmin</a> <a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Dcat Admin 是一个基于 Admin admin 二次开发的后台构建工具，支持页面一键生成 CURD 代码且具有丰富的后台组件。并拥有简洁的 API 和用户、权限、菜单管理，同时使用 PJAX 构建盒子模型（支持按需加载静态资源，可无限扩展但不影响性能）并采用松耦合的页面构建雨数据操作和涉及。</p>
<p>打牌自定义页面和主题配色，以及多主题的切换让其变得高颜值并支持插件、可视化代码生成器以及数据表格的构建，支持表头、数据导出和搜索等批量操作以及异步上传文件等。</p>
<p>对于构建 Dcat Admin 可以通过 composer 在构建完 Laravel 之后的操作，即使用 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">composer create-project --prefer-dist laravel/laravel dcat-admin</span><br><span class="line"></span><br><span class="line">!!! ad-warning</span><br><span class="line">	title: Laravel 版本控制</span><br><span class="line">	collapse: close</span><br><span class="line">	同样的你可以通过 composer create-project --prefer-dist laravel/laravel dcat-admin 7.</span><br></pre></td></tr></table></figure>

<p>之后通过 <code>.env</code> 配置文件，在此基础上填写 Mysql 文件以及安装 <code>dcat-admin</code> 等，在此基础上直接通过 <code>composer require dcat/laravel-admin:&quot;2.**&quot; -vvv</code> ，之后 <code>php artisan admin:publish</code> 完成后。</p>
<p>通过 <code>composer install\composer update</code> 完成依赖的安装，使用 <code>php artisan migrate</code> 完成 Model 的定义，并通过 <code>php artisan admin:install</code> 将 Dactadmin 的必要数据(user and pass)数据映射到数据库中。</p>
<p>之后 Dcat-admin 的所有配置都在 <code>config/admin.php</code> 文件夹和目录中，之后的后台目录 <code>app/Admin</code> 中来进行开发：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">app/Admin</span><br><span class="line">	├── Controllers //存放 Dcat-admin 启动文件 </span><br><span class="line">│   ├── AuthController.php //DcatAdmin 登录鉴权控制器</span><br><span class="line">│   └── HomeController.php //DcatAdmin 首页控制器</span><br><span class="line">├── Metrics //数据统计卡片 Demo</span><br><span class="line">│   └── Examples</span><br><span class="line">│       ├── NewDevices.php</span><br><span class="line">│       ├── NewUsers.php</span><br><span class="line">│       ├── ProductOrders.php</span><br><span class="line">│       ├── Sessions.php</span><br><span class="line">│       ├── Tickets.php</span><br><span class="line">│       └── TotalUsers.php</span><br><span class="line">├── bootstrap.php  //Dcat-admin 启动文件</span><br><span class="line">└── routes.php //后台路由文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DcatAdmin 的前端静态文件在 ```/public/vendor/dcat-admin``` 目录下，同样的对应数据库迁移文件于同步文件在 ```/database/migrations/``` 目录中。</span><br></pre></td></tr></table></figure>

<p>由于是基于 Laravel Admin 而二次开发的，因此他的语言文件包在 <code>/resources/lang</code> 目录中，可根据环境自行进行选择。</p>
<p>之后，我们还需要在开发环境中开启 <strong>Debug</strong> 模式，这主要是因为 DactAdmin 所提供的开发工具需要在 debug 下才可使用，我们只需要在 <code>.env</code> 配置文件中的 <code>APP_DEBUG</code> 值设置为 <code>true</code> 即可。</p>
<h2 id="Controller-生成"><a href="#Controller-生成" class="headerlink" title="Controller 生成"></a>Controller 生成</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220214153714.png"></p>
<p>可以通过访问 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin/helpers/scaffold">Admin | 代码生成器</a> 新建并提交一个数据表文件，之后 DcatAdmin 会在 <code>app/Admin/Controllers</code> 中生成一个名为 <code>UserController</code> 的控制器，并会在 <code>App\Models\</code> 中自动创建一个名为 <code>User</code> 的模型。</p>
<p>之后我们需要做的是只需要在 <code>app/Admin/routes.php</code> 加入一条路由语法 <code>$router-&gt;resource(&#39;name&#39; , &#39;UserController&#39;);</code>，即可，就会生成一组数据列表 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin/users">Admin | 管理员</a>，在下一章节中将会详细讲解并使用 DcatAdmin 构建的表格。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">之后打开 [Admin | 菜单](http://127.0.0.1:8000/admin/auth/menu) 就可以查看对应的 menu 即在管理后台左侧页面中查看用户管理的页面链接路口，同样的你还可以进行相应的编辑。</span><br></pre></td></tr></table></figure>


<h2 id="Repositories"><a href="#Repositories" class="headerlink" title="Repositories"></a>Repositories</h2><p>Dcat Admin 在 Laravel Admin 中引入了一个新的概念，即 Dcat Admin 构建的页面并不直接依赖于 Model，而是直接引入 Repositories 作为中间层，不在与数据的读写产生强耦合的关系。</p>
<p>比如之前我们通过代码生成器所构建的 User，他也会在数据仓库即 <code>app\Admin\Repositories\User</code> 中创建同名的数据仓库文件，其内容为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Admin</span>\<span class="title class_">Repositories</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Repositories</span>\<span class="title">EloquentRepository</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">User</span> <span class="keyword">as</span> <span class="title">UserModel</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">EloquentRepository</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">     <span class="keyword">protected</span> <span class="variable">$eloquentClass</span> = <span class="title class_">UserModel</span>::<span class="variable language_">class</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Import-js"><a href="#Import-js" class="headerlink" title="Import js"></a>Import js</h2><p>Dcat Admin 使用的是 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/jquery-pjax">jquery-pjax - npm (npmjs.com)</a> 所构建的无刷页面， 你可以通过 <a target="_blank" rel="noopener" href="https://liuyib.github.io/2019/09/24/use-pjax-to-your-site/">集成 Pjax 实现网站无刷新加载 | Liuyib’s Blog</a> 这一文档来了解 Pjax 的实现过程。因此引入 Js 的方式也与传统的引入方法不同。</p>
<p>由于 Dcat Admin 构建的是一个单页应用，加载 JS 只会被执行以此，所以在框架为问哦们提供的 <code>Admin::script</code> 方法的载入非常实用，主要分为两个场景，引入文件和引入 JS Code.</p>
<h3 id="JS-file-import"><a href="#JS-file-import" class="headerlink" title="JS file import"></a>JS file import</h3><p>DcatAdmin 所提供的两种方式，主要使用的是 <code>Admin:script</code> 以及 <code>Dcat.ready</code> ，主要使用的是 <code>Renderable</code> 契约来进行实现，对于文件官方给了一套详细的写法说明：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Contracts</span>\<span class="title">Support</span>\<span class="title">Renderable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Admin</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Card</span> <span class="keyword">implements</span> <span class="title">Renderable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$js</span> = [</span><br><span class="line">        <span class="comment">// js脚本不能直接包含初始化操作，否则页面刷新后无效</span></span><br><span class="line">        <span class="string">&#x27;xxx/js/card.min.js&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$css</span> = [</span><br><span class="line">        <span class="string">&#x27;xxx/css/card.min.css&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">script</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&lt;&lt;&lt;JS</span></span><br><span class="line"><span class="string">        console.log(&#x27;所有JS</span>脚本都加载完了<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">        // 初始化操作</span></span><br><span class="line"><span class="string">        $(&#x27;</span>xxx<span class="string">&#x27;).card();</span></span><br><span class="line"><span class="string">JS;        </span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    public function render()</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        // 在这里可以引入你的js或css文件</span></span><br><span class="line"><span class="string">        Admin::js(static::$js);</span></span><br><span class="line"><span class="string">        Admin::css(static::$css);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // 需要在页面执行的JS代码，例如初始化代码</span></span><br><span class="line"><span class="string">        // 通过 Admin::script 设置的JS代码会自动在所有JS脚本都加载完毕后执行</span></span><br><span class="line"><span class="string">        Admin::script($this-&gt;script());</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        return view(&#x27;</span>...<span class="string">&#x27;)-&gt;render();</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>之后即可通过刚刚写完的 <code>Card</code> 组件引入到 Controller 中，以此来使用 Card 组件，需要注意的是，Card 组件需要用到的静态文件只会在当前请求中加载，以此符合“按需引入”的概念。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要注意的是 ```Card``` class 并没有强制要求的存放目录，理论上来说只要能加载，放在什么地方都可以。</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Content</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Card</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params">Content <span class="variable">$content</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 使用上面的Card组件</span></span><br><span class="line">        <span class="comment">// Card组件需要用到的静态文件只会在当前请求加载</span></span><br><span class="line">        <span class="comment">// 其他请求不会加载 </span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$content</span>-&gt;<span class="title function_ invoke__">body</span>(<span class="keyword">new</span> <span class="title class_">Card</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="blade-import-JS"><a href="#blade-import-JS" class="headerlink" title="blade import JS"></a>blade import JS</h3><p>至于 Js Code 的引入则较为方便，直接在 Laravel模板文件中添加即可，但需要注意的是需要把 Js code 放入 <code>Dcat.ready</code> 中执行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Admin</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Admin</span>\<span class="title">Metrics</span>\<span class="title">Examples</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Dashboard</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Column</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Content</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Row</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Admin</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params">Content <span class="variable">$content</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$content</span></span><br><span class="line">            -%<span class="number">3</span>Eheader(<span class="string">&#x27;Dashboard&#x27;</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">description</span>(<span class="string">&#x27;Description...&#x27;</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">body</span>(function (Row <span class="variable">$row</span>) &#123;</span><br><span class="line">                <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, function (Column <span class="variable">$column</span>) &#123;</span><br><span class="line">                    <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="title class_">Dashboard</span>::<span class="title function_ invoke__">title</span>());</span><br><span class="line">                    <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="keyword">new</span> <span class="title class_">Examples\Tickets</span>());</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, function (Column <span class="variable">$column</span>) &#123;</span><br><span class="line">                    <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(function (Row <span class="variable">$row</span>) &#123;</span><br><span class="line">                        <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, <span class="keyword">new</span> <span class="title class_">Examples\NewUsers</span>());</span><br><span class="line">                        <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, <span class="keyword">new</span> <span class="title class_">Examples\NewDevices</span>());</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="keyword">new</span> <span class="title class_">Examples\Sessions</span>());</span><br><span class="line">                    <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="keyword">new</span> <span class="title class_">Examples\ProductOrders</span>());</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="title class_">Admin</span>::<span class="title function_ invoke__">script</span>(</span><br><span class="line">                    <span class="string">&lt;&lt;&lt;JS</span></span><br><span class="line"><span class="string">(function () &#123;</span></span><br><span class="line"><span class="string">    var name = &#x27;test&#x27;;</span></span><br><span class="line"><span class="string">    console.log(&#x27;all end&#x27;, name)</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">JS</span></span><br><span class="line">                );</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;&gt;)</span><br></pre></td></tr></table></figure>

<p>为了方便理解我们可以将上述代码分为两个部分，我们都知道，DactAdmin 主要使用了 Bootstrap + Jquery 主要满足了 Dact Admin 外观以及无刷加载、动画等方面的功能，因此，你可以将下面 Code 分为 Bootstrap 附加功能：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Admin</span>\<span class="title class_">Controllers</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Admin</span>\<span class="title">Metrics</span>\<span class="title">Examples</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Controller</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Dashboard</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Column</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Content</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Layout</span>\<span class="title">Row</span>;  </span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Admin</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeController</span> <span class="keyword">extends</span> <span class="title">Controller</span>  </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params">Content <span class="variable">$content</span></span>)  </span></span><br><span class="line"><span class="function"> </span>&#123; <span class="keyword">return</span> <span class="variable">$content</span>  </span><br><span class="line"> -&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Dashboard&#x27;</span>)  </span><br><span class="line"> -&gt;<span class="title function_ invoke__">description</span>(<span class="string">&#x27;Description...&#x27;</span>)  </span><br><span class="line"> -&gt;<span class="title function_ invoke__">body</span>(function (Row <span class="variable">$row</span>) &#123;  </span><br><span class="line"> <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, function (Column <span class="variable">$column</span>) &#123;  </span><br><span class="line"> <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="title class_">Dashboard</span>::<span class="title function_ invoke__">title</span>());  </span><br><span class="line"> <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="keyword">new</span> <span class="title class_">Examples\Tickets</span>());  </span><br><span class="line"> &#125;);  </span><br><span class="line">  </span><br><span class="line"> <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, function (Column <span class="variable">$column</span>) &#123;  </span><br><span class="line"> <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(function (Row <span class="variable">$row</span>) &#123;  </span><br><span class="line"> <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, <span class="keyword">new</span> <span class="title class_">Examples\NewUsers</span>());  </span><br><span class="line"> <span class="variable">$row</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="number">6</span>, <span class="keyword">new</span> <span class="title class_">Examples\NewDevices</span>());  </span><br><span class="line"> &#125;);  </span><br><span class="line">  </span><br><span class="line"> <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="keyword">new</span> <span class="title class_">Examples\Sessions</span>());  </span><br><span class="line"> <span class="variable">$column</span>-&gt;<span class="title function_ invoke__">row</span>(<span class="keyword">new</span> <span class="title class_">Examples\ProductOrders</span>());  </span><br><span class="line"> &#125;);  </span><br><span class="line"> &#125;);  </span><br><span class="line"> &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这主要是 Dact Admin 下的布局，也就是使用的 bootstap 的栅格系统，在此需要认清楚，<code>row</code> 是行的意思，而 <code>column</code> 是列的意思，至于详细的你可以访问 <a target="_blank" rel="noopener" href="https://learnku.com/docs/dcat-admin/2.x/required-reading-before-development/8083#4bd4cc">开发前必读 | 入门 |《Dcat Admin 中文文档 2.x》| Laravel China 社区 (learnku.com)</a> 查阅 Dcat Admin 的官方文档。</p>
<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20220215104543.png"></p>
<p>而之后以 <code>Admin::script</code> 起头的 DcatAdmin 方法主要是引入 JS Code，而在此之后 DcatAdmin 还提供了类似于模板的语法操作 <code>Dcat.ready</code> 方法，但在此之前我们主要先了解下 Js Code 在 Controller 的使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="title class_">Admin</span>::<span class="title function_">script</span>(  </span><br><span class="line"> &lt;&lt;<span class="language-xml"><span class="tag">&lt;<span class="name">JS</span>  </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">(<span class="attr">function</span> () &#123;  </span></span></span><br><span class="line"><span class="tag"><span class="language-xml"> <span class="attr">var</span> <span class="attr">name</span> = <span class="string">&#x27;test&#x27;</span>; <span class="attr">console.log</span>(&#x27;<span class="attr">javaScript</span> <span class="attr">code</span> &gt;</span>&#x27;, name)&#125;)()  </span></span><br><span class="line"><span class="language-xml">JS  </span></span><br><span class="line"><span class="language-xml"> );</span></span><br></pre></td></tr></table></figure>

<p>之后你就可以访问 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/admin">Admin | Dashboard</a> 页面来查看该 JavaSCript Code 的执行效果，而在此之后我们主要会在页面组件中去使用下一个方法。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/9.Laravel 响应/">Laravel 响应</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>在上一章节的上一章节中我们讲解到了Laravel的请求，而这次我们主要来讲解以下Laravel的响应，学过计算机网络的读者可能会对此联想到TCP&#x2F;IP的三次握手，和四次挥手，本篇我们主要演示下Laravel的响应。</p>
<h2 id="快速构建一个响应"><a href="#快速构建一个响应" class="headerlink" title="快速构建一个响应"></a>快速构建一个响应</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/9.laravel%20%E5%93%8D%E5%BA%94.md/20210209235501258_2068497808.png"><br>如果要说响应，当我们请求过后，Server是不是需要给我们来一个响应信息，而本次我们主要使用Laravel路由来进行快速构建一个响应信息：</p>
<h3 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/response&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello,world!&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="header"><a href="#header" class="headerlink" title="header"></a>header</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/9.laravel%20%E5%93%8D%E5%BA%94.md/20210210001127344_1600727051.png"><br>Laravel项目中，如果想将标头添加到Response之中，我们可以使用<code>header()</code>方法进行，且可以附加多个数据如：</p>
<h3 id="web-php-1"><a href="#web-php-1" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/response&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">response</span>(<span class="string">&#x27;hello,world!&#x27;</span>,<span class="number">200</span>)</span><br><span class="line">        -&gt;<span class="title function_ invoke__">header</span>(<span class="string">&#x27;X-Header-One&#x27;</span>,<span class="string">&#x27;This is 2021&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>当然你也可以指定一些状态代码，比如1xx、2xx、3xx、4xx、5xx这些，分别对应临时响应、成功、重定向、请求错误、服务器错误等。如果想详细学习HTTP状态码的读者可参考菜鸟教程中的一篇文章：<a target="_blank" rel="noopener" href="https://www.runoob.com/http/http-status-codes.html%E3%80%82%E5%9C%A8%E6%9C%AC%E6%96%87%E6%BC%94%E7%A4%BA%E5%BD%93%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9A%84%60%60%60200%60%60%60%E7%8A%B6%E6%80%81%E7%A0%81%E6%84%8F%E6%80%9D%E4%B8%BA%EF%BC%9A%E8%AF%B7%E6%B1%82%E6%88%90%E5%8A%9F%E3%80%82">https://www.runoob.com/http/http-status-codes.html。在本文演示当中使用的```200```状态码意思为：请求成功。</a></p>
<h2 id="withCookie"><a href="#withCookie" class="headerlink" title="withCookie"></a>withCookie</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/9.laravel%20%E5%93%8D%E5%BA%94.md/20210210002916160_2042049787.png"><br>在本文中，我们可以附加带有响应的Cookie，并且使用<code>withCookie</code>方法进行实现，将其cookie附加到响应中，对于Laravel来说，这些cookie都是经过加密和签名的，因此他不具有修改性：</p>
<h3 id="TestController"><a href="#TestController" class="headerlink" title="TestController"></a>TestController</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/response&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">response</span>(<span class="string">&#x27;hello,world!&#x27;</span>,<span class="number">200</span>)</span><br><span class="line">        -&gt;<span class="title function_ invoke__">withCookie</span>(<span class="string">&#x27;jiangxue&#x27;</span>,<span class="string">&#x27;cookie&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/8.Laravel 文件上传/">Laravel 文件上传</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>文件上传是在项目开发中较为常用的一项功能，通常在用户界面中运用在了头像图片或者说在表单提交中的文件上传等相关场景，在本文中将会以Laravel为例。</p>
<h2 id="hasFile-表单是否存在文件"><a href="#hasFile-表单是否存在文件" class="headerlink" title="hasFile (表单是否存在文件)"></a>hasFile (表单是否存在文件)</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/8.laravel%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.md/20210209193114541_885300910.png"><br>Laravel为我们提供了hasFile方法来用于检索表单中是否存在文件，在本文中，如果表单包含了文件则返回yes，否则将会返回no，需要配合前端、路由、控制器进行：</p>
<h3 id="input-blade-php"><a href="#input-blade-php" class="headerlink" title="input.blade.php"></a>input.blade.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/user/name&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &#123;&#123;<span class="title function_ invoke__">csrf_field</span>()&#125;&#125;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;images&quot;</span>&gt;</span><br><span class="line">    &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;up file&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="TestController"><a href="#TestController" class="headerlink" title="TestController"></a>TestController</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">http</span>\<span class="title">Cookie</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">Request <span class="variable">$request</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">hasFile</span>(<span class="string">&#x27;images&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input&#x27;</span> ,function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;input&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/user/name&#x27;</span>, <span class="keyword">array</span>(<span class="string">&#x27;uses&#x27;</span>=&gt;<span class="string">&#x27;TestController@store&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/user/name&#x27;</span>, <span class="string">&#x27;TestController@store&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="store"><a href="#store" class="headerlink" title="store"></a>store</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/8.laravel%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.md/20210209224706740_964917953.png"><br>Laravel还为开发者提供了一种存储上传文件的方法为<code>store</code>，主要存储在<code>/srv/www/htdocs/test_webapp/public/storage</code>目录下，此目录默认情况下是不存在的，所以我们需要使用以下命令进行创建：</p>
<blockquote>
<p>php artisan storage:link</p>
</blockquote>
<h3 id="TestController-1"><a href="#TestController-1" class="headerlink" title="TestController"></a>TestController</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">http</span>\<span class="title">Cookie</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">Request <span class="variable">$request</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="string">&#x27;images&#x27;</span>)-&gt;<span class="title function_ invoke__">store</span>(<span class="string">&#x27;public/storage&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当我们访问“<a target="_blank" rel="noopener" href="http://localhost:8000/input%E2%80%9D%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%AD%A4%E6%AC%A1%E6%88%91%E4%BB%AC%E4%B8%8A%E4%BC%A0%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%EF%BC%8C%E4%B9%8B%E5%90%8E%E6%88%91%E4%BB%AC%E6%88%91%E4%BB%AC%E4%BC%9A%E5%9C%A8%60%60%60/srv/www/htdocs/test_webapp/public/storage%60%60%60%E4%B8%8B%E5%AD%98%E5%82%A8%E4%B8%80%E5%BC%A0%E6%88%91%E4%BB%AC%E5%88%9A%E5%88%9A%E4%B8%8A%E4%BC%A0%E7%9A%84%E7%85%A7%E7%89%87%E5%B9%B6%E7%BB%8F%E8%BF%87%E9%87%8D%E5%91%BD%E5%90%8D%E5%A4%84%E7%90%86%E8%BF%87%E7%9A%84%EF%BC%9AzV193WUEfZSvs00tc78TSu8WPeIbIQjfQnP82ufW.pngw">http://localhost:8000/input”的时候，此次我们上传一张图片，之后我们我们会在```/srv/www/htdocs/test_webapp/public/storage```下存储一张我们刚刚上传的照片并经过重命名处理过的：zV193WUEfZSvs00tc78TSu8WPeIbIQjfQnP82ufW.pngw</a></p>
<h2 id="storeAs"><a href="#storeAs" class="headerlink" title="storeAs"></a>storeAs</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/8.laravel%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.md/20210209230940487_1544007249.png"><br>storeAs在Laravel项目之中主要用于为上传的文件进行命名，如果你将名称写死那么他将会当你提交第二个文件的时候自动将第一张文件进行替换，当然读者也可以自行进行研究如何让他写活？</p>
<h3 id="TestController-2"><a href="#TestController-2" class="headerlink" title="TestController"></a>TestController</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">http</span>\<span class="title">Cookie</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Response</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">Request <span class="variable">$request</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="string">&#x27;images&#x27;</span>)-&gt;<span class="title function_ invoke__">storeAs</span>(<span class="string">&#x27;public/storage&#x27;</span>,<span class="string">&#x27;jiangxue.jpg&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	

	

</article>





	<span class="different-posts">📖 <a href="/page/28">more posts</a> 📖</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>欢迎来到我的 blog <br><br> 通过 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>+<a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a> 进行构建的，存放在 <a target="_blank" rel="noopener" href="https://github.com/vendanges/vendanges.github.io">Github</a> 上。</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2022 John Doe | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
