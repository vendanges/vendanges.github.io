<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>琼瑶</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="琼瑶" type="application/atom+xml">
    
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link" style="color: #fff">Home</a>
			
				<a href="/archives" class="header__link" style="color: #fff">Archive</a>
			
				<a href="/about" class="header__link" style="color: #fff">About</a>
			
		</nav>
		<!-- <h1 class="header__title"><a href="/">琼瑶</a></h1> -->
		<h1 class="header__title"><a href="/"><img style="width: 290px;" src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/202204152017786.png"></a></h1>
		<h2 class="header__subtitle">梦入琼楼寒有月，行过石树冻无烟</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">📖 <a href="/page/28">earlier posts</a> 📖</span>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/19.Laravel Factory SQL/">Laravel Factory SQL</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Laravel 为开发者提供了 <code>Factory</code>解决数据库的创建以及填充，这也在Laravel v6中被称之为“数据库测试”，但本文中主要根据实际情况来创建一个模型工厂（Model factory）。模型工厂主要用于来<strong>新建数据库和相应的模型</strong>，最后映射在数据库中，当然也可以进行数据库的随机填充。</p>
<p>如果将 Laravel Factory 与 Java Spring boot 相比的话，单纯通过数据库映射来进行比较，因为 Spring 是根据你在运行时直接判断是否创建字段和数据库的，如果配置正确则在运行时<strong>直接给你创建</strong>，相比之下 Spring 还是较为方便的。但是如果根据总体功能来将，Laravel Factory 将会更上一层，因为其默认将 fakerr 库作为依赖项，即随着 Laravel 一起进行提供，因此 Factory 还可以对数据库进行<strong>随机填充</strong></p>
<h2 id="创建模型"><a href="#创建模型" class="headerlink" title="创建模型"></a>创建模型</h2><p>在此之前，希望您已经配置了数据库相关的文件，如数据库名称(dataname)、帐号(username)、密码（password）等配置的正确，以及已经成功构建了一个 Laravel 项目并保证<code>php artisan serv</code>可以正确的运行，在此之后您可以进行新建工厂的步骤(create factory）。</p>
<figure class="highlight php"><figcaption><span>artisan make:model Issues -m``` 通过使用 make:model 来创建一个模型，之后会在 **/database/migrations/** 下创建一个名为“2021_05_07_002215_create_issues_table.php”的文件，以及在```app/```路径下新建一个**Issues.php**文件，我们可以通过```2021_05_07_002215_create_issues_table.php```文件中写入**数据库表名和字段类型和名称等**：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Migrations</span>\<span class="title">Migration</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Schema</span>\<span class="title">Blueprint</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Schema</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateIssuesTable</span> <span class="keyword">extends</span> <span class="title">Migration</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Run the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title class_">Schema</span>::<span class="title function_ invoke__">create</span>(<span class="string">&#x27;issues&#x27;</span>, function (Blueprint <span class="variable">$table</span>) &#123;</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">bigIncrements</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;titles&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">dateTime</span>(<span class="string">&#x27;datetimes&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;names&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;category&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;harms&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;paths&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;types&#x27;</span>);</span><br><span class="line">            <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">timestamps</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reverse the migrations.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">down</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title class_">Schema</span>::<span class="title function_ invoke__">dropIfExists</span>(<span class="string">&#x27;issues&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应的数据库命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">create table issues</span><br><span class="line">(</span><br><span class="line">    id         bigint unsigned auto_increment</span><br><span class="line">        primary key,</span><br><span class="line">    titles     text      not null,</span><br><span class="line">    datetimes  datetime  not null,</span><br><span class="line">    names      text      not null,</span><br><span class="line">    category   text      not null,</span><br><span class="line">    harms      text      not null,</span><br><span class="line">    paths      text      not null,</span><br><span class="line">    types      text      not null,</span><br><span class="line">    created_at timestamp null,</span><br><span class="line">    updated_at timestamp null</span><br><span class="line">)</span><br><span class="line">    collate = utf8mb4_unicode_ci;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="映射数据库"><a href="#映射数据库" class="headerlink" title="映射数据库"></a>映射数据库</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210507093541.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php artisan migrate</span><br><span class="line">Migrating: 2021_05_07_002215_create_issues_table</span><br><span class="line">Migrated:  2021_05_07_002215_create_issues_table (0.02 seconds)</span><br></pre></td></tr></table></figure>
<p>当我们创建完模型（create model）之后，需要通过使用<code>php artisan migrate</code>来映射到数据库中，此时数据库将会生成并创建一个名为<code>issues</code>的数据表，在此下包含了对应的字段名称和相应类型。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/18.Laravel Blade/">Laravel Blade</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>在Laravel Blade内，官方所提供了一个简洁且优雅的前端模板引擎，他允许你在blade.php文件内写入html以及PHP代码，他因为所有Blade语法都会被编译成正常的PHP代码并缓存，所以速度会稍微快那么一点。除非在此修改，某则Blade模板将不会在此进行编译，在一般的情况下都会将会存放在<code>/resouces/views</code>目录内。</p>
<h2 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h2><p>在Laravel blade内，模板继承是常见的一种，这种写法在Laravel oauth内使用中，其语法和隔壁Thymeleaf模板引擎更加的简单，其中主要分为定义<code>@section</code>以及<code>@yield</code>显示等。Laravel内，以“@”为开头的将会被称之为<code>“指令”</code>，通过指令我们可以实现继承、循环、判断等。</p>
<h3 id="section……-show-and-yield"><a href="#section……-show-and-yield" class="headerlink" title="@section……@show and @yield"></a>@section……@show and @yield</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/18.laravel%20blade.md/20210228211724552_24845774.png"></p>
<h4 id="index"><a href="#index" class="headerlink" title="index"></a>index</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;-- index.blade.php --&#125;&#125;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;index - @<span class="keyword">yield</span>(<span class="string">&#x27;title&#x27;</span>)&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        @<span class="title function_ invoke__">section</span>(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">            &lt;p&gt;Hello,world!&lt;/p&gt;</span><br><span class="line">        @show</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h4 id="inbar"><a href="#inbar" class="headerlink" title="inbar"></a>inbar</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;inbar.blade.php&#125;&#125;</span><br><span class="line">@<span class="keyword">extends</span>(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">@<span class="title function_ invoke__">section</span>(<span class="string">&#x27;title&#x27;</span>,<span class="string">&#x27;inbar&#x27;</span>)</span><br><span class="line">@<span class="title function_ invoke__">section</span>(<span class="string">&#x27;h1&#x27;</span>,<span class="string">&#x27;Hello,inbar&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>在模板继承中，我们主要使用了<code>@yield</code>以及<code>@section</code>指令，其中@yield <strong>用于显示内容</strong> ，而 <strong>@section</strong> 将会被用于定义一部分内容。所以在index.blade.php内，在<code>&lt;title&gt;</code>标签中使用了@yield即显示”title”内容，所以在<code>inbar.blade.php</code>内容由”@section”所指定定义了<code>title -&gt; inbar</code>所以与<code>index、inbar</code>所组合后的<strong>index- inbar</strong>的标题。</p>
<p>而在index.blade.php<code>@section</code>所定义的将会被<code>@section(&#39;h1&#39;,&#39;Hello,inbar&#39;)</code>所替换，而以后我们将会介绍如何保留<code>@section</code>所替换掉的内容。</p>
<h3 id="section……-parent……-endsection"><a href="#section……-parent……-endsection" class="headerlink" title="@section……@parent……@endsection"></a>@section……@parent……@endsection</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/18.laravel%20blade.md/20210228214357569_604439134.png"></p>
<p>在上述一章中我们介绍了<code>@section……@show……@yield</code>，而此次我们将会增加一个，<code>@parent以及@endsection</code>，这两个指令分别是保留所替换掉的@section以及结束本次替换字段。</p>
<h4 id="index-1"><a href="#index-1" class="headerlink" title="index"></a>index</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;-- index.blade.php --&#125;&#125;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;index - @<span class="keyword">yield</span>(<span class="string">&#x27;title&#x27;</span>)&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        @<span class="title function_ invoke__">section</span>(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">            &lt;p&gt;Hello,world!&lt;/p&gt;</span><br><span class="line">        @show</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h4 id="inbar-1"><a href="#inbar-1" class="headerlink" title="inbar"></a>inbar</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;-- inbar.blade.php --&#125;&#125;</span><br><span class="line">@<span class="keyword">extends</span>(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">@<span class="title function_ invoke__">section</span>(<span class="string">&#x27;title&#x27;</span>,<span class="string">&#x27;inbar&#x27;</span>)</span><br><span class="line">@<span class="title function_ invoke__">section</span>(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">    @<span class="built_in">parent</span></span><br><span class="line">    &lt;p&gt;Hello,inbar!&lt;/p&gt;</span><br><span class="line">@endsection</span><br></pre></td></tr></table></figure>

<p>本文我们通过使用 <code>@parent</code> 来保留使用 <code>@section</code> 指令所替换或覆盖的内容，所以通过使用此指令将会保留覆盖的内容。而<code>@section……@endsection</code>将会使用<code>@section……@endsection</code>来结束替换指令，而不是根据上述使用的<code>@section(&#39;h1&#39;,&#39;Hello,inbar&#39;)</code>。</p>
<h3 id="show-与-endsection"><a href="#show-与-endsection" class="headerlink" title="@show 与 @endsection"></a>@show 与 @endsection</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/18.laravel%20blade.md/20210228220931993_1506667418.png"></p>
<p>根据官方的解释是在同一模板定义<code>@section</code>时，使用<code>@show</code>，而在子模板即<strong>“扩展布局”</strong>中使用<code>@endsection</code>作为结尾。在本文同一模板即index.blade.php内，写入任何信息即“同一模板”，而如果在除了以<code>index.blade.php</code>外的则是子模板。</p>
<h2 id="extends"><a href="#extends" class="headerlink" title="@extends"></a>@extends</h2><p>通过上述介绍，读者得知<code>@extends(&#39;index&#39;)</code>用于引入和扩展视图扩展到另外一个视图内，即将<code>inbar.blade.php</code>内使用<code>@extends(&#39;index&#39;)</code>来引入<code>index.blade.php</code>文件。而<code>&#123;&#123;-- code --&#125;&#125;</code>将会用于注释，这与html所使用的<code>&lt;!-- code --&gt;</code>同意。</p>
<h3 id="with-……-title-（composer）"><a href="#with-……-title-（composer）" class="headerlink" title="with …… title （composer）"></a>with …… title （composer）</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/18.laravel%20blade.md/20210228224358478_863214069.png"></p>
<p>在Laravel中，我们可以通过使用composer来进行数据的传递以及获取和定义，我们可以通过使用此方法来进行视图（view）、控制器（controller）进行传递。</p>
<h4 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;inbar&#x27;</span>)-&gt;<span class="title function_ invoke__">with</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;Hello,world&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="inbar-blade-php"><a href="#inbar-blade-php" class="headerlink" title="inbar.blade.php"></a>inbar.blade.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="variable">$title</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="条件与循环语句"><a href="#条件与循环语句" class="headerlink" title="条件与循环语句"></a>条件与循环语句</h2><h3 id="条件语法"><a href="#条件语法" class="headerlink" title="条件语法"></a>条件语法</h3><h4 id="php-……-endphp"><a href="#php-……-endphp" class="headerlink" title="@php …… @endphp"></a>@php …… @endphp</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/18.laravel%20blade.md/20210228230203673_424818097.png"></p>
<p>在众多的教材以及文档中都会教给大家一段 Laravel Blade引擎模板，所以本文将会以一个i前后顺序来介绍<code>@php……@endphp</code>指令：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$value</span>) === <span class="number">1</span>)</span><br><span class="line">    ……</span><br><span class="line">@<span class="keyword">elseif</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$value</span>) === <span class="number">0</span>)</span><br><span class="line"> ……</span><br><span class="line">@<span class="keyword">else</span></span><br><span class="line">    ……</span><br><span class="line">@<span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h4 id="if……-elseif……-else……-endif"><a href="#if……-elseif……-else……-endif" class="headerlink" title="@if……@elseif……@else……@endif"></a>@if……@elseif……@else……@endif</h4><p>通过上述code你可能会更加疑惑<code>$value</code>是怎么传过去或怎么定义的，此时你会通过使用控制器、路由、视图中进行定义或传入，也许你可以通过使用<code>with</code>来通过路由进行传递，本文我们告知下最为简单的演示<code>@php……@endphp</code>指令的作用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@php</span><br><span class="line">    <span class="variable">$var</span> = <span class="keyword">array</span>(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">@endphp</span><br><span class="line">@<span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$var</span>) === <span class="number">1</span>)</span><br><span class="line">    一个数组</span><br><span class="line">@<span class="keyword">elseif</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$var</span>) &gt;= <span class="number">2</span>)</span><br><span class="line">    大于两个数组</span><br><span class="line">@<span class="keyword">else</span></span><br><span class="line">    都不是</span><br><span class="line">@<span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<p>我们通过以上code和流程图的演示，可以明显的表示出<code>@php……@endphp</code>来定义一个并富有两个数组分别为“1、2”。经过判断语法是大于两个数组的，所以自然而然的输出为<strong>“大于两个数组”</strong>。</p>
<h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><h4 id="for……-foreach"><a href="#for……-foreach" class="headerlink" title="@for……@foreach"></a>@for……@foreach</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/18.laravel%20blade.md/20210228231017638_375148880.png"><br>在Laravel blade模板引擎中，不仅仅为我们提供了一个条件指令<code>@if……@elseif……@else……@endif</code>，自然而然的为开发者提供了一个简单的循环指令<code>@for……@foreach</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="number">10</span>;<span class="variable">$i</span>++)</span><br><span class="line">    共输出 &#123;&#123;<span class="variable">$i</span>&#125;&#125; 次&lt;br&gt;</span><br><span class="line">@<span class="keyword">endfor</span></span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/17.Laravel Homestead/">Laravel Homestead</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Laravel Homestead 由官方所封装对Vagrant box，为开发者所提供来一个完美的开发环境，必须要在本地进行安装相关的PHP开发环境以及相关服务。如果我们在此之前从未接触Laravel，可能会知道Docker，而Laravel我们可以使用Vagrant进行实现。</p>
<h2 id="安装-vagrant"><a href="#安装-vagrant" class="headerlink" title="安装 vagrant"></a>安装 vagrant</h2><p>在Laravel内，Vagrant提供一种简单且优雅的方式来管理和配置虚拟主机，而LcaravelHomestead是官方封装的Vagrant box，提供了一个完美的开发环境，并不需要本地安装 PHP以及其他服务器应用。</p>
<h3 id="vagrant-install"><a href="#vagrant-install" class="headerlink" title="vagrant install"></a>vagrant install</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/17.laravel%20homestead.md/20210228162840501_966217017.png"><br>本文我们将会使用 Arch linux环境进行构建，即pacman软件管理包，在Laravel环境下我们可以非常简单的下载 vagrant，当下载完后我们将会使用 vagrant -v进行检测是否安装成功</p>
<h3 id="下载-box"><a href="#下载-box" class="headerlink" title="下载 box"></a>下载 box</h3><p>在使用<code>vagrant box add laravel/homestead</code>时将会出现下载失败的提示，通常你会等待个几个小时甚者挂一晚上的结果都依然是这种问题。所以你需要通过访问或下载：<code>https://vagrantcloud.com/ubuntu/boxes/xenial64/versions/20190101.0.0/providers/virtualbox.box</code>，将下载完后的文件保存。</p>
<p>将下载后的 xenial-server-cloudimg-amd64-vagrant.box 存放在与vagrant一起的目录，所以我们将会进入到vagrant即“&#x2F;opt&#x2F;vagrant”下使用</p>
<blockquote>
<p>vagrant box add laravel&#x2F;homestead xenial-server-cloudimg-amd64-vagrant.box</p>
</blockquote>
<p>当执行上方命令后，我们会通过使用<code>vagrant box list</code>，来查看导入情况，当出现:<code>laravel/homestead (virtualbox, 0)</code>时即进入下一个步骤。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/16.Laravel Eloquent ORM/">Laravel Eloquent ORM</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Laravel Eloquent ORM即“数据操作”，在前面我们所介绍的数据库当中，使用的是“DB”而Laravel还为我们提供了另一种更加<strong>优雅</strong>的方式，即”Laravel Eloquent ORM”。如果将两者作为比较的话，那么Laravel所提供的另一种数据库操作方式Laravel Eloquent ORM则更加的安全和优雅，其操作和语法类似与Spring boot 中的JPA，但又与JPA不一样，只能说通过一定的语法来代替SQL语法。</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>如果你是通过看文档过来的，那你估计可能看得懂，但是不知道基本的流程。如果做比喻的话可能就是<strong>只教你做饭，不教你点火，但是你都会做饭，她不告诉你要让你炒什么菜</strong>，基本上就是这个意思，本文将会告诉你如何点火，但是基本的做菜知识你还是需要对照“菜谱进行”。</p>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p>如果你要用Eloquent ORM，首先你需要有一个模型，之后在有一个控制器，就行了。其中模型来定义数据库表以及字段，之后你可以通过数据库映射的方式来建立表，本文通过列举User模型进行测试：</p>
<p>Eloquent ORM所需要的模型我们可以理解为用于操作数据库的一道过程，在模型中你可以定义需要连接的数据库以及表等相关的信息。当然Laravel还为我们提供了多表操作的方式来满足不同环境的需求。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Notifications</span>\<span class="title">Notifiable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Contracts</span>\<span class="title">Auth</span>\<span class="title">MustVerifyEmail</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Auth</span>\<span class="title">User</span> <span class="keyword">as</span> <span class="title">Authenticatable</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Authenticatable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Notifiable</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The attributes that are mass assignable.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$fillable</span> = [</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;password&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The attributes that should be hidden for arrays.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$hidden</span> = [</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;remember_token&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The attributes that should be cast to native types.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$casts</span> = [</span><br><span class="line">        <span class="string">&#x27;email_verified_at&#x27;</span> =&gt; <span class="string">&#x27;datetime&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><p>控制器就是你可以来对此进行CURD的一系列操作，Laravel Eloquent ORM也支持你进行一系列的Curd操作，本文我们会使用User模型来进行数据库插入的操作(首先你要引入模型use App\User;)，<code>模型默认在app\</code>目录下，当然你也可以选择使用模型来实现控制器的操作：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">User</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display a listing of the resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Show the form for creating a new resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        <span class="variable">$user</span>-&gt;name=<span class="string">&#x27;test_name&#x27;</span>;</span><br><span class="line">        <span class="variable">$user</span>-&gt;email=<span class="string">&#x27;test_email&#x27;</span>;</span><br><span class="line">        <span class="variable">$user</span>-&gt;password=<span class="string">&#x27;test_password&#x27;</span>;</span><br><span class="line">        <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>在此之前你要确保已经配置好数据库和映射数据库等操作完善且正常</strong>，否则将无法进行下一步操作。</p>
<p>当以上步骤完成之后，你可以在当前项目下执行<code>php artisan migrate</code>来将数据库迁移到本地数据库内。此时你会产生疑惑，数据库表是从那里来的？答案是在database&#x2F;migrations目录下的create_user_table.php、create_password_resets.php、create_ailed_jobes_table.php类定义的。</p>
<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input/test&#x27;</span>, <span class="string">&#x27;PostController@create&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/16.laravel%20eloquent%20orm.md/20210219190656905_701950928.png"><br>此时当你访问<code>http://127.0.0.1:8000/input/test</code>的时候，已经将在控制器所定义的信息插入到了你的数据库之中。</p>
<h2 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h2><h3 id="模型-1"><a href="#模型-1" class="headerlink" title="模型"></a>模型</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/16.laravel%20eloquent%20orm.md/20210219203620642_1523781273.png"><br>在本文中，我们可以通过使用<code>php artisan make:model Tesst</code>来定义一个Laravel模型，最终定义完模型之后将会生成在<code>app</code>目录下，我们可以让模型与数据库进行关联，其中可分为两大部分，分别为：</p>
<ol>
<li>库：如果当前项目或个人有多个数据库之间对操作我们可以定义多个数据库且指定数据库进行操作;</li>
<li>表：定义完库之后我们自然就需要来定义表，一个数据库中可能存在多个表所以我们需要来指定一个表进行操作。</li>
</ol>
<h4 id="Tesst-php"><a href="#Tesst-php" class="headerlink" title="Tesst.php"></a>Tesst.php</h4><h5 id="数据表"><a href="#数据表" class="headerlink" title="数据表"></a>数据表</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tesst</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     * $table 指定数据库表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$table</span> = <span class="string">&#x27;users&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在默认对情况下我们并没有设置Tesst模型到底使用那些表以及那些数据库，所以我们需要明确对指定数据库以及数据表来进行下一步的操作。</p>
<h5 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tesst</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     * $connection 指定 config/databases.php下所定义的数据库链接名称</span></span><br><span class="line"><span class="comment">     * $table 指定数据库表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$connection</span> = <span class="string">&#x27;mysql&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$table</span> = <span class="string">&#x27;users&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在默认对情况下，Eloquent模型将会使用其config&#x2F;databases.php或.env所定义的数据库表，如果有需要我们可以定义多个数据库连接和表，之后在模型中进行指定链接：</p>
<h6 id="config-x2F-databases-php"><a href="#config-x2F-databases-php" class="headerlink" title="config&#x2F;databases.php"></a>config&#x2F;databases.php</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;mysql&#x27;</span> =&gt; [</span><br><span class="line">    <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DATABASE_URL&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;host&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;port&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_PORT&#x27;</span>, <span class="string">&#x27;3306&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_DATABASE&#x27;</span>, <span class="string">&#x27;test&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_USERNAME&#x27;</span>, <span class="string">&#x27;root&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;toor&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;unix_socket&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_SOCKET&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;charset&#x27;</span> =&gt; <span class="string">&#x27;utf8mb4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;collation&#x27;</span> =&gt; <span class="string">&#x27;utf8mb4_unicode_ci&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;prefix_indexes&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;strict&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;engine&#x27;</span> =&gt; <span class="literal">null</span>,</span><br><span class="line">    <span class="string">&#x27;options&#x27;</span> =&gt; <span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;pdo_mysql&#x27;</span>) ? <span class="title function_ invoke__">array_filter</span>([</span><br><span class="line">        PDO::<span class="variable constant_">MYSQL_ATTR_SSL_CA</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MYSQL_ATTR_SSL_CA&#x27;</span>),</span><br><span class="line">    ]) : [],</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<h5 id="模型名称约定"><a href="#模型名称约定" class="headerlink" title="模型名称约定"></a>模型名称约定</h5><h6 id="蛇型命名方法"><a href="#蛇型命名方法" class="headerlink" title="蛇型命名方法"></a>蛇型命名方法</h6><p>蛇型命名方法是Python以及php和一些开发语言之中常用对命名方式之一，其在Laravel也可在很多地方见到如：<code>&#39;host&#39; =&gt; env(&#39;DB_HOST&#39;, &#39;127.0.0.1&#39;),</code>，其中<code>DB_HOST</code>就属于蛇型命名方式。</p>
<h6 id="驼峰命名方式"><a href="#驼峰命名方式" class="headerlink" title="驼峰命名方式"></a>驼峰命名方式</h6><p>驼峰命名方式在Laravel并不常见，如果读者有接触过Spring boot Data JPA就非常了解驼峰对命名格式<strong>TestHost</strong>。</p>
<h3 id="控制器-1"><a href="#控制器-1" class="headerlink" title="控制器"></a>控制器</h3><h4 id="PostController-php"><a href="#PostController-php" class="headerlink" title="PostController.php"></a>PostController.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Tesst</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display a listing of the resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Show the form for creating a new resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Tessts</span> = <span class="keyword">new</span> <span class="title class_">Tesst</span>();</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;name=<span class="string">&#x27;test_namess&#x27;</span>;</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;email=<span class="string">&#x27;test_emailss&#x27;</span>;</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;password=<span class="string">&#x27;test_passwordss&#x27;</span>;</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="CURD"><a href="#CURD" class="headerlink" title="CURD"></a>CURD</h4><h5 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h5><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/16.laravel%20eloquent%20orm.md/20210219205451042_260652286.png"></p>
<h6 id="PostController"><a href="#PostController" class="headerlink" title="PostController"></a>PostController</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Tesst</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display a listing of the resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Show the form for creating a new resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Tessts</span> = <span class="keyword">new</span> <span class="title class_">Tesst</span>();</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;name= <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;user&#x27;</span>);</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;email= <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;email&#x27;</span>);</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;password= <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;password&#x27;</span>);</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="input-blade-php"><a href="#input-blade-php" class="headerlink" title="input.blade.php"></a>input.blade.php</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    User:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;user&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    Email:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;email&quot;</span> /&gt;</span><br><span class="line">    Password:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;password&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h6 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>((<span class="string">&#x27;input&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/input/test&#x27;</span>, <span class="string">&#x27;PostController@create&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h5 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h5><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/16.laravel%20eloquent%20orm.md/20210219210706120_1133887317.png"></p>
<h6 id="PostController-1"><a href="#PostController-1" class="headerlink" title="PostController"></a>PostController</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Tesst</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display a listing of the resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Show the form for creating a new resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Tessts</span> = <span class="keyword">new</span> <span class="title class_">Tesst</span>();</span><br><span class="line">        <span class="title class_">Tesst</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;id&#x27;</span>))-&gt;<span class="title function_ invoke__">delete</span>();<span class="comment">//按主键删除</span></span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;<span class="title function_ invoke__">forceDelete</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="input-blade-php-1"><a href="#input-blade-php-1" class="headerlink" title="input.blade.php"></a>input.blade.php</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    Id:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>在Laravel的官方文档之中，关于删除有两种写法，分别为通过主键删除和软删除两种，本文所使用的是通过主键“id”进行删除，当然你也可以选择软删除。</p>
</blockquote>
<blockquote>
<p>关于软删除本文将不会进行列举，软删除和通过主键删除唯一不同的则是当你使用软删除的时候不会真的在数据库中删除数据，而是在模型中设置一个deleted_at对属性插入数据库，如果模型中有一个非空的delete_at值，那么说明该模型已经被软删除了。</p>
</blockquote>
<h5 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h5><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/16.laravel%20eloquent%20orm.md/20210219214151808_1208694402.png"></p>
<h6 id="PostController-2"><a href="#PostController-2" class="headerlink" title="PostController"></a>PostController</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Tesst</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display a listing of the resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Show the form for creating a new resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Tessts</span> = <span class="title class_">Tesst</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;id&#x27;</span>));</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;name=<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">        <span class="variable">$Tessts</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="input-blade-php-2"><a href="#input-blade-php-2" class="headerlink" title="input.blade.php"></a>input.blade.php</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    Id:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    Name:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;name&quot;</span> /&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h5><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/16.laravel%20eloquent%20orm.md/20210219220536553_468941535.png"></p>
<h6 id="PostController-3"><a href="#PostController-3" class="headerlink" title="PostController"></a>PostController</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Tesst</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display a listing of the resource.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Tessts</span> = <span class="title class_">Tesst</span>::<span class="title function_ invoke__">all</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;input&#x27;</span>,[<span class="string">&#x27;Tessts&#x27;</span>=&gt;<span class="variable">$Tessts</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="input-blade-php-3"><a href="#input-blade-php-3" class="headerlink" title="input.blade.php"></a>input.blade.php</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;table border=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;Id&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    @<span class="keyword">foreach</span> (<span class="variable">$Tessts</span> <span class="keyword">as</span> <span class="variable">$flight</span>)</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;<span class="variable">$flight</span>-&gt;name&#125;&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    @<span class="keyword">endforeach</span></span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="web-php-1"><a href="#web-php-1" class="headerlink" title="web.php"></a>web.php</h3><pre><code class="php">&lt;?php

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the &quot;web&quot; middleware group. Now create something great!
|
*/

Route::get(&#39;/input/test&#39;, &#39;PostController@create&#39;);
</code></pre>
<p>在以上对实例之中，关于PostController.php类来实现增删改查对操作方法处写的并不对，关于CURD增删改查Laravel框架可生成一个CURD模板来规定删除写在……方法下、查询写在……方法下、创建写在……方法下、更新写在……方法下。我们可以通过使用<code>php artisan make:controller PostController --resource</code>来创建一个CURD增删改查的模板。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/15.Laravel 用户认证/">Laravel 用户认证</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>在Laravel 6.v当中，为我们提供了一个与以往不同的认证模块，即<code>Laravel/ui</code>，Laravel&#x2F;ui主要提供了用户认证视图以及Laravel的支持等，以及配合Laravel自带的邮件发送功能实现了用户注册、用户登录、用户验证以及保护路由等。</p>
<h2 id="构建项目"><a href="#构建项目" class="headerlink" title="构建项目"></a>构建项目</h2><p>在使用Laravel&#x2F;ui之前，我们需要构建一个Laravel项目且保证可以正常的运行和访问即可执行下一步操作：</p>
<blockquote>
<p>composer create-project laravel&#x2F;laravel&#x3D;”6.0” test_webapp</p>
</blockquote>
<h3 id="Laravel-x2F-ui"><a href="#Laravel-x2F-ui" class="headerlink" title="Laravel&#x2F;ui"></a>Laravel&#x2F;ui</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/15.laravel%20%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81.md/20210215082622194_2138986521.png"><br>写到这一些读者特别是使用过Laravel 5左右的读者就会产生疑问，Laravel不是使用 Larave&#x2F;auto？为什么到Laravel 6就变成了Laravel&#x2F;ui了，因为Laravel默认自带了一套Laravel auto，所以我们只需要下载Laravel&#x2F;ui来进行访问即可：</p>
<blockquote>
<p>composer require laravel&#x2F;ui “^1.0” –dev<br>php artisan ui vue –auth</p>
</blockquote>
<h3 id="数据库迁移"><a href="#数据库迁移" class="headerlink" title="数据库迁移"></a>数据库迁移</h3><p>所谓数据库迁移，就是说你在php类当中定义过的数据库字段以及表迁移到你本地的数据库之中，在迁移的之前，我们需要修改其数据库配置文件：</p>
<h4 id="env"><a href="#env" class="headerlink" title=".env"></a>.env</h4><p>如果当前项目没有<code>.env</code>文件，且通过git形式进行拉去的，你需要通过<code>cp .env.axample .env</code>进行重构env文件，之后配置其数据：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_HOST=<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">DB_PORT=<span class="number">3306</span> </span><br><span class="line">DB_DATABASE=test</span><br><span class="line">DB_USERNAME=root</span><br><span class="line">DB_PASSWORD=toor</span><br></pre></td></tr></table></figure>

<h4 id="database-php"><a href="#database-php" class="headerlink" title="database.php"></a>database.php</h4><p>database.php类在config目录下，我们需要更改其mysql的配置信息主要包括数据库、账号、密码、等：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;mysql&#x27;</span> =&gt; [</span><br><span class="line">    <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DATABASE_URL&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;host&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;port&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_PORT&#x27;</span>, <span class="string">&#x27;3306&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_DATABASE&#x27;</span>, <span class="string">&#x27;test&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_USERNAME&#x27;</span>, <span class="string">&#x27;root&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;toor&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;unix_socket&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_SOCKET&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;charset&#x27;</span> =&gt; <span class="string">&#x27;utf8mb4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;collation&#x27;</span> =&gt; <span class="string">&#x27;utf8mb4_unicode_ci&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;prefix_indexes&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;strict&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;engine&#x27;</span> =&gt; <span class="literal">null</span>,</span><br><span class="line">    <span class="string">&#x27;options&#x27;</span> =&gt; <span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;pdo_mysql&#x27;</span>) ? <span class="title function_ invoke__">array_filter</span>([</span><br><span class="line">        PDO::<span class="variable constant_">MYSQL_ATTR_SSL_CA</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MYSQL_ATTR_SSL_CA&#x27;</span>),</span><br><span class="line">    ]) : [],</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/15.laravel%20%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81.md/20210215081054368_1648890316.png"><br>当以上步骤完成之后，你可以在当前项目下执行<code>php artisan migrate</code>来将数据库迁移到本地数据库内。此时你会产生疑惑，数据库表是从那里来的？答案是在<code>database/migrations</code>目录下的<code>create_user_table.php、create_password_resets.php、create_ailed_jobes_table.php</code>类定义的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title class_">Schema</span>::<span class="title function_ invoke__">create</span>(<span class="string">&#x27;users&#x27;</span>, function (Blueprint <span class="variable">$table</span>) &#123;</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">bigIncrements</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="keyword">string</span>(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="keyword">string</span>(<span class="string">&#x27;email&#x27;</span>)-&gt;<span class="title function_ invoke__">unique</span>();</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">timestamp</span>(<span class="string">&#x27;email_verified_at&#x27;</span>)-&gt;<span class="title function_ invoke__">nullable</span>();</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="keyword">string</span>(<span class="string">&#x27;password&#x27;</span>);</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">rememberToken</span>();</span><br><span class="line">        <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">timestamps</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="邮件样式与布局"><a href="#邮件样式与布局" class="headerlink" title="邮件样式与布局"></a>邮件样式与布局</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/15.laravel%20%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81.md/20210215093405107_724736279.png"><br>当我们使用后发现，Laravel为我们提供的功能还包括了密码重置、邮件发送等功能，所以我们需要修改其SMTP配置与邮件样式：</p>
<h4 id="SMTP-支持"><a href="#SMTP-支持" class="headerlink" title="SMTP 支持"></a>SMTP 支持</h4><p>在Laravel之中，我们需要修改SMTP的支持配置文件分别为<code>.env、mail.php</code>两个配置文件内信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MAIL_DRIVER=smtp</span><br><span class="line">MAIL_HOST=smtp.xxx.xxxx.com</span><br><span class="line">MAIL_PORT=25</span><br><span class="line">MAIL_USERNAME=oa@zsun.org.cn</span><br><span class="line">MAIL_PASSWORD=xxxx</span><br><span class="line">MAIL_ENCRYPTION=null</span><br></pre></td></tr></table></figure>

<h5 id="config-x2F-mail-php"><a href="#config-x2F-mail-php" class="headerlink" title="config&#x2F;mail.php"></a>config&#x2F;mail.php</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> [</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | Mail Driver</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | Laravel supports both SMTP and PHP&#x27;s &quot;mail&quot; function as drivers for the</span></span><br><span class="line"><span class="comment">    | sending of e-mail. You may specify which one you&#x27;re using throughout</span></span><br><span class="line"><span class="comment">    | your application here. By default, Laravel is setup for SMTP mail.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | Supported: &quot;smtp&quot;, &quot;sendmail&quot;, &quot;mailgun&quot;, &quot;ses&quot;,</span></span><br><span class="line"><span class="comment">    |            &quot;postmark&quot;, &quot;log&quot;, &quot;array&quot;</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_DRIVER&#x27;</span>, <span class="string">&#x27;smtp&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | SMTP Host Address</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | Here you may provide the host address of the SMTP server used by your</span></span><br><span class="line"><span class="comment">    | applications. A default option is provided that is compatible with</span></span><br><span class="line"><span class="comment">    | the Mailgun mail service which will provide reliable deliveries.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;host&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_HOST&#x27;</span>, <span class="string">&#x27;smtp.ym.163.com&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | SMTP Host Port</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | This is the SMTP port used by your application to deliver e-mails to</span></span><br><span class="line"><span class="comment">    | users of the application. Like the host we have set this value to</span></span><br><span class="line"><span class="comment">    | stay compatible with the Mailgun e-mail application by default.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;port&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_PORT&#x27;</span>, <span class="number">25</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | Global &quot;From&quot; Address</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | You may wish for all e-mails sent by your application to be sent from</span></span><br><span class="line"><span class="comment">    | the same address. Here, you may specify a name and address that is</span></span><br><span class="line"><span class="comment">    | used globally for all e-mails that are sent by your application.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;from&#x27;</span> =&gt; [</span><br><span class="line">        <span class="string">&#x27;address&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_FROM_ADDRESS&#x27;</span>, <span class="string">&#x27;oa@zsun.org.cn&#x27;</span>),</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_FROM_NAME&#x27;</span>, <span class="string">&quot;钟山计算机端口安全联合审核平台&quot;</span>),</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | E-Mail Encryption Protocol</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | Here you may specify the encryption protocol that should be used when</span></span><br><span class="line"><span class="comment">    | the application send e-mail messages. A sensible default using the</span></span><br><span class="line"><span class="comment">    | transport layer security protocol should provide great security.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;encryption&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_ENCRYPTION&#x27;</span>, <span class="string">&#x27;tls&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | SMTP Server Username</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | If your SMTP server requires a username for authentication, you should</span></span><br><span class="line"><span class="comment">    | set it here. This will get used to authenticate with your server on</span></span><br><span class="line"><span class="comment">    | connection. You may also set the &quot;password&quot; value below this one.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_USERNAME&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_PASSWORD&#x27;</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | Sendmail System Path</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | When using the &quot;sendmail&quot; driver to send e-mails, we will need to know</span></span><br><span class="line"><span class="comment">    | the path to where Sendmail lives on this server. A default path has</span></span><br><span class="line"><span class="comment">    | been provided here, which will work well on most of your systems.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;sendmail&#x27;</span> =&gt; <span class="string">&#x27;/usr/sbin/sendmail -bs&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | Markdown Mail Settings</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | If you are using Markdown based email rendering, you may configure your</span></span><br><span class="line"><span class="comment">    | theme and component paths here, allowing you to customize the design</span></span><br><span class="line"><span class="comment">    | of the emails. Or, you may simply stick with the Laravel defaults!</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;markdown&#x27;</span> =&gt; [</span><br><span class="line">        <span class="string">&#x27;theme&#x27;</span> =&gt; <span class="string">&#x27;default&#x27;</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;paths&#x27;</span> =&gt; [</span><br><span class="line">            <span class="title function_ invoke__">resource_path</span>(<span class="string">&#x27;views/vendor/mail&#x27;</span>),</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | Log Channel</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | If you are using the &quot;log&quot; driver, you may specify the logging channel</span></span><br><span class="line"><span class="comment">    | if you prefer to keep mail messages separate from other log entries</span></span><br><span class="line"><span class="comment">    | for simpler reading. Otherwise, the default channel will be used.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;log_channel&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MAIL_LOG_CHANNEL&#x27;</span>),</span><br><span class="line"></span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h4 id="邮件样式"><a href="#邮件样式" class="headerlink" title="邮件样式"></a>邮件样式</h4><p>在默认的情况下，邮件样式存储在Laravel项目中的<code>\vendor\laravel\framework\src\llluminate\Mail\rsources</code>目录下，我们可以通过以下两个命令让其创建在&#x2F;resources&#x2F;views&#x2F;vendor文件下：</p>
<blockquote>
<p>php artisan vendor:publish –tag&#x3D;laravel-notifications<br>php artisan vendor:publish –tag&#x3D;laravel-mail</p>
</blockquote>
<p>之后在resources&#x2F;views&#x2F;vendor&#x2F;mail下将会生成对应的邮件样式，我们可以分别的进行更改CSS以及blode.php模板文件</p>
<h5 id="修改邮件内容"><a href="#修改邮件内容" class="headerlink" title="修改邮件内容"></a>修改邮件内容</h5><p>除了文件样式以外我们还可以修改其默认的邮件内容，邮件的内容我们可以通过编辑<code>/vendor/laravel/framework/src/Illuminate/Auth/Notifications</code>内的Php类来实现。</p>
<h3 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/15.laravel%20%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81.md/20210215113128410_1778641908.png"><br>如果你觉得Laravel自带的错误验证消息满足不了你的口味或者说你想来点”自定义“，可以通过修改其<code>vendor/laravel/framework/src/Illuminate/Foundation/Auth</code>目录中的类以及<code>app/Http/Controllers/Auth</code>分别进行修改以得到满足。</p>
<h4 id="ResetsPasswords-php"><a href="#ResetsPasswords-php" class="headerlink" title="ResetsPasswords.php"></a>ResetsPasswords.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Illuminate</span>\<span class="title class_">Foundation</span>\<span class="title class_">Auth</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Auth</span>\<span class="title">Events</span>\<span class="title">PasswordReset</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Auth</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Hash</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Password</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Str</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">ResetsPasswords</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">RedirectsUsers</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Display the password reset view for the given token.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * If no token is present, display the link request form.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Http\Request  $request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  string|null  $token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Contracts\View\Factory|\Illuminate\View\View</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showResetForm</span>(<span class="params">Request <span class="variable">$request</span>, <span class="variable">$token</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;auth.passwords.reset&#x27;</span>)-&gt;<span class="title function_ invoke__">with</span>(</span><br><span class="line">            [<span class="string">&#x27;token&#x27;</span> =&gt; <span class="variable">$token</span>, <span class="string">&#x27;email&#x27;</span> =&gt; <span class="variable">$request</span>-&gt;email]</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reset the given user&#x27;s password.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Http\Request  $request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\RedirectResponse|\Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">reset</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">validate</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">rules</span>(), <span class="variable">$this</span>-&gt;<span class="title function_ invoke__">validationErrorMessages</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Here we will attempt to reset the user&#x27;s password. If it is successful we</span></span><br><span class="line">        <span class="comment">// will update the password on an actual user model and persist it to the</span></span><br><span class="line">        <span class="comment">// database. Otherwise we will parse the error and return the response.</span></span><br><span class="line">        <span class="variable">$response</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">broker</span>()-&gt;<span class="title function_ invoke__">reset</span>(</span><br><span class="line">            <span class="variable">$this</span>-&gt;<span class="title function_ invoke__">credentials</span>(<span class="variable">$request</span>), function (<span class="variable">$user</span>, <span class="variable">$password</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">resetPassword</span>(<span class="variable">$user</span>, <span class="variable">$password</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If the password was successfully reset, we will redirect the user back to</span></span><br><span class="line">        <span class="comment">// the application&#x27;s home authenticated view. If there is an error we can</span></span><br><span class="line">        <span class="comment">// redirect them back to where they came from with their error message.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$response</span> == <span class="title class_">Password</span>::<span class="variable constant_">PASSWORD_RESET</span></span><br><span class="line">                    ? <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">sendResetResponse</span>(<span class="variable">$request</span>, <span class="variable">$response</span>)</span><br><span class="line">                    : <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">sendResetFailedResponse</span>(<span class="variable">$request</span>, <span class="variable">$response</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the password reset validation rules.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">rules</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;token&#x27;</span> =&gt; <span class="string">&#x27;required&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;required|email&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;required|confirmed|min:10&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the password reset validation error messages.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">validationErrorMessages</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;required&#x27;</span> =&gt; <span class="string">&#x27;:attribute 必填&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;需要以邮箱格式填写&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;min&#x27;</span> =&gt; <span class="string">&#x27;密码需要等于或大于十位数或以上&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;confirmed&#x27;</span> =&gt; <span class="string">&#x27;重复密码不正确&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the password reset credentials from the request.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Http\Request  $request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">credentials</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">only</span>(</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;password_confirmation&#x27;</span>, <span class="string">&#x27;token&#x27;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Reset the given user&#x27;s password.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Contracts\Auth\CanResetPassword  $user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  string  $password</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">resetPassword</span>(<span class="params"><span class="variable">$user</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">setUserPassword</span>(<span class="variable">$user</span>, <span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">setRememberToken</span>(<span class="title class_">Str</span>::<span class="title function_ invoke__">random</span>(<span class="number">60</span>));</span><br><span class="line"></span><br><span class="line">        <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">event</span>(<span class="keyword">new</span> <span class="title class_">PasswordReset</span>(<span class="variable">$user</span>));</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">guard</span>()-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$user</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Set the user&#x27;s password.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Contracts\Auth\CanResetPassword  $user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  string  $password</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">setUserPassword</span>(<span class="params"><span class="variable">$user</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$user</span>-&gt;password = <span class="title class_">Hash</span>::<span class="title function_ invoke__">make</span>(<span class="variable">$password</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the response for a successful password reset.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Http\Request  $request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  string  $response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\RedirectResponse|\Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">sendResetResponse</span>(<span class="params">Request <span class="variable">$request</span>, <span class="variable">$response</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">redirectPath</span>())</span><br><span class="line">                            -&gt;<span class="title function_ invoke__">with</span>(<span class="string">&#x27;status&#x27;</span>, <span class="title function_ invoke__">trans</span>(<span class="variable">$response</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the response for a failed password reset.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  \Illuminate\Http\Request  $request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  string  $response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Http\RedirectResponse|\Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">sendResetFailedResponse</span>(<span class="params">Request <span class="variable">$request</span>, <span class="variable">$response</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">redirect</span>()-&gt;<span class="title function_ invoke__">back</span>()</span><br><span class="line">                    -&gt;<span class="title function_ invoke__">withInput</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">only</span>(<span class="string">&#x27;email&#x27;</span>))</span><br><span class="line">                    -&gt;<span class="title function_ invoke__">withErrors</span>([<span class="string">&#x27;email&#x27;</span> =&gt; <span class="title function_ invoke__">trans</span>(<span class="variable">$response</span>)]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the broker to be used during password reset.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Contracts\Auth\PasswordBroker</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">broker</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Password</span>::<span class="title function_ invoke__">broker</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the guard to be used during password reset.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Contracts\Auth\StatefulGuard</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">guard</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Auth</span>::<span class="title function_ invoke__">guard</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="RegisterController-php"><a href="#RegisterController-php" class="headerlink" title="RegisterController.php"></a>RegisterController.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>\<span class="title class_">Auth</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">User</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Hash</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Validator</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Auth</span>\<span class="title">RegistersUsers</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    | Register Controller</span></span><br><span class="line"><span class="comment">    |--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    | This controller handles the registration of new users as well as their</span></span><br><span class="line"><span class="comment">    | validation and creation. By default this controller uses a trait to</span></span><br><span class="line"><span class="comment">    | provide this functionality without requiring any additional code.</span></span><br><span class="line"><span class="comment">    |</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">use</span> <span class="title">RegistersUsers</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Where to redirect users after registration.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$redirectTo</span> = <span class="string">&#x27;/home&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new controller instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">middleware</span>(<span class="string">&#x27;guest&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get a validator for an incoming registration request.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  array  $data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Illuminate\Contracts\Validation\Validator</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">validator</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Validator</span>::<span class="title function_ invoke__">make</span>(<span class="variable">$data</span>, [</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span> =&gt; [<span class="string">&#x27;required&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;max:255&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; [<span class="string">&#x27;required&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;max:255&#x27;</span>, <span class="string">&#x27;unique:users&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; [<span class="string">&#x27;required&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;min:10&#x27;</span>, <span class="string">&#x27;confirmed&#x27;</span>],</span><br><span class="line">        ], [</span><br><span class="line">            <span class="string">&#x27;required&#x27;</span> =&gt; <span class="string">&#x27;:attribute 必填&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;string&#x27;</span> =&gt; <span class="string">&#x27;:attribute 需以字符串形式&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;:attribute 要以邮箱格式&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;min&#x27;</span> =&gt; <span class="string">&#x27;:attribute 最小十位数&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;max&#x27;</span> =&gt; <span class="string">&#x27;:attribute 最大不能超过255位&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;confirmed&#x27;</span> =&gt; <span class="string">&#x27;:attribute 不一致&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;unique&#x27;</span> =&gt; <span class="string">&#x27;:attribute 邮箱冲突&#x27;</span>,</span><br><span class="line">        ], [</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&quot;联合团队账号名称&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new user instance after a valid registration.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  array  $data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \App\User</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">User</span>::<span class="title function_ invoke__">create</span>([</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$data</span>[<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; <span class="variable">$data</span>[<span class="string">&#x27;email&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> =&gt; <span class="title class_">Hash</span>::<span class="title function_ invoke__">make</span>(<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>]),</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/14.Laravel 数据库/">Laravel 数据库</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>如果我们要开发一个交互性非常强的站点，那么数据库交互就是这其中必不可少的一项，在目前，Laravel主要支持四种主流的数据库分别为：“MySQL、PostgreSQL、SQLite、SQL Server”。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>在Laravel之中，配置数据库主要可以通过<code>config/database.php</code>类进行，也可通过配置<code>.env</code>文件来实现，本文我们以配置MySQL为例：</p>
<h3 id="database-php"><a href="#database-php" class="headerlink" title="database.php"></a>database.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;mysql&#x27;</span> =&gt; [</span><br><span class="line">    <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DATABASE_URL&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;host&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;port&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_PORT&#x27;</span>, <span class="string">&#x27;3306&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;database&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_DATABASE&#x27;</span>, <span class="string">&#x27;test&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_USERNAME&#x27;</span>, <span class="string">&#x27;root&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;toor&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;unix_socket&#x27;</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;DB_SOCKET&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;charset&#x27;</span> =&gt; <span class="string">&#x27;utf8mb4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;collation&#x27;</span> =&gt; <span class="string">&#x27;utf8mb4_unicode_ci&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;prefix_indexes&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;strict&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;engine&#x27;</span> =&gt; <span class="literal">null</span>,</span><br><span class="line">    <span class="string">&#x27;options&#x27;</span> =&gt; <span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;pdo_mysql&#x27;</span>) ? <span class="title function_ invoke__">array_filter</span>([</span><br><span class="line">        PDO::<span class="variable constant_">MYSQL_ATTR_SSL_CA</span> =&gt; <span class="title function_ invoke__">env</span>(<span class="string">&#x27;MYSQL_ATTR_SSL_CA&#x27;</span>),</span><br><span class="line">    ]) : [],</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<h3 id="env"><a href="#env" class="headerlink" title=".env"></a>.env</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_HOST=<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">DB_PORT=<span class="number">3306</span></span><br><span class="line">DB_DATABASE=test</span><br><span class="line">DB_USERNAME=root</span><br><span class="line">DB_PASSWORD=toor</span><br></pre></td></tr></table></figure>

<h2 id="CURD-（增删改查）"><a href="#CURD-（增删改查）" class="headerlink" title="CURD （增删改查）"></a>CURD （增删改查）</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/14.laravel%20%E6%95%B0%E6%8D%AE%E5%BA%93.md/20210211083508017_1006013777.png"><br>在实际的开发项目过程中，对数据库操作最为主要的就是“CURD”即<strong>增删改查</strong>的一系列操作，对此Laravel为我们提供了一个专门用于进行CURD操作的控制器模板，我们可以通过使用命令进行创建：</p>
<blockquote>
<p>php artisan make:controller PostController –resource</p>
</blockquote>
<p>之后创建的数据库CURD模板将会自动在<code>app/Http/Controllers</code>目录下生成，至控制器的信息我们可以重新回顾下<code>6.Laravel 控制器</code>所学的知识。</p>
<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><p>在Laravel之中，我们可以引入DB扩展中的<code>insert</code>方法来进行插入，且支持多数据插入如下：</p>
<h4 id="input-blode-php"><a href="#input-blode-php" class="headerlink" title="input.blode.php"></a>input.blode.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    Username:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="PostController"><a href="#PostController" class="headerlink" title="PostController"></a>PostController</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Show the form for creating a new resource.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    DB::<span class="title function_ invoke__">insert</span>(<span class="string">&#x27;insert into user(id) value(?)&#x27;</span>, [<span class="variable">$id</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="web-app"><a href="#web-app" class="headerlink" title="web.app"></a>web.app</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>((<span class="string">&#x27;input&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/input/test&#x27;</span>, <span class="string">&#x27;PostController@create&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/14.laravel%20%E6%95%B0%E6%8D%AE%E5%BA%93.md/20210211102048089_154161389.png"><br>在增删改查中，删除数据排第二，也是一项非常常用的需求，通常只有管理员权限才可以做到这种功能，如果使用Laravel来实现的话需要<code>delete</code>方法：</p>
<h4 id="PostController-1"><a href="#PostController-1" class="headerlink" title="PostController"></a>PostController</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Remove the specified resource from storage.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  int  $id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">destroy</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    DB::<span class="title function_ invoke__">delete</span>(<span class="string">&#x27;delete from user where id = ?&#x27;</span>,[<span class="variable">$id</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="input-blode-php-1"><a href="#input-blode-php-1" class="headerlink" title="input.blode.php"></a>input.blode.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    Username:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/show&#x27;</span>, <span class="string">&#x27;PostController@show&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/input/test&#x27;</span>, <span class="string">&#x27;PostController@destroy&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/14.laravel%20%E6%95%B0%E6%8D%AE%E5%BA%93.md/20210211104620737_1305690968.png"><br>在本次的演示当中，我们主要将数据库中的2更改为20，当然由于我们数据库中只有一个”id”字段，如果需要作出指定修改你需要建立两个字段，来进行配合，本次我们只演示如何修改字段数据，可以使用<code>update</code>数据：</p>
<h4 id="PostController-2"><a href="#PostController-2" class="headerlink" title="PostController"></a>PostController</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Show the form for editing the specified resource.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  int  $id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">edit</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">input</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    DB::<span class="title function_ invoke__">update</span>(<span class="string">&#x27;update user set id=?&#x27;</span>,[<span class="variable">$id</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="input-blude-php"><a href="#input-blude-php" class="headerlink" title="input.blude.php"></a>input.blude.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    Username:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;id&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="web-php-1"><a href="#web-php-1" class="headerlink" title="web.php"></a>web.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>((<span class="string">&#x27;input&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/input/test&#x27;</span>, <span class="string">&#x27;PostController@edit&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/14.laravel%20%E6%95%B0%E6%8D%AE%E5%BA%93.md/20210211100923491_1615165733.png"><br>对于Laravel的数据查询，也是一项非常简单且优雅的语法形式，其主要使用<code>select</code>方法进行查询：</p>
<h4 id="PostControoller"><a href="#PostControoller" class="headerlink" title="PostControoller"></a>PostControoller</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Display the specified resource.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  int  $id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$users</span> = DB::<span class="title function_ invoke__">select</span>(<span class="string">&#x27;select * from user&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;input&#x27;</span>, [<span class="string">&#x27;users&#x27;</span>=&gt;<span class="variable">$users</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="input-blade-php"><a href="#input-blade-php" class="headerlink" title="input.blade.php"></a>input.blade.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;table border=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    @<span class="keyword">foreach</span> (<span class="variable">$users</span> <span class="keyword">as</span> <span class="variable">$user</span>)</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;<span class="variable">$user</span>-&gt;id&#125;&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    @<span class="keyword">endforeach</span></span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="web-php-2"><a href="#web-php-2" class="headerlink" title="web.php"></a>web.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/show&#x27;</span>, <span class="string">&#x27;PostController@show&#x27;</span>);</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/13.Laravel 表单验证/">Laravel 表单验证</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>在Laravel之中提供了很多种不同的方法来验证表单所传入的数据，在默认的情况下Laravel会使用基本的控制器类<code>validatesRequest</code>所定义的，该类提供了各种强大的验证规则来验证所传入的HTTP请求：</p>
<h2 id="表单传输方式"><a href="#表单传输方式" class="headerlink" title="表单传输方式"></a>表单传输方式</h2><p>通常我们会验证表单的传输方式分别为POST或是GET，对此Laravel为我们提供了一个<code>isMethod</code>方法来进行验证，我们可以在路由中进行也可在控制器中进行，本文为了简约流程所以使用路由进行：</p>
<h3 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>((<span class="string">&#x27;input&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/input/test&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">isMethod</span>(<span class="string">&#x27;post&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="input-blode-php"><a href="#input-blode-php" class="headerlink" title="input.blode.php"></a>input.blode.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;/input/test&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    Username:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> /&gt;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;up&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="验证规则"><a href="#验证规则" class="headerlink" title="验证规则"></a>验证规则</h2><h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><p>通常在原生态的PHP语言之中，验证规则通常会使用正则表达式等方式，但是由于正则表达式不宜于阅读，所以Laravel为我们提供了一种更好的<code>validate</code>方法，主要分为制定规则、错误回显、表单命名等。如果传入的请求参数未通过指定的验证规则，Laravel 则会将用户重定向到之前的位置中，并且将错误信息存储至 <code>session</code>中。</p>
<figure class="highlight plaintext"><figcaption><span>变量由 ```Iliumineat\View\middleware\ShareErrorsFormSession```中间件绑定至视图当中，当这个中间件被使用会就可一在视图获取到 ```$error```变量（在理论上来将 $error 可以被安全的使用）</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```php</span><br><span class="line">// input.blode.php</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- </span><br><span class="line">    这里主要用于返回错误信息</span><br><span class="line">--&gt;</span><br><span class="line">@if($errors-&gt;any())</span><br><span class="line">    &lt;div class=&quot;alert alert-danger&quot;&gt;</span><br><span class="line">        @foreach($errors-&gt;all() as $error)</span><br><span class="line">            &lt;p&gt;&#123;&#123;$error&#125;&#125;&lt;/p&gt;</span><br><span class="line">        @endforeach</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">@endif</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;/input/test&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=&quot;hidden&quot; name=&quot;_token&quot; value=&quot;&lt;?php echo csrf_token()?&gt;&quot;&gt;</span><br><span class="line">    Username:&lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;&amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;up&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestController</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">Request <span class="variable">$request</span></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">all</span>());</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">validate</span>(<span class="variable">$request</span>, [</span><br><span class="line">             <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 用于定义规则</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">           <span class="string">&#x27;username&#x27;</span>=&gt;<span class="string">&#x27;required|max:1|alpha&#x27;</span>,</span><br><span class="line">        ], [</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * |- 大类</span></span><br><span class="line"><span class="comment">             * |    |- required 必填</span></span><br><span class="line"><span class="comment">             * |    |- max 最大</span></span><br><span class="line"><span class="comment">             * |    |- min 最小</span></span><br><span class="line"><span class="comment">             * |    |- integer 数值</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="string">&#x27;required&#x27;</span> =&gt; <span class="string">&#x27;:attribute 必填&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;max&#x27;</span> =&gt; <span class="string">&#x27;:attribute 长度不能大于一个字符&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;alpha&#x27;</span> =&gt; <span class="string">&#x27;:attribute 只能包含字母&#x27;</span>,</span><br><span class="line">        ], [</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * |- 用于给input表单进行命名，时候后会输出</span></span><br><span class="line"><span class="comment">             * |    |-&quot;账号名称 必填&quot;</span></span><br><span class="line"><span class="comment">             * |- 如果不使用则会输出</span></span><br><span class="line"><span class="comment">             * |    |- username 账号名称</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">           <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;账号名称&#x27;</span>,</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> web.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/input&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>((<span class="string">&#x27;input&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/input/test&#x27;</span>, <span class="string">&#x27;TestController@store&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="返回错误信息"><a href="#返回错误信息" class="headerlink" title="返回错误信息"></a>返回错误信息</h4><h5 id="返回全部错误信息"><a href="#返回全部错误信息" class="headerlink" title="返回全部错误信息"></a>返回全部错误信息</h5><p>如果传入的请求参数未通过指定的验证规则，Laravel 则会将用户重定向到之前的位置中，并且将错误信息存储至 <code>session</code>中。</p>
<blockquote>
<p>$error 变量由 <code>Iliumineat\View\middleware\ShareErrorsFormSession</code>中间件绑定至视图当中，当这个中间件被使用会就可一在视图获取到 <code>$error</code>变量（在理论上来将 $error 可以被安全的使用）</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">if</span>(<span class="variable">$errors</span>-&gt;<span class="title function_ invoke__">any</span>())</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">alert</span> <span class="title">alert</span>-<span class="title">danger</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        @<span class="title">foreach</span>($<span class="title">errors</span>-&gt;<span class="title">all</span>() <span class="title">as</span> $<span class="title">error</span>)</span></span><br><span class="line"><span class="class">            &lt;<span class="title">p</span>&gt;</span>&#123;&#123;<span class="variable">$error</span>&#125;&#125;&lt;/p&gt;</span><br><span class="line">        @<span class="keyword">endforeach</span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">@<span class="keyword">endif</span></span><br></pre></td></tr></table></figure>
<p>在上述的 code 中，主要可以返回全部的错误信息，假设<code>表单1、表单2</code>为通过验证规则，则会将这两个表单的错误信息显示在一个标签之中。</p>
<h5 id="返回单个错误信息"><a href="#返回单个错误信息" class="headerlink" title="返回单个错误信息"></a>返回单个错误信息</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="title function_ invoke__">error</span>(<span class="string">&#x27;titles&#x27;</span>)</span><br><span class="line">    &lt;p&gt;&#123;&#123;<span class="variable">$message</span>&#125;&#125;&lt;/p&gt;</span><br><span class="line">@enderror</span><br><span class="line">&lt;textarea <span class="class"><span class="keyword">class</span>=&quot;<span class="title">issue</span>-<span class="title">textarea</span> @<span class="title">error</span>(&quot;<span class="title">titles</span>&quot;) <span class="title">is</span> <span class="title">issue</span>-<span class="title">orss</span> @<span class="title">enderror</span>&quot; <span class="title">rows</span>=&quot;1&quot; <span class="title">name</span>=&quot;<span class="title">titles</span>&quot;&gt;&lt;/<span class="title">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>返回单个信息有好处也有缺点，好处就是我们可以通过返回的单个信息来设置显示 <strong>如果该表单为通过验证时的样式</strong>，而缺点则是 <strong>需要一个一个的写</strong>。</p>
<h3 id="验证表单请求"><a href="#验证表单请求" class="headerlink" title="验证表单请求"></a>验证表单请求</h3><h4 id="创建一个请求类"><a href="#创建一个请求类" class="headerlink" title="创建一个请求类"></a>创建一个请求类</h4><p>面对更繁杂的表单验证，可以通过创建一个 <strong>表单请求</strong> 来处理表单验证的逻辑，该请求类是包含验证是的验证逻辑，通常可以通过下述 <code>Artisan</code> 命令进行创建。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:request StoreTestPost</span><br></pre></td></tr></table></figure>

<p>创建之后该请求类将会存放在 <code>app/Http/Requests/</code> 目录下，我们分别可以通过 <strong>authorize、rules、messages、attributes</strong> 来对请求类进行一系列的设置和操作：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Http</span>\<span class="title class_">Requests</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Http</span>\<span class="title">FormRequest</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StoreTestPost</span> <span class="keyword">extends</span> <span class="title">FormRequest</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 确定用户是否有权提出此请求。</span></span><br><span class="line"><span class="comment">     * Determine if the user is authorized to make this request.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">authorize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取应用于请求的验证规则。</span></span><br><span class="line"><span class="comment">     * Get the validation rules that apply to the request.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rules</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;test&#x27;</span> =&gt; <span class="string">&#x27;required&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 为规则写入提示信息</span></span><br><span class="line"><span class="comment">     * Write prompt information for rules</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">messages</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;required&#x27;</span> =&gt; <span class="string">&#x27;:attribute必填&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 为表单设置名称</span></span><br><span class="line"><span class="comment">     * Set a name for the form</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attributes</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">          <span class="string">&#x27;test&#x27;</span> =&gt; <span class="string">&quot;测试&quot;</span>,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是我们还需要修改当前的控制器，将请求改为表单请求：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Store a newly created resource in storage.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  StoreTestPost  $request</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\Response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">StoreTestPost <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//web.php</span></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">post</span>(<span class="string">&#x27;/upload&#x27;</span>,<span class="string">&quot;PostController@store&quot;</span>);</span><br></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">if</span>(<span class="variable">$errors</span>-&gt;<span class="title function_ invoke__">any</span>())</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        @<span class="keyword">foreach</span>(<span class="variable">$errors</span>-&gt;<span class="title function_ invoke__">all</span>() <span class="keyword">as</span> <span class="variable">$error</span>)</span><br><span class="line">            &lt;p&gt;&#123;&#123;<span class="variable">$error</span>&#125;&#125;&lt;/p&gt;</span><br><span class="line">        @<span class="keyword">endforeach</span></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">@<span class="keyword">endif</span></span><br><span class="line">&#123;&#123;--inbar.blade.php--&#125;&#125;</span><br><span class="line">&lt;form action=<span class="string">&quot;/upload&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    @csrf</span><br><span class="line">    &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_token&quot;</span> value=<span class="string">&quot;&lt;?php echo csrf_token()?&gt;&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;test&quot;</span>&gt;</span><br><span class="line">    &lt;button type=<span class="string">&quot;submit&quot;</span>&gt;Up File&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h4 id="当前语言下的错误提示信息"><a href="#当前语言下的错误提示信息" class="headerlink" title="当前语言下的错误提示信息"></a>当前语言下的错误提示信息</h4><p>如果你的需求只是简单的想将 <strong>表单所提示的错误信息</strong> 改成你想要的，那么通过编辑 <code>resources/lang/en/validation.php</code> 文件也是一个非常好的选择，除此之外它还可以通过<code>attributes</code>支持自定义的表单名称。</p>
<h2 id="Laravel-目前支持的验证规则"><a href="#Laravel-目前支持的验证规则" class="headerlink" title="Laravel 目前支持的验证规则"></a>Laravel 目前支持的验证规则</h2><table>
<thead>
<tr>
<th>DA</th>
<th>FA</th>
<th>DA</th>
</tr>
</thead>
<tbody><tr>
<td>accepted</td>
<td>验证必须是<strong>yes\on\1\true</strong></td>
<td>可以运用在服务条款</td>
</tr>
<tr>
<td>active_url</td>
<td>验证字段是有效的A或aa记录</td>
<td></td>
</tr>
<tr>
<td>after:date</td>
<td>必须是指定日期之后的值</td>
<td></td>
</tr>
<tr>
<td>after_or_equal:date</td>
<td>验证字段是指定日期之后与此日期相同的值</td>
<td></td>
</tr>
<tr>
<td>alpha</td>
<td>验证必须是由字母组成的数据</td>
<td></td>
</tr>
<tr>
<td>alpha_dash</td>
<td>允许包含字母、数字以及破折号和下划线的数据</td>
<td></td>
</tr>
<tr>
<td>alpha_num</td>
<td>必须完全是字母或数字的数据</td>
<td></td>
</tr>
<tr>
<td>array</td>
<td>验证数据是一个php数组</td>
<td></td>
</tr>
<tr>
<td>bail</td>
<td>在第一次验证失败后停止验证规则</td>
<td></td>
</tr>
<tr>
<td>before:date</td>
<td>这个验证的数据必须是指定的日期值</td>
<td></td>
</tr>
<tr>
<td>before_or_equal:date</td>
<td>验证数据必须是在指定日期之前或相同的日期</td>
<td></td>
</tr>
<tr>
<td>between:min,max</td>
<td>安正数据的大小必须在min和max之间</td>
<td></td>
</tr>
<tr>
<td>boolean</td>
<td>验证数据必须可以转换为boolean类型</td>
<td>接受true、false、1、0</td>
</tr>
<tr>
<td>confirmed</td>
<td>验证数据必须具有匹配字段</td>
<td>验证字段为password，输入必须存在匹配的password字段</td>
</tr>
<tr>
<td>date</td>
<td>根据php函数，验证必须是有效的日期</td>
<td></td>
</tr>
<tr>
<td>date_equals:date</td>
<td>验证数据必须等于指定日期</td>
<td></td>
</tr>
<tr>
<td>date_format:format</td>
<td>验证数据必须匹配指定的日期格式</td>
<td></td>
</tr>
<tr>
<td>different:field</td>
<td>验证的数据必须与field值不同</td>
<td></td>
</tr>
<tr>
<td>digits:value</td>
<td>验证数据必须为numeric</td>
<td>且必须具有准确长度的value</td>
</tr>
<tr>
<td>dimensions</td>
<td>u验证文件必须是图片且比例符合规则</td>
<td>min_width:x,min_height&#x3D;n</td>
</tr>
<tr>
<td>ditinct</td>
<td>验证数组时数据不允许有任何重复</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>验证数据符合e-mail地址格式</td>
<td></td>
</tr>
<tr>
<td>ends_with:foo,bar</td>
<td>验证数据必须是指定值内的结尾</td>
<td></td>
</tr>
<tr>
<td>exists:table,column</td>
<td>验证数据必须存在指定的数据库表中</td>
<td></td>
</tr>
<tr>
<td>file</td>
<td>验证数据必须是成功上传的文件</td>
<td></td>
</tr>
<tr>
<td>filled</td>
<td>验证数据的存在时不可为空</td>
<td></td>
</tr>
<tr>
<td>ge:field</td>
<td>验证数据必须大于指定的field</td>
<td>两个数据必须是相同的类型</td>
</tr>
<tr>
<td>gte:field</td>
<td>验证数据必须大于或等于指定的fileld</td>
<td></td>
</tr>
<tr>
<td>image</td>
<td>验证数据必须为图片</td>
<td></td>
</tr>
<tr>
<td>in:foo,bar</td>
<td>雅正数据必须包含在指定的值列表中</td>
<td></td>
</tr>
<tr>
<td>in_array:anotherfield.*</td>
<td>验证数据必须存在与另一个字段antherfield值中</td>
<td></td>
</tr>
<tr>
<td>integer</td>
<td>验证数据必须时整数</td>
<td></td>
</tr>
<tr>
<td>ip</td>
<td>验证数据必须是ip地址</td>
<td>ip</td>
</tr>
<tr>
<td>ipv4</td>
<td>验证数据必须是ipv4地址</td>
<td>ip</td>
</tr>
<tr>
<td>ipv6</td>
<td>验证数据必须是ipv6地址</td>
<td>ip</td>
</tr>
<tr>
<td>json</td>
<td>验证数据必须是有效的json字符串</td>
<td></td>
</tr>
<tr>
<td>lt:field</td>
<td>验证数据必须是指定的field</td>
<td></td>
</tr>
<tr>
<td>lte_field</td>
<td>验证数据必须小于或等于指定的数据</td>
<td></td>
</tr>
<tr>
<td></td>
<td>max:value</td>
<td>验证数据必须小于或等于给定的值</td>
</tr>
<tr>
<td>mimetypes:text&#x2F;plain</td>
<td>验证文件必须具备列出的其中一个扩展匹配的MIME类型</td>
<td></td>
</tr>
<tr>
<td>mimes:foo,bar</td>
<td>验证文件必须是具有列出其中一个扩展名对应的mime类型</td>
<td>mimes:jpeg,png</td>
</tr>
<tr>
<td>min:value</td>
<td>验证数据必须具有最小值</td>
<td></td>
</tr>
<tr>
<td>not_in:foo,bar</td>
<td>验证数据不能包含在指定的值列表中</td>
<td></td>
</tr>
<tr>
<td>not_regex:pattern</td>
<td>验证数据必须与值idngd正则表达式不匹配</td>
<td></td>
</tr>
<tr>
<td>nullable</td>
<td>验证数据可以为<code>null</code></td>
<td></td>
</tr>
<tr>
<td>memeric</td>
<td>验证数据必须为数值</td>
<td></td>
</tr>
<tr>
<td>password</td>
<td>验证中的数据必须与经过身分验证的用户密码进行匹配</td>
<td></td>
</tr>
<tr>
<td>present</td>
<td>验证数据必须存在输入的数据中</td>
<td>可以为空？</td>
</tr>
<tr>
<td>regex:pattern</td>
<td>验证数据必须与指定的正则表达式进行匹配</td>
<td></td>
</tr>
<tr>
<td>required</td>
<td>验证的字段必须存在于输入的数据中，而不是为空</td>
<td>值为null、值为空字符串、无路径的上传文件</td>
</tr>
<tr>
<td>required_if:anotherfield,value_one,value_two</td>
<td>如果其他数据为任意一值，此验证数据必须存在且不为空</td>
<td></td>
</tr>
<tr>
<td>required_unless:anotherfield,value</td>
<td>如果数据不等于任意值，此验证数据必须存在且不可为空</td>
<td></td>
</tr>
<tr>
<td>required_with:foo,bar</td>
<td>在其他任意指定数据出现时，验证的数据必须存在且不可为空</td>
<td></td>
</tr>
<tr>
<td>required_with_all:foo,bar</td>
<td>只有在任意一段数据全部出现时，验证数据才必须存在且不为空</td>
<td></td>
</tr>
<tr>
<td>reqrequired_without:foo,bar</td>
<td>在其他数据不出现时，验证数据才存在且不可为空</td>
<td></td>
</tr>
<tr>
<td>required_without_all:foo,bar</td>
<td>只有在其他指定数据字段全部不出现时，验证数据才可存在且不可为空</td>
<td></td>
</tr>
<tr>
<td>same:field</td>
<td>验证数据必须与指定数据相匹配</td>
<td></td>
</tr>
<tr>
<td>size:value</td>
<td>验证数据必须指定值大小一致</td>
<td></td>
</tr>
<tr>
<td>starts_with:foo,bar</td>
<td>验证数据必须以指定值之一开头</td>
<td></td>
</tr>
<tr>
<td>string</td>
<td>验证数据必须是一个字符串</td>
<td></td>
</tr>
<tr>
<td>timezone</td>
<td>验证数据必须符合php函数所定义的有效时区标识</td>
<td>timezoune_identifiers_list</td>
</tr>
<tr>
<td>unique:table,column,except,idColumn</td>
<td>验证数据在指定数据库表中是唯一的</td>
<td></td>
</tr>
</tbody></table>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/12.Laravel Session/">Laravel Session</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>Session即会话控制，主要将客户端的信息存储于cookie之中，这也将会带来很多问题，如果客户端禁用了cookie支持，那么session也将被禁用。在Laravel之中，Session主要提供了一种在多请求之间存储有关用户信息的方法。</p>
<p>Session的配置文件主要存储在<code>config/session.php</code>文件之中，默认的情况下session驱动四file，在生产环境中可以考虑使用memcached或是redis进行驱动，为此Leravel自带了以下几个开箱即用的驱动：</p>
<ol>
<li>file：将session存储在<code>storage/framework.session</code>;</li>
<li>cookie： 将cookie存储在加密的cookie之中;</li>
<li>database：Session将会被存储在关系型数据库之中;</li>
<li>memcached and redis：将session存储在基于高速缓存的存储系统内;</li>
<li>arrar：将session存储在php数组之中，但是不会被持久化。</li>
</ol>
<h2 id="检索-session"><a href="#检索-session" class="headerlink" title="检索 session"></a>检索 session</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210142247053_290223486.png"><br>对于session的检索，Laravel为我们提供了一个非常友好且简洁的<code>get</code>方法，使用该方法可以获取指定的session信息：</p>
<h3 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="variable">$value</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;_token&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$value</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="获取当前所有的-session"><a href="#获取当前所有的-session" class="headerlink" title="获取当前所有的 session"></a>获取当前所有的 session</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210140103794_1313786480.png"><br>在Laravel框架内，如果要检索所有的数据，我们可以使用Laravel session所提供的<code>all</code>方法来检索所有会话数据：</p>
<h3 id="web-php-1"><a href="#web-php-1" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="variable">$session</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">all</span>();</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$session</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="判断是否存在"><a href="#判断是否存在" class="headerlink" title="判断是否存在"></a>判断是否存在</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210141043760_438142867.png"><br>在以上示例内我们主要介绍了如何获取当前的session数据，所以本次我们需要进行判断该session是否存在，如果返回<code>yes</code>即说明存在，返回<code>no</code>即不存在，本次我们主要使用<code>exiets</code>以及<code>has</code>分别进行演示：</p>
<h3 id="exists"><a href="#exists" class="headerlink" title="exists"></a>exists</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="variable">$session</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">all</span>();</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$session</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">exists</span>(<span class="string">&#x27;_token&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="has"><a href="#has" class="headerlink" title="has"></a>has</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210141229554_2117742366.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="variable">$session</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">all</span>();</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$session</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">has</span>(<span class="string">&#x27;_token&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="存储-session"><a href="#存储-session" class="headerlink" title="存储 session"></a>存储 session</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210142436713_1066060916.png"><br>在此前我们主要介绍了如何查询和判断session相关，那么如果要进行session存储需要如何实现？对此Laravel为我们提供了<code>put</code>方法：</p>
<h3 id="web-php-2"><a href="#web-php-2" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="comment">// 存储</span></span><br><span class="line">    <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">put</span>(<span class="string">&#x27;jiangxue&#x27;</span>,<span class="string">&#x27;Jiang Xue analyzes the open knowledge repository&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">session</span>([<span class="string">&#x27;key&#x27;</span>=&gt;<span class="string">&#x27;value&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="variable">$value</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;jiangxue&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$value</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 判断</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">has</span>(<span class="string">&#x27;jiangxue&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="临时-session"><a href="#临时-session" class="headerlink" title="临时 session"></a>临时 session</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210145326560_126734561.png"><br>临时session与临时url一样，几乎是只要你刷新过后就会被进行删除，在通常需要实现该功能可能需要很久，对于Laravel·而言，只需要使用<code>flash</code>方法即可：</p>
<h3 id="web-php-3"><a href="#web-php-3" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="comment">// 存储</span></span><br><span class="line">    <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">flash</span>(<span class="string">&#x27;jiangxue&#x27;</span>,<span class="string">&#x27;Jiang Xue analyzes the open knowledge repository&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">session</span>([<span class="string">&#x27;key&#x27;</span>=&gt;<span class="string">&#x27;value&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="variable">$value</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;jiangxue&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$value</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">has</span>(<span class="string">&#x27;jiangxue&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="删除-session"><a href="#删除-session" class="headerlink" title="删除 session"></a>删除 session</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/12.laravel%20session.md/20210210144809860_1050624557.png"><br>当然，有了存储就有了删除，如何进行删除是一个非常重要的问题，对此Laravel为我们提供了<code>forget</code>方法将用于删除单个session或者多个session：</p>
<h3 id="web-php-4"><a href="#web-php-4" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url&#x27;</span>, function (Request <span class="variable">$request</span>) &#123;</span><br><span class="line">    <span class="comment">// 存储</span></span><br><span class="line">    <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">put</span>(<span class="string">&#x27;jiangxue&#x27;</span>,<span class="string">&#x27;Jiang Xue analyzes the open knowledge repository&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">session</span>([<span class="string">&#x27;key&#x27;</span>=&gt;<span class="string">&#x27;value&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="variable">$value</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;jiangxue&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$value</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 删除</span></span><br><span class="line"><span class="comment">     * 如需要删除多个可使用 $request-&gt;session()-&gt;forget([&#x27;key_one&#x27;, &#x27;key_two&#x27;]);</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">forget</span>(<span class="string">&#x27;jiangxue&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;<span class="title function_ invoke__">session</span>()-&gt;<span class="title function_ invoke__">has</span>(<span class="string">&#x27;jiangxue&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/11.Laravel URL/">Laravel URL</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>在Laravel框架之中，为我们提供了丰富的url方法，分别可以实现访问、输出、返回、签名等效果的url，本文我们将会使用该方法进行一系列的url演示：</p>
<h2 id="输出url"><a href="#输出url" class="headerlink" title="输出url"></a>输出url</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/11.laravel%20url.md/20210210105508464_646762168.png"><br>在Laravel之中，读者最为期待的是输出url信息的方法，使用Laravel框架，输出url方法只需要使用<code>current</code>即可：</p>
<h3 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">View</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url/&#123;name&#125;&#x27;</span>, function (<span class="variable">$name</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">url</span>()-&gt;<span class="title function_ invoke__">current</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="获取上一个请求的url"><a href="#获取上一个请求的url" class="headerlink" title="获取上一个请求的url"></a>获取上一个请求的url</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/11.laravel%20url.md/20210210110029879_2074840744.png"><br>当然，除了获取url，Laravel还为我们提供了另一种用于获取上一个url的方法<code>previous</code>，我们可以通过使用该方法来获取用户上一个页面的url:</p>
<h3 id="web-php-1"><a href="#web-php-1" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/*</span><br><span class="line">|--------------------------------------------------------------------------</span><br><span class="line">| Web Routes</span><br><span class="line">|--------------------------------------------------------------------------</span><br><span class="line">|</span><br><span class="line">| Here is where you can register web routes for your application. These</span><br><span class="line">| routes are loaded by the RouteServiceProvider within a group which</span><br><span class="line">| contains the &quot;web&quot; middleware group. Now create something great!</span><br><span class="line">|</span><br><span class="line">*/</span><br><span class="line">use Illuminate\Support\Facades\View;</span><br><span class="line"></span><br><span class="line">Route::get(&#x27;/&#x27;, function () &#123;</span><br><span class="line">    return view(&#x27;welcome&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Route::get(&#x27;/url/&#123;name&#125;&#x27;, function ($name) &#123;</span><br><span class="line">    echo url()-&gt;previous();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="命名url路由"><a href="#命名url路由" class="headerlink" title="命名url路由"></a>命名url路由</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/11.laravel%20url.md/20210210110911124_876713428.png"><br>Laravel还为我们提供了一种命名url路由的方式，如果阅读过以往篇幅的读者可能会对此感到熟悉，就是<code>命名路由</code>，可以根据路由名称进行输出对应的信息：</p>
<h3 id="web-php-2"><a href="#web-php-2" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url/&#123;name&#125;&#x27;</span>, function (<span class="variable">$name</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">route</span>(<span class="string">&#x27;url.name&#x27;</span>,</span><br><span class="line">        [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$name</span>]);</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">name</span>(<span class="string">&#x27;url.name&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="设置默认值？"><a href="#设置默认值？" class="headerlink" title="设置默认值？"></a>设置默认值？</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/11.laravel%20url.md/20210210110840168_900074866.png"><br>当然我们还可以为此设置一个默认值，也就就是说不管你的url是多少，都会输出这个默认值：</p>
<h5 id="web-php-3"><a href="#web-php-3" class="headerlink" title="web.php"></a>web.php</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url/&#123;name&#125;&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">route</span>(<span class="string">&#x27;url.name&#x27;</span>,</span><br><span class="line">        [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;hello&#x27;</span>]);</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">name</span>(<span class="string">&#x27;url.name&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="URL-签名"><a href="#URL-签名" class="headerlink" title="URL 签名"></a>URL 签名</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/11.laravel%20url.md/20210210122939324_534901254.png"><br>在这里面的url签名指的是如果你访问的是<code>localhost:8000/url/111</code>，那么他会修改下url的相关数据如修改成：“<a target="_blank" rel="noopener" href="http://localhost:8000/url/jiangxue?signature=7ec0cf1d32c6189a1a9b3be402f870427686e5528dd912ceb27e9bc89ed85417%E2%80%9D%EF%BC%8C%E8%80%8C%E7%94%9F%E6%88%90%E7%9A%84%E8%BF%99%E4%B8%AA%E8%BF%9E%E6%8E%A5%E4%B8%8E%E4%BD%A0%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%60%60%60localhost:8000/url/111%60%60%60%E6%95%88%E6%9E%9C%E6%98%AF%E7%9B%B8%E5%90%8C%E7%9A%84%EF%BC%8C%E8%BF%99%E9%A1%B9%E6%8A%80%E6%9C%AF%E4%B9%9F%E8%A2%AB%E8%BF%90%E7%94%A8%E5%9C%A8%E4%BA%86%E9%82%AE%E7%AE%B1%E5%8F%91%E9%80%81%E4%B8%8E%E8%AE%A4%E8%AF%81%E5%BD%93%E4%B8%AD%EF%BC%9A">http://localhost:8000/url/jiangxue?signature=7ec0cf1d32c6189a1a9b3be402f870427686e5528dd912ceb27e9bc89ed85417”，而生成的这个连接与你直接访问```localhost:8000/url/111```效果是相同的，这项技术也被运用在了邮箱发送与认证当中：</a></p>
<h3 id="web-php-4"><a href="#web-php-4" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">URL</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url/&#123;name&#125;&#x27;</span>, function (<span class="variable">$name</span>) &#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title class_">Url</span>::<span class="title function_ invoke__">signedRoute</span>(<span class="string">&#x27;url.name&#x27;</span>, [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;jiangxue&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$url</span>;</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">name</span>(<span class="string">&#x27;url.name&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="临时-URL"><a href="#临时-URL" class="headerlink" title="临时 URL"></a>临时 URL</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/11.laravel%20url.md/20210210123407296_1086119123.png"><br>Laravel对url的支持还远不于以上所列举的方法，为了更好的应用在以上邮箱认证的场景下，Laravel还提供了一个临时的url生成方法<code>temporaySignedRoute</code>，<strong>就是说他是会变的</strong>：</p>
<h3 id="web-php-5"><a href="#web-php-5" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/url/&#123;name&#125;&#x27;</span>, function (<span class="variable">$name</span>) &#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title class_">Url</span>::<span class="title function_ invoke__">temporarySignedRoute</span>(<span class="string">&#x27;url.name&#x27;</span>, <span class="title function_ invoke__">now</span>()-&gt;<span class="title function_ invoke__">addHour</span>(), [</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;jiangxue&#x27;</span></span><br><span class="line">    ]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$url</span>;</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">name</span>(<span class="string">&#x27;url.name&#x27;</span>);</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/php/laravel/10.Laravel 视图/">Laravel 视图</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/laravel/" rel="tag">laravel</a> <a class="article__tag-none-link" href="/tags/php/" rel="tag">php</a>
			</span>
		
	</div>

	

	
		<p>在Laravel框架中，为我们提供了一个<code>blade.php</code>的后缀扩展名，首先blade.php是由Laravel所提供的一个简单且强大的模板引擎，这与Spring boot所提供的Thyemeleaf类似。blade并不会限制在视图中使用的原生php code，所有blade视图文件都会被编译成原生的php code并将此缓存，除非被再次修改否则将不会被重新编译，并一般情况下存储在<code>resources/views</code>目录下。</p>
<h2 id="路由与视图参数传递"><a href="#路由与视图参数传递" class="headerlink" title="路由与视图参数传递"></a>路由与视图参数传递</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/10.laravel%20%E8%A7%86%E5%9B%BE.md/20210210094643346_513911574.png"><br>所谓路由与参数进行传递，其实就是获取请求的信息并在blade.app内进行调用其函数并输出后的信息，即路由与视图参数：</p>
<h3 id="web-php"><a href="#web-php" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">| Web Routes</span></span><br><span class="line"><span class="comment">|--------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| Here is where you can register web routes for your application. These</span></span><br><span class="line"><span class="comment">| routes are loaded by the RouteServiceProvider within a group which</span></span><br><span class="line"><span class="comment">| contains the &quot;web&quot; middleware group. Now create something great!</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/views/&#123;name&#125;&#x27;</span>, function (<span class="variable">$name</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="title function_ invoke__">view</span>(<span class="string">&#x27;views&#x27;</span>, [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$name</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="views-blade-php"><a href="#views-blade-php" class="headerlink" title="views.blade.php"></a>views.blade.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Hello,&#123;&#123;<span class="variable">$name</span>&#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="视图共享"><a href="#视图共享" class="headerlink" title="视图共享"></a>视图共享</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/10.laravel%20%E8%A7%86%E5%9B%BE.md/20210210101302412_1867798053.png"><br>在Laravel之中，如果需要不同之间的视图进行数据的共享，我们可以使用<code>app/Providers/</code>目录下的<code>AppServiceProvider.php</code>类，在boot方法下写入需要共享的函数和参数即可：</p>
<h3 id="AppServiceProvider-php"><a href="#AppServiceProvider-php" class="headerlink" title="AppServiceProvider.php"></a>AppServiceProvider.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Bootstrap any application services.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">view</span>()-&gt;<span class="title function_ invoke__">share</span>(<span class="string">&#x27;date&#x27;</span>,<span class="string">&#x27;2021&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="views-blade-php-1"><a href="#views-blade-php-1" class="headerlink" title="views.blade.php"></a>views.blade.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;This is be Input up&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Hello,&#123;&#123;<span class="variable">$date</span>&#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="判断视图是否存在"><a href="#判断视图是否存在" class="headerlink" title="判断视图是否存在"></a>判断视图是否存在</h2><p>  <img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/10.laravel%20%E8%A7%86%E5%9B%BE.md/20210210102754315_1464969605.png"><br>Laravel为我们提供了一种针对视图是否存在的方法<code>exists</code>，只需在路由web.php类中进行定义即可：</p>
<h3 id="web-php-1"><a href="#web-php-1" class="headerlink" title="web.php"></a>web.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Route</span>::<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/views&#x27;</span>, function () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">view</span>()-&gt;<span class="title function_ invoke__">exists</span>(<span class="string">&#x27;views&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;yes&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="自定义错误页面"><a href="#自定义错误页面" class="headerlink" title="自定义错误页面"></a>自定义错误页面</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/markdown/web/php/laravel/10.laravel%20%E8%A7%86%E5%9B%BE.md/20210211112604757_1685435945.png"><br>在Laravel项目之中，可以通过在<code>resources/views/errors</code>内新建各个HTTP状态码的对应<code>blode.php</code>页面，本文主要演示404页面：</p>
<h3 id="404-blode-php"><a href="#404-blode-php" class="headerlink" title="404.blode.php"></a>404.blode.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;<span class="number">404</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;<span class="number">404</span>&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
	

	

</article>





	<span class="different-posts">📖 <a href="/page/30">more posts</a> 📖</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>欢迎来到我的 blog <br><br> 通过 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>+<a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a> 进行构建的，存放在 <a target="_blank" rel="noopener" href="https://github.com/vendanges/vendanges.github.io">Github</a> 上。</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2022 John Doe | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
