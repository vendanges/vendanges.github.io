<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>琼瑶</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="琼瑶" type="application/atom+xml">
    
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/" class="header__link" style="color: #fff">Home</a>
			
				<a href="/archives" class="header__link" style="color: #fff">Archive</a>
			
				<a href="/about" class="header__link" style="color: #fff">About</a>
			
		</nav>
		<!-- <h1 class="header__title"><a href="/">琼瑶</a></h1> -->
		<h1 class="header__title"><a href="/"><img style="width: 290px;" src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/202204152017786.png"></a></h1>
		<h2 class="header__subtitle">梦入琼楼寒有月，行过石树冻无烟</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">📖 <a href="/page/8">earlier posts</a> 📖</span>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/2.D3 项目构建/">D3 项目构建</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p>当了解上述D3介绍之后，我们可以通过引入 <code>d3.js</code>来直接帮助我们支持d3.js语法，首先我们可以通过使用<code>min.js</code>版本即官方所提供的在线引入方式，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://d3js.org/d3.v6.min.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>通过使用<code>d3.js</code>所提供的本地js文件中，通常会有两种js，分别为<code>.js</code>以及<code>min.js</code>，一种是在开发环境中进行使用的，而<code>min.js</code>则是在项目发布的时候直接进行使用，两者实现了同样的功能，但唯一不同的是<code>min.js</code>将所有空格都合并了，而<code>.js</code>的code则符合js的代码格式规范，当引入之后我们可以通过绘制一个svg来证明d3.js是否引入成功:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;D3.js&lt;/title&gt;</span><br><span class="line">        &lt;script src=&quot;https://d3js.org/d3.v3.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;circle&gt;&lt;/circle&gt;</span><br><span class="line">        &lt;script&gt;</span><br><span class="line">            var width = 200;</span><br><span class="line">            var height = 200;</span><br><span class="line">            var svg = d3.select(&quot;body&quot;)</span><br><span class="line">                .append(&quot;svg&quot;)</span><br><span class="line">                .attr(&quot;width&quot;,width)</span><br><span class="line">                .attr(&quot;height&quot;,height);</span><br><span class="line">            svg.append(&quot;circle&quot;)</span><br><span class="line">                .attr(&quot;cx&quot;,&quot;50px&quot;)</span><br><span class="line">                .attr(&quot;cy&quot;,&quot;50px&quot;)</span><br><span class="line">                .attr(&quot;r&quot;,&quot;50px&quot;)</span><br><span class="line">                .attr(&quot;fill&quot;,&quot;blue&quot;);</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/19.D3 折线图/">D3 折线图</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p>折线图（<code>Line Chart</code>）是一种常见的数据图表之一，主要可以表示<strong>随时间而变化的连续数据</strong>，可以表示数据的支持与对比。在下列例图中，我们以<code>d3.rgb(2550,0,0) , d3.rgb(0,0,255), d3.rgb(200,100,255), d3.rgb(0,0,100)</code>来分别表示<code>中国、美国、日本、欧盟</code>2010～2019的<code>GDP</code>增长折线图。<br><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210406010514.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 定义基本结构数据 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">1400</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1000</span>,</span><br><span class="line">    <span class="attr">top</span>: <span class="number">250</span>,</span><br><span class="line">    <span class="attr">right</span>: <span class="number">50</span>,</span><br><span class="line">    <span class="attr">bottom</span>: <span class="number">50</span>,</span><br><span class="line">    <span class="attr">left</span>: <span class="number">150</span>,</span><br><span class="line">    <span class="attr">totalMax</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">markStep</span>: <span class="number">80</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数据 */</span></span><br><span class="line"><span class="keyword">var</span> databases = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;China&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">39959795970621.48</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">49572577715343.02</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">56010676972614.25</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">62825888774607.08</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">68768668100531.38</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">72614671348154.00</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">73741967153063.72</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">80812913356157.63</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">91213919284620.56</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">93742077498697.55</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;Usa&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">98416829331664.20</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">102030827915318.41</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">106326874443245.41</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">110185821032061.61</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">115058818792197.00</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">119637894766824.02</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">122856229947754.81</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">128136749246503.20</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">135100516865529.61</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">140700555399600.02</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;Japan&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">37418864084048.47</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">40421259256175.07</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">40721612856309.18</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">33845220187590.04</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">31841024698668.49</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">28815151672041.19</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">32314493883388.93</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">31949018103634.34</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">32526323537619.18</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">33359784337901.19</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;European Union&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">95476038828627.59</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">103354095012906.06</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">96081433361419.91</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">100395059650212.97</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">102621853711647.17</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">88918041106989.56</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">73741967153063.72</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">96883204984092.13</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">104804012847872.91</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">102581383668424.91</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 筛选出最大数据 */</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt; databases.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> currTotal = d3.<span class="title function_">max</span>(databases[i].<span class="property">total</span>, <span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d[<span class="number">1</span>]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> (currTotal &gt; padding.<span class="property">totalMax</span>)</span><br><span class="line">        padding.<span class="property">totalMax</span> = currTotal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 坐标轴规格 */</span></span><br><span class="line"><span class="keyword">var</span> xScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">    .<span class="title function_">domain</span>([<span class="number">2010</span>,<span class="number">2019</span>])</span><br><span class="line">    .<span class="title function_">range</span>([<span class="number">0</span>,<span class="number">912</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">    .<span class="title function_">domain</span>([<span class="number">0</span>,<span class="number">140000000000000</span>])</span><br><span class="line">    .<span class="title function_">range</span>([padding.<span class="property">height</span> - padding.<span class="property">top</span> - padding.<span class="property">bottom</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> linePath = d3.<span class="property">svg</span>.<span class="title function_">line</span>()</span><br><span class="line">    .<span class="title function_">x</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">xScale</span>(d[<span class="number">0</span>])</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">yScale</span>(d[<span class="number">1</span>])</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 粉分别定义颜色 */</span></span><br><span class="line"><span class="keyword">var</span> color = [d3.<span class="title function_">rgb</span>(<span class="number">2550</span>,<span class="number">0</span>,<span class="number">0</span>) , d3.<span class="title function_">rgb</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>), d3.<span class="title function_">rgb</span>(<span class="number">200</span>,<span class="number">100</span>,<span class="number">255</span>), d3.<span class="title function_">rgb</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">100</span>) ]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 路径 */</span></span><br><span class="line">svg.<span class="title function_">selectAll</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + padding.<span class="property">top</span> +<span class="string">&quot;)&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>, <span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">linePath</span>(d.<span class="property">total</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="number">2</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>, <span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> color[i]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 文字标记与文字路径 */</span></span><br><span class="line"><span class="keyword">var</span> gMark = svg.<span class="title function_">selectAll</span>(<span class="string">&quot;.gMark&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;translate(&quot;</span> + (padding.<span class="property">left</span> + i * padding.<span class="property">markStep</span>) + <span class="string">&quot;,&quot;</span> + (padding.<span class="property">height</span> - padding.<span class="property">bottom</span> + <span class="number">40</span>) + <span class="string">&quot;)&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">gMark.<span class="title function_">append</span>(<span class="string">&quot;rect&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;x&quot;</span>,<span class="number">0</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;y&quot;</span>,<span class="number">0</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,<span class="number">10</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,<span class="number">10</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> color[i]</span><br><span class="line">    &#125;)</span><br><span class="line">gMark.<span class="title function_">append</span>(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;dx&quot;</span>,<span class="number">15</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;dy&quot;</span>,<span class="string">&quot;.5em&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">text</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d.<span class="property">country</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 坐标轴 */</span></span><br><span class="line"><span class="keyword">var</span> xAxis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">    .<span class="title function_">scale</span>(xScale)</span><br><span class="line">    .<span class="title function_">tickFormat</span>(d3.<span class="title function_">format</span>(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">    .<span class="title function_">orient</span>(<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yAxis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">    .<span class="title function_">scale</span>(yScale)</span><br><span class="line">    .<span class="title function_">tickFormat</span>(d3.<span class="title function_">format</span>(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">    .<span class="title function_">orient</span>(<span class="string">&quot;left&quot;</span>)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + (padding.<span class="property">height</span> - padding.<span class="property">bottom</span>) + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">    .<span class="title function_">call</span>(xAxis)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + padding.<span class="property">top</span> + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">    .<span class="title function_">call</span>(yAxis)</span><br></pre></td></tr></table></figure>

<h2 id="增加交互"><a href="#增加交互" class="headerlink" title="增加交互"></a>增加交互</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210414202615.png"><br>下述 <code>code</code>中我们主要先设置<code>givecuo</code>，将鼠标经过时显示出数据的详细信息，并通过<code>line</code>自动根据鼠标位置移动<code>参考线</code>来增加体验：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 定义基本结构数据 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">900</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">top</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">right</span>: <span class="number">50</span>,</span><br><span class="line">    <span class="attr">bottom</span>: <span class="number">50</span>,</span><br><span class="line">    <span class="attr">left</span>: <span class="number">150</span>,</span><br><span class="line">    <span class="attr">totalMax</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">markStep</span>: <span class="number">80</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 数据 */</span></span><br><span class="line"><span class="keyword">var</span> databases = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;China&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">39959795970621.48</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">49572577715343.02</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">56010676972614.25</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">62825888774607.08</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">68768668100531.38</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">72614671348154.00</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">73741967153063.72</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">80812913356157.63</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">91213919284620.56</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">93742077498697.55</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;Usa&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">98416829331664.20</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">102030827915318.41</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">106326874443245.41</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">110185821032061.61</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">115058818792197.00</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">119637894766824.02</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">122856229947754.81</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">128136749246503.20</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">135100516865529.61</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">140700555399600.02</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;Japan&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">37418864084048.47</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">40421259256175.07</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">40721612856309.18</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">33845220187590.04</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">31841024698668.49</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">28815151672041.19</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">32314493883388.93</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">31949018103634.34</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">32526323537619.18</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">33359784337901.19</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">country</span>: <span class="string">&quot;European Union&quot;</span>,</span><br><span class="line">        <span class="attr">total</span>: [</span><br><span class="line">            [<span class="number">2010</span>,<span class="number">95476038828627.59</span>],</span><br><span class="line">            [<span class="number">2011</span>,<span class="number">103354095012906.06</span>],</span><br><span class="line">            [<span class="number">2012</span>,<span class="number">96081433361419.91</span>],</span><br><span class="line">            [<span class="number">2013</span>,<span class="number">100395059650212.97</span>],</span><br><span class="line">            [<span class="number">2014</span>,<span class="number">102621853711647.17</span>],</span><br><span class="line">            [<span class="number">2015</span>,<span class="number">88918041106989.56</span>],</span><br><span class="line">            [<span class="number">2016</span>,<span class="number">73741967153063.72</span>],</span><br><span class="line">            [<span class="number">2017</span>,<span class="number">96883204984092.13</span>],</span><br><span class="line">            [<span class="number">2018</span>,<span class="number">104804012847872.91</span>],</span><br><span class="line">            [<span class="number">2019</span>,<span class="number">102581383668424.91</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 筛选出最大数据 */</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt; databases.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> currTotal = d3.<span class="title function_">max</span>(databases[i].<span class="property">total</span>, <span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d[<span class="number">1</span>]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> (currTotal &gt; padding.<span class="property">totalMax</span>)</span><br><span class="line">        padding.<span class="property">totalMax</span> = currTotal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 坐标轴规格 */</span></span><br><span class="line"><span class="keyword">var</span> xScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">    .<span class="title function_">domain</span>([<span class="number">2010</span>,<span class="number">2019</span>])</span><br><span class="line">    .<span class="title function_">range</span>([<span class="number">0</span>,<span class="number">912</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">    .<span class="title function_">domain</span>([<span class="number">0</span>,<span class="number">140000000000000</span>])</span><br><span class="line">    .<span class="title function_">range</span>([padding.<span class="property">height</span> - padding.<span class="property">top</span> - padding.<span class="property">bottom</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> linePath = d3.<span class="property">svg</span>.<span class="title function_">line</span>()</span><br><span class="line">    .<span class="title function_">x</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">xScale</span>(d[<span class="number">0</span>])</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">yScale</span>(d[<span class="number">1</span>])</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 粉分别定义颜色 */</span></span><br><span class="line"><span class="keyword">var</span> color = [d3.<span class="title function_">rgb</span>(<span class="number">2550</span>,<span class="number">0</span>,<span class="number">0</span>) , d3.<span class="title function_">rgb</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>), d3.<span class="title function_">rgb</span>(<span class="number">200</span>,<span class="number">100</span>,<span class="number">255</span>), d3.<span class="title function_">rgb</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">100</span>) ]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 路径 */</span></span><br><span class="line">svg.<span class="title function_">selectAll</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + padding.<span class="property">top</span> +<span class="string">&quot;)&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>, <span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">linePath</span>(d.<span class="property">total</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="number">1</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>, <span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> color[i]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    添加提示框</span></span><br><span class="line"><span class="comment">        1.首先定义一个直线，默认为不可见</span></span><br><span class="line"><span class="comment">        2.新建一个 &lt;div&gt; 矩形框，默认为不可见</span></span><br><span class="line"><span class="comment">        3.其次单个 &lt;div&gt; 添加对应的标题，之后通过 .des 分别添加 desText、desColor</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> vLine = svg.<span class="title function_">append</span>(<span class="string">&quot;line&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;focusLine&quot;</span>)</span><br><span class="line">    .<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;none&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hLine = svg.<span class="title function_">append</span>(<span class="string">&quot;line&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;focusLine&quot;</span>)</span><br><span class="line">    .<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>, <span class="string">&quot;none&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> givecuo = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;div&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;givecuo&quot;</span>)</span><br><span class="line">    .<span class="title function_">style</span>(<span class="string">&quot;opacity&quot;</span>,<span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> title = givecuo.<span class="title function_">append</span>(<span class="string">&quot;div&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> des = givecuo.<span class="title function_">selectAll</span>(<span class="string">&quot;.des&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;div&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> desColor = des.<span class="title function_">append</span>(<span class="string">&quot;div&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;desColor&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> desText = des.<span class="title function_">append</span>(<span class="string">&quot;div&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;desText&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> focusCircle = svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;focusCircle&quot;</span>)</span><br><span class="line">    .<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line"></span><br><span class="line">focusCircle.<span class="title function_">append</span>(<span class="string">&quot;circle&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;r&quot;</span>,<span class="number">4.5</span>)</span><br><span class="line"></span><br><span class="line">focusCircle.<span class="title function_">append</span>(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;dx&quot;</span>,<span class="number">10</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;dy&quot;</span>,<span class="string">&quot;1em&quot;</span>)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    设置一个透明的监视鼠标事件矩形</span></span><br><span class="line"><span class="comment">    当鼠标移出时，再次将透明度设置为0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;rect&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;overlay&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;x&quot;</span>,padding.<span class="property">left</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;y&quot;</span>,padding.<span class="property">top</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,padding.<span class="property">width</span> - padding.<span class="property">left</span> - padding.<span class="property">right</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span> - padding.<span class="property">top</span> - padding.<span class="property">bottom</span>)</span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;mouseover&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        givecuo.<span class="title function_">style</span>(<span class="string">&quot;left&quot;</span>, (d3.<span class="property">event</span>.<span class="property">pageX</span>) + <span class="string">&quot;px&quot;</span>)</span><br><span class="line">            .<span class="title function_">style</span>(<span class="string">&quot;top&quot;</span>, (d3.<span class="property">event</span>.<span class="property">pageY</span> + <span class="number">20</span>) + <span class="string">&quot;px&quot;</span>)</span><br><span class="line">            .<span class="title function_">style</span>(<span class="string">&quot;opacity&quot;</span>, <span class="number">1.0</span>)</span><br><span class="line">        focusCircle.<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>,<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">        vLine.<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">        hLine.<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;mousemove&quot;</span>, mousemove)</span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;mouseout&quot;</span>, <span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        focusCircle.<span class="title function_">style</span>(<span class="string">&quot;display&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line">        givecuo.<span class="title function_">style</span>(<span class="string">&quot;opacity&quot;</span>,<span class="number">0.0</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    当鼠标经过时调用 mousemove函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mousemove</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 折线的源数据</span></span><br><span class="line">    <span class="keyword">var</span> data = databases[<span class="number">0</span>].<span class="property">total</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取鼠标相对的透明矩形左上角的坐标为 (0,0)</span></span><br><span class="line">    <span class="keyword">var</span> mouseX = d3.<span class="title function_">mouse</span>(<span class="variable language_">this</span>)[<span class="number">0</span>] - padding.<span class="property">left</span>;</span><br><span class="line">    <span class="keyword">var</span> mouseY = d3.<span class="title function_">mouse</span>(<span class="variable language_">this</span>)[<span class="number">1</span>] - padding.<span class="property">top</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过比例尺的反函数计算出原数据的值 y0 是 GDP的值</span></span><br><span class="line">    <span class="keyword">var</span> x0 = xScale.<span class="title function_">invert</span>(mouseX)</span><br><span class="line">    <span class="keyword">var</span> y0 = yScale.<span class="title function_">invert</span>(mouseY)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开始四舍五路</span></span><br><span class="line">    x0 = <span class="title class_">Math</span>.<span class="title function_">round</span>(x0)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分别查找索引和数据</span></span><br><span class="line">    <span class="keyword">var</span> bisect = d3.<span class="title function_">bisector</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d[<span class="number">0</span>]</span><br><span class="line">    &#125;).<span class="property">left</span></span><br><span class="line">    <span class="keyword">var</span> index = <span class="title function_">bisect</span>(data, x0)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 分别获取 年份和 total */</span></span><br><span class="line">    <span class="keyword">var</span> x1 = data[index][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">var</span> y1 = data[index][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 分别通过使用 x 和 y 的比例尺来计算出焦点位置 */</span></span><br><span class="line">    <span class="keyword">var</span> focuX = <span class="title function_">xScale</span>(x1) + padding.<span class="property">left</span></span><br><span class="line">    <span class="keyword">var</span> focuY = <span class="title function_">yScale</span>(y1) + padding.<span class="property">top</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过评议将焦点到指定位置</span></span><br><span class="line">    focusCircle.<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + focuX + <span class="string">&quot;,&quot;</span> + focuY + <span class="string">&quot;)&quot;</span>);    <span class="comment">// 分别获取年份以及数据</span></span><br><span class="line">    <span class="keyword">var</span> year = x0</span><br><span class="line">    <span class="keyword">var</span> total = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k=<span class="number">0</span>;k&lt;databases.<span class="property">length</span>;k++) &#123;</span><br><span class="line">        total[k] = &#123;</span><br><span class="line">            <span class="attr">country</span>: databases[k].<span class="property">country</span>,</span><br><span class="line">                <span class="attr">value</span>: databases[k].<span class="property">total</span>[index][<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置描述文字内容</span></span><br><span class="line">    title.<span class="title function_">html</span>(<span class="string">&quot;&lt;strong&gt;&quot;</span> + year + <span class="string">&quot;年&lt;/strong&gt;&quot;</span>);</span><br><span class="line">    desColor.<span class="title function_">style</span>(<span class="string">&quot;background-color&quot;</span>, <span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> color[i]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分别显示国家以及当前数据</span></span><br><span class="line">    desText.<span class="title function_">html</span>( <span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> total[i].<span class="property">country</span> + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;&lt;strong&gt;&quot;</span> + total[i].<span class="property">value</span> + <span class="string">&quot;&lt;/strong&gt;&quot;</span>;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提示框位置</span></span><br><span class="line">    givecuo.<span class="title function_">style</span>(<span class="string">&quot;left&quot;</span>, (d3.<span class="property">event</span>.<span class="property">pageX</span>) + <span class="string">&quot;px&quot;</span>)</span><br><span class="line">        .<span class="title function_">style</span>(<span class="string">&quot;top&quot;</span>, (d3.<span class="property">event</span>.<span class="property">pageY</span> + <span class="number">20</span>) + <span class="string">&quot;px&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将垂直线对其坐标</span></span><br><span class="line">    <span class="keyword">var</span> vlx = <span class="title function_">xScale</span>(data[index][<span class="number">0</span>]) + padding.<span class="property">left</span>;</span><br><span class="line">    <span class="keyword">var</span> vly = <span class="title function_">yScale</span>(data[index][<span class="number">1</span>]) + padding.<span class="property">top</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 垂直线的终点和起点</span></span><br><span class="line">    vLine.<span class="title function_">attr</span>(<span class="string">&quot;x1&quot;</span>, vlx)</span><br><span class="line">        .<span class="title function_">attr</span>(<span class="string">&quot;y1&quot;</span>,padding.<span class="property">top</span>)</span><br><span class="line">        .<span class="title function_">attr</span>(<span class="string">&quot;x2&quot;</span>,vlx)</span><br><span class="line">        .<span class="title function_">attr</span>(<span class="string">&quot;y2&quot;</span>,padding.<span class="property">height</span> - padding.<span class="property">bottom</span>);</span><br><span class="line"></span><br><span class="line">    hLine.<span class="title function_">attr</span>(<span class="string">&quot;x1&quot;</span>,vlx)</span><br><span class="line">        .<span class="title function_">attr</span>(<span class="string">&quot;y1&quot;</span>,vly)</span><br><span class="line">        .<span class="title function_">attr</span>(<span class="string">&quot;x2&quot;</span>,padding.<span class="property">left</span>)</span><br><span class="line">        .<span class="title function_">attr</span>(<span class="string">&quot;y2&quot;</span>,vly)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 文字标记与文字路径 */</span></span><br><span class="line"><span class="keyword">var</span> gMark = svg.<span class="title function_">selectAll</span>(<span class="string">&quot;.gMark&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;translate(&quot;</span> + (padding.<span class="property">left</span> + i * padding.<span class="property">markStep</span>) + <span class="string">&quot;,&quot;</span> + (padding.<span class="property">height</span> - padding.<span class="property">bottom</span> + <span class="number">40</span>) + <span class="string">&quot;)&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">gMark.<span class="title function_">append</span>(<span class="string">&quot;rect&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;x&quot;</span>,<span class="number">0</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;y&quot;</span>,<span class="number">0</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,<span class="number">10</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,<span class="number">10</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="keyword">function</span> (<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> color[i]</span><br><span class="line">    &#125;)</span><br><span class="line">gMark.<span class="title function_">append</span>(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;dx&quot;</span>,<span class="number">15</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;dy&quot;</span>,<span class="string">&quot;.5em&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">text</span>(<span class="keyword">function</span> (<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d.<span class="property">country</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 坐标轴 */</span></span><br><span class="line"><span class="keyword">var</span> xAxis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">    .<span class="title function_">scale</span>(xScale)</span><br><span class="line">    .<span class="title function_">tickFormat</span>(d3.<span class="title function_">format</span>(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">    .<span class="title function_">orient</span>(<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yAxis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">    .<span class="title function_">scale</span>(yScale)</span><br><span class="line">    .<span class="title function_">tickFormat</span>(d3.<span class="title function_">format</span>(<span class="string">&quot;d&quot;</span>))</span><br><span class="line">    .<span class="title function_">orient</span>(<span class="string">&quot;left&quot;</span>)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + (padding.<span class="property">height</span> - padding.<span class="property">bottom</span>) + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">    .<span class="title function_">call</span>(xAxis)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + padding.<span class="property">top</span> + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">    .<span class="title function_">call</span>(yAxis)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.axis</span> path,   <span class="comment">/* 坐标轴路径设置 */</span></span><br><span class="line"><span class="selector-class">.axis</span> line &#123;    <span class="comment">/* 设置 坐标轴的线条 */</span></span><br><span class="line">  fill: none;   <span class="comment">/* 设置坐标轴宽度 */</span></span><br><span class="line">  stroke: <span class="number">#929292</span>;  <span class="comment">/* 坐标轴颜色 */</span></span><br><span class="line">  shape-rendering: crispEdges;  <span class="comment">/* 将形状渲染为清晰的边缘 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.axis</span> text &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  stroke: <span class="number">#929292</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.focusLine</span> &#123;</span><br><span class="line">  stroke: <span class="number">#b2b2b2</span>;</span><br><span class="line">  stroke-dasharray: <span class="number">10</span>,<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.givecuo</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: auto;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">  <span class="attribute">background-color</span>: white;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.givecuo</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">3px</span> solid red;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.givecuo</span> <span class="selector-class">.desColor</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">8px</span> <span class="number">1px</span> <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.givecuo</span> <span class="selector-class">.desText</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.overlay</span> &#123;</span><br><span class="line">  fill: transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/18.D3 对角线生成器/">D3 对角线生成器</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210402104825.png"><br>对角线生成器（<code>Diagonal enerator</code>），主要使用<code>三次贝赛尔曲线</code>将两个点进行连接，通过使用<code>d3.svg.diagonal()</code>创建，共有两个访问器一个函数，分别为：“<code>source()、target()、projection()</code>”</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设置基本 svg 格式 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">800</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&#x27;body&#x27;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 对角线坐标 */</span></span><br><span class="line"><span class="keyword">var</span> databases = &#123;</span><br><span class="line">    <span class="attr">source</span>: &#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">2</span>, <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">target</span>: &#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">300</span>, <span class="attr">y</span>: <span class="number">900</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义对角线生成器 */</span></span><br><span class="line"><span class="keyword">var</span> diagonal = d3.<span class="property">svg</span>.<span class="title function_">diagonal</span>()</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="title function_">diagonal</span>(databases))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;#51d576&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<h2 id="projection"><a href="#projection" class="headerlink" title="projection"></a>projection</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210402105518.png"><br>projection() 主要是将<code>坐标进行转换</code>，通常<strong>target</strong>坐标会<code>首先</code>调用该投影进行转换，之后生成新的路径：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设置基本 svg 格式 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1800</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&#x27;body&#x27;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 对角线坐标 */</span></span><br><span class="line"><span class="keyword">var</span> databases = &#123;</span><br><span class="line">    <span class="attr">source</span>: &#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">2</span>, <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">target</span>: &#123;</span><br><span class="line">        <span class="attr">x</span>: <span class="number">300</span>, <span class="attr">y</span>: <span class="number">900</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义对角线生成器 */</span></span><br><span class="line"><span class="keyword">var</span> diagonal = d3.<span class="property">svg</span>.<span class="title function_">diagonal</span>()</span><br><span class="line">    .<span class="title function_">projection</span>(<span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> x = d.<span class="property">x</span> * <span class="number">2</span></span><br><span class="line">        <span class="keyword">var</span> y = d.<span class="property">y</span> * <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> [x,y]</span><br><span class="line">    &#125;)</span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="title function_">diagonal</span>(databases))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;#51d576&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p>通过使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> diagonal = d3.<span class="property">svg</span>.<span class="title function_">diagonal</span>()</span><br><span class="line">    .<span class="title function_">projection</span>(<span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> x = d.<span class="property">x</span> * <span class="number">2</span></span><br><span class="line">        <span class="keyword">var</span> y = d.<span class="property">y</span> * <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> [x,y]</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>那么最终的<code>target</code>路径将会在<code>原有</code>的大小下将会被放大成<code>2</code>倍。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/17.D3 弦生成器/">D3 弦生成器</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210402091624.png"><br>弦生成器（<code>Chord Generator</code>），主要用于将两个<code>弧</code>进行连接，可通过使用<code>d3.svg.chord()</code>进行声明，分别有五个访问器：“<code>source（起始弧）、target（终止弧）、radius（半径）、startAngle（起始角度）、endAngle（终止角度）</code>”，弦生成器是生成弦图的重要组成部分之一。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* svg 基本结构 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">800</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 弦数据 */</span></span><br><span class="line"><span class="keyword">var</span> databases = &#123;</span><br><span class="line">    <span class="attr">source</span>: &#123;</span><br><span class="line">        <span class="attr">startAngle</span>: <span class="number">0.2</span>,</span><br><span class="line">        <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">0.3</span>,</span><br><span class="line">        <span class="attr">radius</span>: <span class="number">100</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">target</span>: &#123;</span><br><span class="line">        <span class="attr">startAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">1.6</span>,</span><br><span class="line">        <span class="attr">radius</span>: <span class="number">100</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 声明弦 */</span></span><br><span class="line"><span class="keyword">var</span> chord = d3.<span class="property">svg</span>.<span class="title function_">chord</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 弦绘制 */</span></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="title function_">chord</span>(databases))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(200,200)&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;#51d576&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/16.D3 弧生成器/">D3 弧生成器</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401111956.png"><br>弧生成器（<code>Arc Generator</code>）可以通过<code>innerRadius（内半径访问器）、outerRadius（外半径访问器）、startAngle（起始角度）、endAngle（终止角度访问器）</code>四类访问器来绘制<code>圆弧</code>以及<code>饼状图和弦图</code>等图表。</p>
<h2 id="innerRadius-and-outerRadius"><a href="#innerRadius-and-outerRadius" class="headerlink" title="innerRadius and outerRadius"></a>innerRadius and outerRadius</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401195444.png"></p>
<h2 id="一弧"><a href="#一弧" class="headerlink" title="一弧"></a>一弧</h2><p>在下述 code 中，<code>startAngle</code> or <code>startAngle</code>即代表<code>圆弧</code>的度数，通常的情况下<code>0°</code>需要使用<code>0</code>代替，同样<code>180°</code>也需要通过<code>3.1415926</code>来进行代替。需要注意的是，他是按照<code>顺时针</code>方向来进行填充或增加的，其中<code>outerRadius</code>与<code>innerRadius</code>分别表示<strong>圆弧半径</strong>以及<strong>内弧半径</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">1800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">500</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&#x27;body&#x27;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,padding.<span class="property">height</span>)</span><br><span class="line"><span class="keyword">var</span> databases = &#123;</span><br><span class="line">    <span class="attr">startAngle</span>: <span class="number">9</span>,</span><br><span class="line">    <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">1.10</span>    <span class="comment">/* 提供基本的数学功能和常数在内的对象 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> archPath = d3.<span class="property">svg</span>.<span class="title function_">arc</span>()</span><br><span class="line">    .<span class="title function_">innerRadius</span>(<span class="number">200</span>)</span><br><span class="line">    .<span class="title function_">outerRadius</span>(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>, <span class="title function_">archPath</span>(databases))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>,<span class="string">&quot;translate(255,255)&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;#026836&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="string">&quot;10px&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;#22a547&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="多弧"><a href="#多弧" class="headerlink" title="多弧"></a>多弧</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401195556.png"><br>在 D3 中，多弧主要用于绘制诸如<code>饼状图</code>等学术图表，通过使用多弧并将其<code>startAngle</code>与<code>endAngle</code>形成<strong>首位呼应</strong>之势，最终他们的度数共为<code>360°</code>即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* svg 创建与大小 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">800</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&#x27;body&#x27;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 饼图数据 */</span></span><br><span class="line"><span class="keyword">var</span> databases = [</span><br><span class="line">    &#123; <span class="attr">startAngle</span>: <span class="number">0</span>, <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">0.6</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">startAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">0.6</span>, <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">startAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span>, <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">1.7</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">startAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">1.7</span>, <span class="attr">endAngle</span>: <span class="title class_">Math</span>.<span class="property">PI</span> * <span class="number">2</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* innner and outer 与 code */</span></span><br><span class="line"><span class="keyword">var</span> archPath = d3.<span class="property">svg</span>.<span class="title function_">arc</span>()</span><br><span class="line">    .<span class="title function_">innerRadius</span>(<span class="number">0</span>)</span><br><span class="line">    .<span class="title function_">outerRadius</span>(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> color = d3.<span class="property">scale</span>.<span class="title function_">category20b</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 圆位置与基本样式 */</span></span><br><span class="line">svg.<span class="title function_">selectAll</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">archPath</span>(d)</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>, <span class="string">&quot;translate(255,255)&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>, <span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>, <span class="string">&quot;1px&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>, <span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">color</span>(i)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 文字样式与位置 */</span></span><br><span class="line">svg.<span class="title function_">selectAll</span>(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">    .<span class="title function_">data</span>(databases)</span><br><span class="line">    .<span class="title function_">enter</span>()</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;translate(255,255)&quot;</span> +</span><br><span class="line">            <span class="string">&quot;translate(&quot;</span> + archPath.<span class="title function_">centroid</span>(d) + <span class="string">&quot;)&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;text-anchor&quot;</span>, <span class="string">&quot;middle&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;white&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;font-size&quot;</span>,<span class="string">&quot;10px&quot;</span>)</span><br><span class="line">    .<span class="title function_">text</span>(<span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>((d.<span class="property">endAngle</span> - d.<span class="property">startAngle</span>) * <span class="number">180</span> / <span class="title class_">Math</span>.<span class="property">PI</span>) + <span class="string">&quot;°&quot;</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/15.D3 区域选择器/">D3 区域生成器</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401032524.png"><br>区域生成器（<code>Area Generator</code>）主要作用是<code>生成一块区域</code>，通常区域选择器的<code>数据访问器</code>有<strong>六个</strong>，即”<code>x()，x0()、x1()、y0()、y1()</code>“，可通过使用<code>d3.svg.area()</code>进行创建：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">800</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> databases = [<span class="number">80</span>,<span class="number">120</span>,<span class="number">130</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">90</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> areaPath = d3.<span class="property">svg</span>.<span class="title function_">area</span>()</span><br><span class="line">    .<span class="title function_">x</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">50</span> + i * <span class="number">80</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y0</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> padding.<span class="property">height</span> / <span class="number">2</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y1</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> padding.<span class="property">height</span> / <span class="number">2</span> - d</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="title function_">areaPath</span>(databases))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;#92f8c5&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>, <span class="string">&quot;3px&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;#bdfedf&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401032539.png"><br>通过上述的 code ，我们可以得到svg路径为：”<code>M50,330L130,280L210,270L290,330L370,340L450,320L450,400L370,400L290,400L210,400L130,400L50,400Z</code>“的数据，这一切归根于<code>x、y0、y1</code>的区域访问器，除此之外，我们依然可以使用<code>interpolate</code>方法，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">800</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> databases = [<span class="number">80</span>,<span class="number">120</span>,<span class="number">130</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">90</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> areaPath = d3.<span class="property">svg</span>.<span class="title function_">area</span>()</span><br><span class="line">    .<span class="title function_">x</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">50</span> + i * <span class="number">80</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y0</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> padding.<span class="property">height</span> / <span class="number">2</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y1</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> padding.<span class="property">height</span> / <span class="number">2</span> - d</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">interpolate</span>(<span class="string">&quot;basis&quot;</span>)</span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="title function_">areaPath</span>(databases))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;#92f8c5&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>, <span class="string">&quot;3px&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;#bdfedf&quot;</span>)</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/14.D3 路径与线段生成器/">D3 路径与线段生成器</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<h2 id="线段"><a href="#线段" class="headerlink" title="线段"></a>线段</h2><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210331111028.png"><br>线段生成器（<code>Line segment generator</code>）的主要作用就是，让原本只有<code>两个</code>点的线段，可以被划分成<code>无数</code>点，通过设置通过设置线段生成器可以使得绘画出各样形状，而仅仅通过<code>[x1,y1],[x2,y2]</code>的方法是无法达到的，在这个情况和需求的情况下，D3 提供了<code>路径生成器（Path Generator）</code>的概念，可以<strong>自动根据数据生成路径</strong>，而用于生成线段的过程被称之为<code>线段生成器（Line Generator）</code>：</p>
<blockquote>
<p>line</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,<span class="number">800</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,<span class="number">800</span>)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;line&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;x1&quot;</span>,<span class="number">0</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;y1&quot;</span>,<span class="number">400</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;x2&quot;</span>,<span class="number">200</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;y2&quot;</span>,<span class="number">10</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="string">&quot;3px&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>path</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,<span class="number">800</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,<span class="number">800</span>)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="string">&quot;M20,201L300,20&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="string">&quot;3px&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="线段生成器"><a href="#线段生成器" class="headerlink" title="线段生成器"></a>线段生成器</h2><p>线段生成器（<code>Line Generator</code>），主要可以通过使用<code>d3.svg.line()</code>方法进行创建，通过线段的点数据，和每一项的<code>[x,y]</code>来进行定义坐标，对于线段生成器，D3 提供了如下方法：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>DA</th>
<th>FA</th>
</tr>
</thead>
<tbody><tr>
<td>d3.svg.line()</td>
<td>创建一个线段生成器</td>
<td></td>
</tr>
<tr>
<td>line()</td>
<td>使用线段生成器绘制数据</td>
<td></td>
</tr>
<tr>
<td></td>
<td>line.x()</td>
<td>设置或获取线段<code>x</code>坐标访问器（使用什么作为线段的x坐标）</td>
</tr>
<tr>
<td></td>
<td>line.y()</td>
<td>设置或获取 <code>y</code>坐标的访问器</td>
</tr>
<tr>
<td>line.interpolate()</td>
<td>设置或获取线段的<code>插值</code>模式</td>
<td></td>
</tr>
<tr>
<td>line.tension()</td>
<td>设置或获取张力系数</td>
<td>需要插值模式为：<code>cardinal、cardinal-open、cardinal-closed</code>时有效</td>
</tr>
<tr>
<td>line.defined</td>
<td>设置或获取一个访问器，用于确定线段是否<code>存在</code></td>
<td>只有当数据存在时会被<code>绘制</code></td>
</tr>
</tbody></table>
<h3 id="d3-svg-line"><a href="#d3-svg-line" class="headerlink" title="d3.svg.line()"></a>d3.svg.line()</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210331111037.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,<span class="number">800</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,<span class="number">800</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lines = [[<span class="number">100</span>,<span class="number">100</span>],[<span class="number">200</span>,<span class="number">200</span>],[<span class="number">400</span>,<span class="number">200</span>],[<span class="number">500</span>,<span class="number">100</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> linePath = d3.<span class="property">svg</span>.<span class="title function_">line</span>()</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>,<span class="title function_">linePath</span>(lines))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>,<span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="string">&quot;1px&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>在上述的 code 中，主要提供了<code>四个点</code>，即他此时我们可以通过使用 <code>d3.svg.line(lines)</code>让其通过使用<code>线段生成器</code>进行创建，之后自动生成了路径为<code>M100,100L200,200L400,200L500,100</code>的折线路径。</p>
<h3 id="访问器与-interpolate"><a href="#访问器与-interpolate" class="headerlink" title="访问器与 interpolate()"></a>访问器与 interpolate()</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401014007.png"></p>
<h4 id="访问器"><a href="#访问器" class="headerlink" title="访问器"></a>访问器</h4><p>在D3中，访问器即<code>line.x()</code>与<code>line.y()</code>，主要通过使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">x</span>(<span class="params">d</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> d[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">y</span>(<span class="params">d</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> d[<span class="number">1</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通常访问器主要的作用就是对<code>x</code>与<code>y</code>坐标进行一些修改，通过使用访问器，我们可以达到经过调教很久的坐标数据，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lines = [<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">400</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> linePath = d3.<span class="property">svg</span>.<span class="title function_">line</span>()</span><br><span class="line">    .<span class="title function_">x</span>(<span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> i%<span class="number">2</span>==<span class="number">0</span> ? <span class="number">50</span> : <span class="number">0</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401014022.png"></p>
<p>因此我们会得到<code>M100,50L200,0L300,50L400,0</code>的SVG路径：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">1800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1800</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">    .<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>,padding.<span class="property">width</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>,padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lines = [<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">400</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> linePath = d3.<span class="property">svg</span>.<span class="title function_">line</span>()</span><br><span class="line">    .<span class="title function_">x</span>(<span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">y</span>(<span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> i%<span class="number">2</span>==<span class="number">0</span> ? <span class="number">50</span> : <span class="number">10</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;d&quot;</span>, <span class="title function_">linePath</span>(lines))</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke&quot;</span>, <span class="string">&quot;black&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;stroke-width&quot;</span>,<span class="string">&quot;2px&quot;</span>)</span><br><span class="line">    .<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>,<span class="string">&quot;none&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>那么根据上述的<code>lines</code>与<code>linePath</code>，将会组成一组坐标即：”<code>[100,50]，[200,0]，[300,50]，[400,0]</code>“，而他们的组成主要与<code>line</code>以及<code>linePath</code>有关：<br><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401014039.png"></p>
<h4 id="interpolate"><a href="#interpolate" class="headerlink" title="interpolate"></a>interpolate</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">| ID | DA |</span><br><span class="line">| --- | --- |</span><br><span class="line">| interpolate(&quot;```basis&quot;```) | ![](https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401014352.png) |</span><br><span class="line">| interpolate(&quot;```cardinal```&quot;) | ![](https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401014101.png) |</span><br><span class="line">| interpolate(&quot;```stop```) | ![](https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210401014259.png) |</span><br><span class="line">```js</span><br><span class="line">var padding = &#123;</span><br><span class="line">    width: 1800,</span><br><span class="line">    height: 1800</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var svg = d3.select(&quot;body&quot;)</span><br><span class="line">    .append(&quot;svg&quot;)</span><br><span class="line">    .attr(&quot;width&quot;,padding.width)</span><br><span class="line">    .attr(&quot;height&quot;,padding.height)</span><br><span class="line"></span><br><span class="line">var lines = [100,200,300,400]</span><br><span class="line"></span><br><span class="line">    var linePath = d3.svg.line()</span><br><span class="line">    .x(function(d) &#123;</span><br><span class="line">        return d;</span><br><span class="line">    &#125;)</span><br><span class="line">    .y(function(d,i) &#123;</span><br><span class="line">        return i%2==0 ? 50 : 0</span><br><span class="line">    &#125;)</span><br><span class="line">    .interpolate(&quot;basis&quot;)</span><br><span class="line"></span><br><span class="line">svg.append(&quot;path&quot;)</span><br><span class="line">    .attr(&quot;d&quot;, linePath(lines))</span><br><span class="line">    .attr(&quot;stroke&quot;, &quot;black&quot;)</span><br><span class="line">    .attr(&quot;stroke-width&quot;,&quot;2px&quot;)</span><br><span class="line">    .attr(&quot;fill&quot;,&quot;none&quot;)</span><br></pre></td></tr></table></figure>


	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/13.D3 颜色与插值/">D3 颜色与插值</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<h2 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h2><h3 id="RGB"><a href="#RGB" class="headerlink" title="RGB"></a>RGB</h3><p>RGB 色彩模式 (<code>RGB color mode</code>)，是一种工业界的颜色标准，主要有<code>红（R，Red）、绿（G，Green）、蓝（B，Blue）</code>三色，即<code>RGB</code>，通过<strong>相互之间的叠加</strong>来取得各种各样的<code>颜色</code>。RGB 主要覆盖了目前所有常用和人类肉眼可用的颜色，也是最为常用的颜色模式之一。</p>
<p>除此之外，RGB 的亮度各有 <code>0～255</code>个亮度，通过他们三个通道的<strong>叠加</strong>可以组合出大约<code>1678</code>万中颜色，通常也会被称之为<code>1600</code>万色或千万色，还可以被称之为<code>24位色</code>，在D3中他有如下方法：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>DA</th>
<th>FA</th>
</tr>
</thead>
<tbody><tr>
<td>d3.rgb(r，g，b)</td>
<td>分别输出<code> r\g\b</code>来创建颜色（范围都是0,255）</td>
<td></td>
</tr>
<tr>
<td>d3.rgb(<code>color</code>)</td>
<td>通过输出相应的字符串来创建颜色：</td>
<td></td>
</tr>
<tr>
<td></td>
<td>RGB <code>十进制</code></td>
<td>rgb(255, 255, 255)</td>
</tr>
<tr>
<td></td>
<td>RGB <code>十六进制</code></td>
<td>#ff0d0d</td>
</tr>
<tr>
<td></td>
<td>RGB <code>十六进制</code>缩写</td>
<td>#ff0</td>
</tr>
<tr>
<td></td>
<td>HSL <code>十进制</code></td>
<td>hsl(120, 0.5, 0.5)</td>
</tr>
<tr>
<td></td>
<td>颜色<code>名称</code></td>
<td>red</td>
</tr>
<tr>
<td>rgb.brighter()</td>
<td>使得颜色变得更加明亮</td>
<td>RGB的各个通道 x 0.7 ^ -k（如果 <code>k</code>没有，那么<code>k</code>的值就为<code>1</code>），需要注意的是<strong>只有当某通道的值的范围在 30~255 之间时，才会进行相应的计算</strong></td>
</tr>
<tr>
<td>rgb.darker()</td>
<td>颜色变得更加黯淡</td>
<td>RGB各个值 x 0.7 ^ k</td>
</tr>
<tr>
<td>rgb.hsl()</td>
<td>返回该颜色对应的 <code>HSL</code>值</td>
<td></td>
</tr>
<tr>
<td>rgb.toString()</td>
<td>以字符串的形式返回颜色值 <code>#ffffff</code></td>
<td></td>
</tr>
<tr>
<td><code>brighter()</code></td>
<td><code>darker()</code></td>
<td>返回一个新的颜色对象，<code>当前对象并不会进行改变</code></td>
</tr>
<tr>
<td>hsl()</td>
<td>返回当前颜色所对应的 <code>HSL</code>值</td>
<td></td>
</tr>
</tbody></table>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p><img src="https://gitee.com/analysis-of-river-snow/drawing-bed/raw/master/20210330163559.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = d3.<span class="title function_">rgb</span>(<span class="number">166</span>,<span class="number">12</span>,<span class="number">12</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color.<span class="title function_">has</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color.<span class="title function_">darker</span>(<span class="number">2</span>).<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color.<span class="title function_">brighter</span>(<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<p>在上述的 code中，我们可以通过使用<code>has()</code>来返回 <code>color</code>的<code>has</code>颜色值，也可以通过使用<code>toString()</code>来返回该颜色的<code>十六进制</code>，<code>darker()与brighter()</code>数值为<code>2</code>即亮度为<code>2</code>，暗度为<code>2</code>的颜色<code>变值</code>。</p>
<h2 id="HSL"><a href="#HSL" class="headerlink" title="HSL"></a>HSL</h2><p><img src="https://gitee.com/analysis-of-river-snow/drawing-bed/raw/master/20210330163521.png"><br>HSL 与 RGB 的区别就是，他是通过将 <code>RGB 色彩模式</code>内的各个组成颜色放在圆柱坐标系的表示方法。这种表示方法会比基于<code>笛卡尔坐标系</code>的集合结构中的RGB更加直观。</p>
<p>HSL 颜色空间主要通过<code>色相（H，Hue）、饱和度（S，Saturation）、亮度（L，Lightness）</code>三个相互叠加来得到各种颜色，他的色相范围是<code>0°～360°</code>，饱和度和亮度分别为<code>0～1</code>。其中<strong>色相°</strong>是一个角度，每个<code>角度</code>都可以代表其中的<code>一个颜色</code>，例如<code>0°</code>代表红色，<code>120°</code>代表绿色，<code>240°</code>代表蓝色。</p>
<p>通常的情况下，饱和度越大，颜色就越鲜艳，而亮度值主要控制色彩的<code>明暗变化</code>，当亮度越大，就越接近与白色，反之值越小就越接近黑色，默认的情况下<strong>RGB与HSL的颜色是可以互相转换的</strong>。</p>
<h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h3><table>
<thead>
<tr>
<th>ID</th>
<th>DA</th>
</tr>
</thead>
<tbody><tr>
<td>d3.hsl(<code>h,s,l</code>)</td>
<td>根据<code>h、s、l</code>值来创建HAL颜色</td>
</tr>
<tr>
<td>d3.hsl(<code>color</code>)</td>
<td>根据字符串来创建<code>HSL</code>颜色</td>
</tr>
<tr>
<td>hsl.brighter()</td>
<td>使得颜色变得<code>更亮</code></td>
</tr>
<tr>
<td>hsl.darker()</td>
<td>使得颜色变得<code>更暗</code></td>
</tr>
<tr>
<td>hsl.rgb()</td>
<td>返回对应的<code>rgb</code>颜色</td>
</tr>
<tr>
<td>hsl.toString</td>
<td>返回以<code>RGB</code>字符串十六进制形式输出的颜色</td>
</tr>
</tbody></table>
<p><img src="https://gitee.com/analysis-of-river-snow/drawing-bed/raw/master/20210331002823.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rgb = d3.<span class="title function_">rgb</span>(<span class="number">166</span>,<span class="number">12</span>,<span class="number">12</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(rgb.<span class="title function_">hsl</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hsl = d3.<span class="title function_">hsl</span>(<span class="number">0</span>,<span class="number">0.8651685393258428</span>,<span class="number">0.34901960784313724</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(hsl.<span class="title function_">rgb</span>().<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(hsl.<span class="title function_">darker</span>(<span class="number">2</span>).<span class="title function_">toString</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(hsl.<span class="title function_">brighter</span>(<span class="number">2</span>).<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure>

<h2 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h2><p><img src="https://gitee.com/analysis-of-river-snow/drawing-bed/raw/master/20210331020916.png"><br>插值（<code>Interpolation</code>）主要用于计算<code>介于</code>两个颜色之间的颜色，主要可以通过使用<code>d3.interpolateRgb()</code>来处理<code>RGB</code>颜色之间的插值运算。而如果是<code>HSL</code>颜色则可以通过使用<code>d3.interpolateHsl()</code>来处理<code>HSL</code>颜色之间的插值运算。<strong>除此之外</strong>，D3 还提供了一种更加<code>智能</code>的方法即：<code>d3.interpolate()</code>，他会自动的判断颜色类型，还可以处理<strong>字符串</strong>之间的差值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ragOne = d3.<span class="title function_">rgb</span>(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">var</span> ragTwo = d3.<span class="title function_">rgb</span>(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> interpolate = d3.<span class="title function_">interpolate</span>(ragOne,ragTwo)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">interpolate</span>(<span class="number">0</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">interpolate</span>(<span class="number">0.5</span>))</span><br></pre></td></tr></table></figure>

<p>在上述的 code 中，<code>ragOne</code>与<code>ragTwo</code>的插值通过<code>interpolate</code>来自动判断颜色类型，并根据设置的<code>插值</code>进行计算，当插值为<code>0</code>时返回了<code>#ff0000</code>颜色，而当插值为<code>0.5</code>时，则返回了<code>#808080</code>颜色。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/12.D3 散点图/">D3 散点图</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330093420.png"><br>散点图（<code>scatterplot</code>），主要在<code>回归分析（regression analysis）</code>中主要用于确定<strong>两种</strong>或两种以上的<code>变量</code>间互相依赖的<code>定量关系</code>的一种统计分析方法。散点图也可以用于表述<code>趋势的增加的聚合数据</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 定义高度与宽度，其中包括 x和y轴的宽度 */</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">	<span class="attr">width</span>: <span class="number">700</span>,</span><br><span class="line">	<span class="attr">height</span>: <span class="number">700</span>,</span><br><span class="line">	<span class="attr">xAxisWidth</span>: <span class="number">500</span>,</span><br><span class="line">	<span class="attr">yAxisWidth</span>: <span class="number">500</span>,</span><br><span class="line">	<span class="attr">right</span>: <span class="number">30</span>,</span><br><span class="line">	<span class="attr">bottom</span>: <span class="number">30</span>,</span><br><span class="line">	<span class="attr">left</span>: <span class="number">130</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义数据 x,y */</span></span><br><span class="line"><span class="keyword">var</span> center = [[<span class="number">0.8</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">0.8</span>],[<span class="number">0.4</span>,<span class="number">0.3</span>],[<span class="number">0.6</span>,<span class="number">0.4</span>],[<span class="number">0.2</span>,<span class="number">0.6</span>],[<span class="number">0.8</span>,<span class="number">0.2</span>],[<span class="number">0.2</span>,<span class="number">0.1</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义颜色序数比例尺 */</span></span><br><span class="line"><span class="keyword">var</span> color = d3.<span class="property">scale</span>.<span class="title function_">category10</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1.选择body元素，并添加一个&lt;svg&gt;元素</span></span><br><span class="line"><span class="comment">	2.并设置&lt;svg&gt;的高\宽为 600.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">	.<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* x/y 轴比例尺 */</span></span><br><span class="line"><span class="keyword">var</span> xScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">	.<span class="title function_">domain</span>([<span class="number">0</span>, <span class="number">1</span> * d3.<span class="title function_">max</span>(center, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> d[<span class="number">1</span>];</span><br><span class="line">	&#125;)])</span><br><span class="line">	.<span class="title function_">range</span>([<span class="number">0</span>, padding.<span class="property">xAxisWidth</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">	.<span class="title function_">domain</span>([<span class="number">0</span>, <span class="number">1</span> * d3.<span class="title function_">max</span>(center, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> d[<span class="number">1</span>];</span><br><span class="line">	&#125;)])</span><br><span class="line">	.<span class="title function_">range</span>([<span class="number">0</span>, padding.<span class="property">yAxisWidth</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义圆 */</span></span><br><span class="line"><span class="keyword">var</span> cirlce = svg.<span class="title function_">selectAll</span>(<span class="string">&quot;circle&quot;</span>)</span><br><span class="line">	.<span class="title function_">data</span>(center)</span><br><span class="line">	.<span class="title function_">enter</span>()</span><br><span class="line">	.<span class="title function_">append</span>(<span class="string">&quot;circle&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;fill&quot;</span>, <span class="keyword">function</span>(<span class="params">d,i</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="title function_">color</span>(i)</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;cx&quot;</span>, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> padding.<span class="property">left</span> + <span class="title function_">xScale</span>(d[<span class="number">0</span>])</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;cy&quot;</span>, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> padding.<span class="property">height</span> - padding.<span class="property">bottom</span> - <span class="title function_">yScale</span>(d[<span class="number">1</span>])</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;r&quot;</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* x/y 坐标轴选择比例尺 */</span></span><br><span class="line"><span class="keyword">var</span> xAxis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">	.<span class="title function_">scale</span>(xScale)</span><br><span class="line">	.<span class="title function_">orient</span>(<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line">	.<span class="title function_">ticks</span>(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">	yScale.<span class="title function_">range</span>([padding.<span class="property">yAxisWidth</span>, <span class="number">0</span>])	<span class="comment">/* 反向输出 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yAxis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">	.<span class="title function_">scale</span>(yScale)</span><br><span class="line">	.<span class="title function_">orient</span>(<span class="string">&quot;left&quot;</span>)</span><br><span class="line">	.<span class="title function_">ticks</span>(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 在 svg 元素中添加一个包含坐标轴的数据并计算出位置 */</span></span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>, <span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + (padding.<span class="property">height</span> - padding.<span class="property">bottom</span>) + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">	.<span class="title function_">call</span>(xAxis)</span><br><span class="line">svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>, <span class="string">&quot;translate(&quot;</span> + padding.<span class="property">left</span> + <span class="string">&quot;,&quot;</span> + (padding.<span class="property">height</span> - padding.<span class="property">bottom</span> - padding.<span class="property">yAxisWidth</span>) + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">	.<span class="title function_">call</span>(yAxis)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.axis</span> path,   <span class="comment">/* 坐标轴路径设置 */</span></span><br><span class="line"><span class="selector-class">.axis</span> line &#123;    <span class="comment">/* 设置 坐标轴的线条 */</span></span><br><span class="line">  fill: none;   <span class="comment">/* 设置坐标轴宽度 */</span></span><br><span class="line">  stroke: <span class="number">#929292</span>;  <span class="comment">/* 坐标轴颜色 */</span></span><br><span class="line">  shape-rendering: crispEdges;  <span class="comment">/* 将形状渲染为清晰的边缘 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.axis</span> text &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  stroke: <span class="number">#929292</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2022/04/21/javascript/d3/11.D3 坐标轴与刻度/">D3 坐标轴与刻度</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2022-04-21</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/d3-v3/" rel="tag">d3 v3</a> <a class="article__tag-none-link" href="/tags/javascript/" rel="tag">javascript</a> <a class="article__tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a>
			</span>
		
	</div>

	

	
		<p>坐标轴（<code>Axis</code>）通常在一些学术图表中进行运用，通常很多的情况下图表中数据都是经过<code>比例尺</code>内计算的出的大小与坐标位置，这个时候就需要刻度尺来进行<strong>标注</strong>，来辅助读者进行观看，可以通过下图来明显感受到差距：<br><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002022.png"><br>通常的情况下，读者可会对图标的<code>美观性</code>和<code>专业性</code>都会选择有坐标轴和刻度的图表，通常在 d3.js 中绘画出一个坐标轴需要以下方法的支持：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>DA</th>
<th>FA</th>
</tr>
</thead>
<tbody><tr>
<td>d3.svg.axis()</td>
<td>创建一个默认的新坐标轴</td>
<td></td>
</tr>
<tr>
<td>axis(选择集)</td>
<td>将此坐标轴绑定到指定的选择集中（需要具有<code>&lt;svg&gt;</code>或<code>&lt;g&gt;</code>元素）</td>
<td></td>
</tr>
<tr>
<td></td>
<td>axis.scale()</td>
<td>设定或获取坐标轴的比例尺</td>
</tr>
<tr>
<td></td>
<td>axis.orient(<code>top[bottom、left、right]</code>)</td>
<td>设定或获取坐标轴的方向</td>
</tr>
<tr>
<td>刻度</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>axis.ticks()</td>
<td>设置或获取坐标轴的分割数（默认为<code>10</code>）</td>
</tr>
<tr>
<td></td>
<td>axis.tickValues()</td>
<td>设置或获取坐标轴的<strong>指定刻度</strong></td>
</tr>
<tr>
<td></td>
<td>axis.tickSize()</td>
<td>设置或获取坐标轴内外的刻度长度（默认为<code>6</code>）</td>
</tr>
<tr>
<td></td>
<td></td>
<td>axis.innerTickSize() 设置或获取坐标轴<code>内刻度</code>的长度</td>
</tr>
<tr>
<td></td>
<td></td>
<td>axis.outerTickSize() 设置或获取坐标轴<code>外刻度</code>的长度</td>
</tr>
<tr>
<td></td>
<td>axis.tickFormat()</td>
<td>设置或获取刻度尺的<code>格式</code>或<code>单位</code></td>
</tr>
</tbody></table>
<h2 id="坐标轴"><a href="#坐标轴" class="headerlink" title="坐标轴"></a>坐标轴</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002102.png"><br>在上图中我们主要先通过定义<code>坐标轴</code>的基本高度与宽度以及最终的<code>位置</code>，其主要分为四个阶段，分别为<code>位置、添加、比例尺、坐标轴以及一个坐标轴的外部方法</code>通过四个阶段可以生成一个标准且带有刻度尺的一个坐标轴。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义坐标轴高度与宽度以及(x,y)的位置</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">	<span class="attr">width</span>: <span class="number">600</span>,</span><br><span class="line">	<span class="attr">height</span>: <span class="number">600</span>,</span><br><span class="line">	<span class="attr">translate</span>: <span class="string">&quot;translate(20,20)&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1.选择body元素，并添加一个&lt;svg&gt;元素</span></span><br><span class="line"><span class="comment">	2.并设置&lt;svg&gt;的高\宽为 600.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">	.<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 比例尺 */</span></span><br><span class="line"><span class="keyword">var</span> xScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">	.<span class="title function_">domain</span>([<span class="number">0</span>,<span class="number">10</span>])			<span class="comment">/* 定义域范围 */</span></span><br><span class="line">	.<span class="title function_">range</span>([<span class="number">0</span>,<span class="number">500</span>])	<span class="comment">/* 值域即为刻度尺长度 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	坐标轴选择比例尺，设置比例尺位置为 &quot;bottom&quot; 即底部</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> axis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">	.<span class="title function_">scale</span>(xScale)</span><br><span class="line">	.<span class="title function_">orient</span>(<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	在 svg 元素中添加一个包含坐标轴的：</span></span><br><span class="line"><span class="comment">		1. 位置/走向	@transform</span></span><br><span class="line"><span class="comment">		2. 样式	@class</span></span><br><span class="line"><span class="comment">		3. 参数传递</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> gAxis = svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>, padding.<span class="property">translate</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">	.<span class="title function_">call</span>(axis)		<span class="comment">/* 将自身作为参数，传递给某个参数 */</span></span><br></pre></td></tr></table></figure>

<h4 id="bottom-and-left"><a href="#bottom-and-left" class="headerlink" title="bottom and left"></a>bottom and left</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330015825.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">```js</span><br><span class="line">/* 定义高度与宽度，其中包括 x和y轴的宽度 */</span><br><span class="line">var padding = &#123;</span><br><span class="line">	width: 700,</span><br><span class="line">	height: 700,</span><br><span class="line">	xAxisWidth: 500,</span><br><span class="line">	yAxisWidth: 500,</span><br><span class="line">	right: 30,</span><br><span class="line">	bottom: 30,</span><br><span class="line">	left: 130,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 定义数据</span><br><span class="line">var center = [[1,1]]</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	1.选择body元素，并添加一个&lt;svg&gt;元素</span><br><span class="line">	2.并设置&lt;svg&gt;的高\宽为 600.</span><br><span class="line"> */</span><br><span class="line">var svg = d3.select(&quot;body&quot;)</span><br><span class="line">	.append(&quot;svg&quot;)</span><br><span class="line">	.attr(&quot;width&quot;, padding.width)</span><br><span class="line">	.attr(&quot;height&quot;, padding.height)</span><br><span class="line"></span><br><span class="line">/* x/y 轴比例尺 */</span><br><span class="line">var xScale = d3.scale.linear()</span><br><span class="line">	.domain([0, 1 * d3.max(center, function(d) &#123;</span><br><span class="line">		return d[1];</span><br><span class="line">	&#125;)])</span><br><span class="line">	.range([0, padding.xAxisWidth])</span><br><span class="line"></span><br><span class="line">var yScale = d3.scale.linear()</span><br><span class="line">	.domain([0, 1 * d3.max(center, function(d) &#123;</span><br><span class="line">		return d[1];</span><br><span class="line">	&#125;)])</span><br><span class="line">	.range([0, padding.yAxisWidth])</span><br><span class="line"></span><br><span class="line">/* x/y 坐标轴选择比例尺 */</span><br><span class="line">var xAxis = d3.svg.axis()</span><br><span class="line">	.scale(xScale)</span><br><span class="line">	.orient(&quot;bottom&quot;)</span><br><span class="line">	.ticks(5)</span><br><span class="line"></span><br><span class="line">yScale.range([padding.yAxisWidth, 0])	/* 反向输出 */</span><br><span class="line"></span><br><span class="line">var yAxis = d3.svg.axis()</span><br><span class="line">	.scale(yScale)</span><br><span class="line">	.orient(&quot;left&quot;)</span><br><span class="line">	.ticks(5)</span><br><span class="line"></span><br><span class="line">/* 在 svg 元素中添加一个包含坐标轴的数据并计算出位置 */</span><br><span class="line">svg.append(&quot;g&quot;)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;axis&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, &quot;translate(&quot; + padding.left + &quot;,&quot; + (padding.height - padding.bottom) + &quot;)&quot;)</span><br><span class="line">	.call(xAxis)</span><br><span class="line">svg.append(&quot;g&quot;)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;axis&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, &quot;translate(&quot; + padding.left + &quot;,&quot; + (padding.height - padding.bottom - padding.yAxisWidth) + &quot;)&quot;)</span><br><span class="line">	.call(yAxis)</span><br></pre></td></tr></table></figure>


<h3 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h3><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002119.png"><br>除了生成 <code>svg</code> 坐标轴之外，我们还需要通过为<code>path（路径）、line（刻度尺）、text（文本）</code>这三个<code>svg</code>元素添加样式，让其变得简洁。</p>
<blockquote>
<p>less</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@color</span>: #<span class="number">929292</span>;</span><br><span class="line"><span class="selector-class">.axis</span> path,   <span class="comment">/* 坐标轴路径设置 */</span></span><br><span class="line"><span class="selector-class">.axis</span> line &#123;    <span class="comment">/* 设置 坐标轴的线条 */</span></span><br><span class="line">  fill: none;   <span class="comment">/* 设置坐标轴宽度 */</span></span><br><span class="line">  stroke: @color;  <span class="comment">/* 坐标轴颜色 */</span></span><br><span class="line">  shape-rendering: crispEdges;  <span class="comment">/* 将形状渲染为清晰的边缘 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.axis</span> text &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  stroke: @color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>css</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.axis</span> path,   <span class="comment">/* 坐标轴路径设置 */</span></span><br><span class="line"><span class="selector-class">.axis</span> line &#123;    <span class="comment">/* 设置 坐标轴的线条 */</span></span><br><span class="line">  fill: none;   <span class="comment">/* 设置坐标轴宽度 */</span></span><br><span class="line">  stroke: <span class="number">#929292</span>;  <span class="comment">/* 坐标轴颜色 */</span></span><br><span class="line">  shape-rendering: crispEdges;  <span class="comment">/* 将形状渲染为清晰的边缘 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.axis</span> text &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  stroke: <span class="number">#929292</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="刻度"><a href="#刻度" class="headerlink" title="刻度"></a>刻度</h2><p>刻度，主要依赖于坐标轴，是一个专业学术图表中较为重要的一部分。我们可以通过属性或方法来定义刻度的<code>方向、间隔、长度、文字格式</code>等。</p>
<h3 id="刻度位置"><a href="#刻度位置" class="headerlink" title="刻度位置"></a>刻度位置</h3><h4 id="ticks"><a href="#ticks" class="headerlink" title="ticks()"></a>ticks()</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002150.png"><br>通常的情况下<code>ticks()</code>主要用于<code>控制</code>刻度尺的生成，在 d3.js 中 ticks的概念是指：“<strong>一个至到另一个分割的特定数量</strong>”，即<strong>分割的数量</strong>。如将<code>ticks()</code>设置为<strong>5</strong>，那么将会输出具有刻度为<code>0，2，4，6，8，10</code>的坐标轴。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义坐标轴高度与宽度以及(x,y)的位置</span></span><br><span class="line"><span class="keyword">var</span> padding = &#123;</span><br><span class="line">	<span class="attr">width</span>: <span class="number">600</span>,</span><br><span class="line">	<span class="attr">height</span>: <span class="number">600</span>,</span><br><span class="line">			<span class="attr">translate</span>: <span class="string">&quot;translate(20,20)&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1.选择body元素，并添加一个&lt;svg&gt;元素</span></span><br><span class="line"><span class="comment">	2.并设置&lt;svg&gt;的高\宽为 600.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> svg = d3.<span class="title function_">select</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">	.<span class="title function_">append</span>(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, padding.<span class="property">width</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, padding.<span class="property">height</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 比例尺 */</span></span><br><span class="line"><span class="keyword">var</span> xScale = d3.<span class="property">scale</span>.<span class="title function_">linear</span>()</span><br><span class="line">	.<span class="title function_">domain</span>([<span class="number">0</span>,<span class="number">10</span>])			<span class="comment">/* 定义域范围 */</span></span><br><span class="line">	.<span class="title function_">range</span>([<span class="number">0</span>,<span class="number">500</span>])	<span class="comment">/* 值域即为刻度尺长度 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	坐标轴选择比例尺，设置比例尺位置为 &quot;bottom&quot; 即底部</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> axis = d3.<span class="property">svg</span>.<span class="title function_">axis</span>()</span><br><span class="line">	.<span class="title function_">scale</span>(xScale)</span><br><span class="line">	.<span class="title function_">orient</span>(<span class="string">&quot;bottom&quot;</span>)</span><br><span class="line">	.<span class="title function_">ticks</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	在 svg 元素中添加一个包含坐标轴的：</span></span><br><span class="line"><span class="comment">		1. 位置/走向	@transform</span></span><br><span class="line"><span class="comment">		2. 样式	@class</span></span><br><span class="line"><span class="comment">		3. 参数传递</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> gAxis = svg.<span class="title function_">append</span>(<span class="string">&quot;g&quot;</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;transform&quot;</span>, padding.<span class="property">translate</span>)</span><br><span class="line">	.<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;axis&quot;</span>)</span><br><span class="line">	.<span class="title function_">call</span>(axis)		<span class="comment">/* 将自身作为参数，传递给某个参数 */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="tickValues"><a href="#tickValues" class="headerlink" title="tickValues()"></a>tickValues()</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002206.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">// 定义坐标轴高度与宽度以及(x,y)的位置</span><br><span class="line">var padding = &#123;</span><br><span class="line">	width: 600,</span><br><span class="line">	height: 600,</span><br><span class="line">			translate: &quot;translate(20,20)&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	1.选择body元素，并添加一个&lt;svg&gt;元素</span><br><span class="line">	2.并设置&lt;svg&gt;的高\宽为 600.</span><br><span class="line"> */</span><br><span class="line">var svg = d3.select(&quot;body&quot;)</span><br><span class="line">	.append(&quot;svg&quot;)</span><br><span class="line">	.attr(&quot;width&quot;, padding.width)</span><br><span class="line">	.attr(&quot;height&quot;, padding.height)</span><br><span class="line"></span><br><span class="line">/* 比例尺 */</span><br><span class="line">var xScale = d3.scale.linear()</span><br><span class="line">	.domain([0,10])			/* 定义域范围 */</span><br><span class="line">	.range([0,500])	/* 值域即为刻度尺长度 */</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	坐标轴选择比例尺，设置比例尺位置为 &quot;bottom&quot; 即底部</span><br><span class="line"> */</span><br><span class="line">var axis = d3.svg.axis()</span><br><span class="line">	.scale(xScale)</span><br><span class="line">	.orient(&quot;bottom&quot;)</span><br><span class="line">	.tickValues([0, 2.2, 4, 6, 8, 10])</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	在 svg 元素中添加一个包含坐标轴的：</span><br><span class="line">		1. 位置/走向	@transform</span><br><span class="line">		2. 样式	@class</span><br><span class="line">		3. 参数传递</span><br><span class="line"> */</span><br><span class="line">var gAxis = svg.append(&quot;g&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, padding.translate)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;axis&quot;)</span><br><span class="line">	.call(axis)		/* 将自身作为参数，传递给某个参数 */</span><br></pre></td></tr></table></figure>

<h3 id="刻度长度"><a href="#刻度长度" class="headerlink" title="刻度长度"></a>刻度长度</h3><h4 id="tickSize"><a href="#tickSize" class="headerlink" title="tickSize()"></a>tickSize()</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002218.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">// 定义坐标轴高度与宽度以及(x,y)的位置</span><br><span class="line">var padding = &#123;</span><br><span class="line">	width: 600,</span><br><span class="line">	height: 600,</span><br><span class="line">			translate: &quot;translate(20,20)&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	1.选择body元素，并添加一个&lt;svg&gt;元素</span><br><span class="line">	2.并设置&lt;svg&gt;的高\宽为 600.</span><br><span class="line"> */</span><br><span class="line">var svg = d3.select(&quot;body&quot;)</span><br><span class="line">	.append(&quot;svg&quot;)</span><br><span class="line">	.attr(&quot;width&quot;, padding.width)</span><br><span class="line">	.attr(&quot;height&quot;, padding.height)</span><br><span class="line"></span><br><span class="line">/* 比例尺 */</span><br><span class="line">var xScale = d3.scale.linear()</span><br><span class="line">	.domain([0,10])			/* 定义域范围 */</span><br><span class="line">	.range([0,500])	/* 值域即为刻度尺长度 */</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	坐标轴选择比例尺，设置比例尺位置为 &quot;bottom&quot; 即底部</span><br><span class="line"> */</span><br><span class="line">var axis = d3.svg.axis()</span><br><span class="line">	.scale(xScale)</span><br><span class="line">	.orient(&quot;bottom&quot;)</span><br><span class="line">	.tickSize(6,8)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	在 svg 元素中添加一个包含坐标轴的：</span><br><span class="line">		1. 位置/走向	@transform</span><br><span class="line">		2. 样式	@class</span><br><span class="line">		3. 参数传递</span><br><span class="line"> */</span><br><span class="line">var gAxis = svg.append(&quot;g&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, padding.translate)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;axis&quot;)</span><br><span class="line">	.call(axis)		/* 将自身作为参数，传递给某个参数 */</span><br></pre></td></tr></table></figure>

<h4 id="innerTickSize-and-outerTickSize"><a href="#innerTickSize-and-outerTickSize" class="headerlink" title="innerTickSize() and outerTickSize()"></a>innerTickSize() and outerTickSize()</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002240.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">// 定义坐标轴高度与宽度以及(x,y)的位置</span><br><span class="line">var padding = &#123;</span><br><span class="line">	width: 600,</span><br><span class="line">	height: 600,</span><br><span class="line">			translate: &quot;translate(20,20)&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	1.选择body元素，并添加一个&lt;svg&gt;元素</span><br><span class="line">	2.并设置&lt;svg&gt;的高\宽为 600.</span><br><span class="line"> */</span><br><span class="line">var svg = d3.select(&quot;body&quot;)</span><br><span class="line">	.append(&quot;svg&quot;)</span><br><span class="line">	.attr(&quot;width&quot;, padding.width)</span><br><span class="line">	.attr(&quot;height&quot;, padding.height)</span><br><span class="line"></span><br><span class="line">/* 比例尺 */</span><br><span class="line">var xScale = d3.scale.linear()</span><br><span class="line">	.domain([0,10])			/* 定义域范围 */</span><br><span class="line">	.range([0,500])	/* 值域即为刻度尺长度 */</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	坐标轴选择比例尺，设置比例尺位置为 &quot;bottom&quot; 即底部</span><br><span class="line"> */</span><br><span class="line">var axis = d3.svg.axis()</span><br><span class="line">	.scale(xScale)</span><br><span class="line">	.orient(&quot;bottom&quot;)</span><br><span class="line">	.innerTickSize(6)</span><br><span class="line">	.outerTickSize(8)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	在 svg 元素中添加一个包含坐标轴的：</span><br><span class="line">		1. 位置/走向	@transform</span><br><span class="line">		2. 样式	@class</span><br><span class="line">		3. 参数传递</span><br><span class="line"> */</span><br><span class="line">var gAxis = svg.append(&quot;g&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, padding.translate)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;axis&quot;)</span><br><span class="line">	.call(axis)		/* 将自身作为参数，传递给某个参数 */</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="文字格式"><a href="#文字格式" class="headerlink" title="文字格式"></a>文字格式</h3><h4 id="TickFormat"><a href="#TickFormat" class="headerlink" title="TickFormat"></a>TickFormat</h4><p><img src="https://49812933408852955071488026628034-1301075051.cos.ap-nanjing.myqcloud.com/20210330002253.png"></p>
<figure class="highlight plaintext"><figcaption><span>code 将会在刻度后加上一个```百分比```作为单位：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">var gAxis = svg.append(&quot;g&quot;)</span><br><span class="line">	.attr(&quot;transform&quot;, padding.translate)</span><br><span class="line">	.attr(&quot;class&quot;,&quot;axis&quot;)</span><br><span class="line">	.call(axis.tickFormat(d =&gt; d+ &quot;%&quot;))		/* 将自身作为参数，传递给某个参数 */</span><br></pre></td></tr></table></figure>


	

	

</article>





	<span class="different-posts">📖 <a href="/page/10">more posts</a> 📖</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>欢迎来到我的 blog <br><br> 通过 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>+<a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a> 进行构建的，存放在 <a target="_blank" rel="noopener" href="https://github.com/vendanges/vendanges.github.io">Github</a> 上。</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2022 John Doe | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
